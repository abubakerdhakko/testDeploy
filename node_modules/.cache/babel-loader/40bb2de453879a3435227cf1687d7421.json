{"remainingRequest":"/home/alsharqi/Desktop/Deploy Fe-ui/fe-erohal-ui/node_modules/babel-loader/lib/index.js!/home/alsharqi/Desktop/Deploy Fe-ui/fe-erohal-ui/node_modules/cache-loader/dist/cjs.js??ref--1-0!/home/alsharqi/Desktop/Deploy Fe-ui/fe-erohal-ui/node_modules/vue-loader/lib/index.js??vue-loader-options!/home/alsharqi/Desktop/Deploy Fe-ui/fe-erohal-ui/src/views/work-orders/WorkOrderDetails.vue?vue&type=script&lang=js&","dependencies":[{"path":"/home/alsharqi/Desktop/Deploy Fe-ui/fe-erohal-ui/src/views/work-orders/WorkOrderDetails.vue","mtime":1661968702452},{"path":"/home/alsharqi/Desktop/Deploy Fe-ui/fe-erohal-ui/babel.config.js","mtime":1661968702388},{"path":"/home/alsharqi/Desktop/Deploy Fe-ui/fe-erohal-ui/node_modules/cache-loader/dist/cjs.js","mtime":1662622637759},{"path":"/home/alsharqi/Desktop/Deploy Fe-ui/fe-erohal-ui/node_modules/babel-loader/lib/index.js","mtime":1662622637719},{"path":"/home/alsharqi/Desktop/Deploy Fe-ui/fe-erohal-ui/node_modules/cache-loader/dist/cjs.js","mtime":1662622637759},{"path":"/home/alsharqi/Desktop/Deploy Fe-ui/fe-erohal-ui/node_modules/vue-loader/lib/index.js","mtime":1662622639723}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:aW1wb3J0IFNpZGViYXIgZnJvbSAiLi9jb21wb25lbnRzL1NpZGViYXIiOwppbXBvcnQgQXNzZXRJbmZvIGZyb20gIi4vY29tcG9uZW50cy9Bc3NldEluZm8iOwppbXBvcnQgSW5zcGVjdGlvblJlcG9ydHMgZnJvbSAiLi9jb21wb25lbnRzL0luc3BlY3Rpb25SZXBvcnRzIjsKaW1wb3J0IEFzc2lnbm1lbnQgZnJvbSAiLi9jb21wb25lbnRzL0Fzc2lnbm1lbnQiOwppbXBvcnQgV29ya09yZGVyU2VydmljZSBmcm9tICIuLi8uLi9zZXJ2aWNlcy9Xb3JrT3JkZXJTZXJ2aWNlIjsKaW1wb3J0IEFzc2V0TWFuYWdlbWVudFNlcnZpY2UgZnJvbSAiLi4vLi4vc2VydmljZXMvQXNzZXRNYW5hZ2VtZW50U2VydmljZSI7CmltcG9ydCBBc3NldFBlcnNvbm5lbFNlcnZpY2UgZnJvbSAiLi4vLi4vc2VydmljZXMvQXNzZXRQZXJzb25uZWxTZXJ2aWNlIjsKaW1wb3J0IEluc3BlY3Rpb25TZXJ2aWNlIGZyb20gIi4uLy4uL3NlcnZpY2VzL0luc3BlY3Rpb25TZXJ2aWNlIjsKaW1wb3J0IElzc3VlIGZyb20gIi4vY29tcG9uZW50cy9Jc3N1ZSI7CmltcG9ydCBXb3JrT3JkZXJUaW1lIGZyb20gIi4vY29tcG9uZW50cy9UaW1lIjsKaW1wb3J0IFdvcmtPcmRlclN1bW1hcnkgZnJvbSAiLi9jb21wb25lbnRzL3dvcmtPcmRlclN1bW1hcnkiOwppbXBvcnQgbW9tZW50IGZyb20gIm1vbWVudCI7CmltcG9ydCBWaWV3SXNzdWUgZnJvbSAiLi4vLi4vdmlld3MvaXNzdWVzL2NvbXBvbmVudHMvVmlld0lzc3VlIjsKaW1wb3J0IHsgRnVuY3Rpb25zIH0gZnJvbSAiQC9zaGFyZWQvRnVuY3Rpb25zIjsKaW1wb3J0IHsgcmVxdWlyZWQsIG1heExlbmd0aCB9IGZyb20gInZ1ZWxpZGF0ZS9saWIvdmFsaWRhdG9ycyI7CmltcG9ydCBsb2FkZXIgZnJvbSAiQC9jb21wb25lbnRzL0xvYWRlci52dWUiOwpleHBvcnQgZGVmYXVsdCB7CiAgbmFtZTogIldvcmtPcmRlckRldGFpbHMiLAogIGNvbXBvbmVudHM6IHsKICAgIFNpZGViYXIsCiAgICBBc3NldEluZm8sCiAgICBJbnNwZWN0aW9uUmVwb3J0cywKICAgIEFzc2lnbm1lbnQsCiAgICBXb3JrT3JkZXJUaW1lLAogICAgSXNzdWUsCiAgICBXb3JrT3JkZXJTdW1tYXJ5LAogICAgVmlld0lzc3VlLAogICAgbG9hZGVyCiAgfSwKCiAgZGF0YSgpIHsKICAgIHJldHVybiB7CiAgICAgIGxvYWRlckZsYWc6IGZhbHNlLAoKICAgICAgLyogVG9hc3QgUHJvcGVydGllcyAqLwogICAgICB0b2FzdFRpbWVPdXQ6IDMwMDAsCiAgICAgIHRvYXN0TWVzc2FnZTogIiIsCiAgICAgIHRvYXN0VHlwZTogIiIsCiAgICAgIHRvYXN0RmxhZzogMCwKCiAgICAgIC8qIFRvYXN0IFByb3BlcnRpZXMgKi8KICAgICAgc2lkZWJhclVwZGF0ZTogMCwKICAgICAgYXNzZXRJbmZvOiBudWxsLAogICAgICB3b3JrT3JkZXJEZXRhaWw6IG51bGwsCiAgICAgIGN1cnJlbmN5OiAiIiwKICAgICAgY3VycmVudFVzZXJEZXRhaWxzOiAiIiwKICAgICAgcG9vbGVkSXNzdWVzOiBbXSwKICAgICAgd29ya09yZGVyVHlwZTogIiIsCiAgICAgIHdvcmtPcmRlclVVSUQ6ICIiLAogICAgICB2aWV3UG9vbElzc3VlOiBmYWxzZSwKICAgICAgaXNzdWVVVUlEOiAiIiwKICAgICAgdG90YWxXb3JrT3JkZXJDb3N0OiAwLAogICAgICBkaXNhYmxlRmllbGRzOiBmYWxzZSwKICAgICAgaXNzdWVzQXJyYXlMaXN0OiBbXSwKICAgICAgaXNzdWVzU2VsZWN0ZWQ6IFtdLAogICAgICAvLyBpc3N1ZU51bWJlcjogIiIsCiAgICAgIGluaXRpYWxJbnNwZWN0aW9uUmVwb3J0OiBudWxsLAogICAgICBmaW5hbEluc3BlY3Rpb25SZXBvcnQ6IG51bGwsCiAgICAgIGNoZWNrRXhpc3RpbmdJbml0aWFsSW5zcGVjdGlvbjogZmFsc2UsCiAgICAgIGNoZWNrRXhpc3RpbmdGaW5hbEluc3BlY3Rpb246IGZhbHNlLAogICAgICBzYW1lQXNJbml0aWFsSW5zcGVjdGlvbjogdHJ1ZSwKICAgICAgaW5pdGlhbEluc3BlY3Rpb25CeUFzc2V0OiAiIiwKICAgICAgaW5pdGlhbEluc3BlY3Rpb25CeUFzc2V0Q2F0ZWdvcnk6ICIiLAogICAgICBpbml0aWFsSW5zcGVjdGlvbkJ5V29ya09yZGVyOiAiIiwKICAgICAgZmluYWxJbnNwZWN0aW9uQnlBc3NldDogIiIsCiAgICAgIGZpbmFsSW5zcGVjdGlvbkJ5QXNzZXRDYXRlZ29yeTogIiIsCiAgICAgIGZpbmFsSW5zcGVjdGlvbkJ5V29ya09yZGVyOiAiIiwKICAgICAgc2VsZWN0ZWRJbml0aWFsSW5zcGVjdGlvbkJ5QXNzZXQ6ICIiLAogICAgICBzZWxlY3RlZEluaXRpYWxJbnNwZWN0aW9uQnlBc3NldENhdGVnb3J5OiAiIiwKICAgICAgc2VsZWN0ZWRJbml0aWFsSW5zcGVjdGlvbkJ5V29ya09yZGVyOiAiIiwKICAgICAgc2VsZWN0ZWRGaW5hbEluc3BlY3Rpb25CeUFzc2V0OiAiIiwKICAgICAgc2VsZWN0ZWRGaW5hbEluc3BlY3Rpb25CeUFzc2V0Q2F0ZWdvcnk6ICIiLAogICAgICBzZWxlY3RlZEZpbmFsSW5zcGVjdGlvbkJ5V29ya09yZGVyOiAiIiwKICAgICAgaW5zcGVjdGlvbkJ5QXNzZXRPcHRpb25zOiBbXSwKICAgICAgaW5wc2VjdGlvbkJ5QXNzZXRDYXRlZ29yeU9wdGlvbnM6IFtdLAogICAgICBpbnBzZWN0aW9uQnlXb3JrT3JkZXJPcHRpb25zOiBbXSwKICAgICAgaW5pdGlhbEluc3BlY3Rpb25UZW1wOiAiIiwKICAgICAgZmluYWxJbnNwZWN0aW9uVGl0bGU6ICIiLAogICAgICBhbnN3ZXJUeXBlT3B0aW9uczogW3sKICAgICAgICBsYWJlbDogIlRleHQvSW1hZ2UvQXVkaW8iLAogICAgICAgIHZhbHVlOiAiaW5wdXQiCiAgICAgIH0sIHsKICAgICAgICBsYWJlbDogIlllcy9ObyIsCiAgICAgICAgdmFsdWU6ICJib29sZWFuIgogICAgICB9LCB7CiAgICAgICAgbGFiZWw6ICJNdWx0aXBsZSBDaG9pY2UiLAogICAgICAgIHZhbHVlOiAibXVsdGlwbGUiCiAgICAgIH1dLAogICAgICBxdWVzdGlvblR5cGVGb3JtSW5pdGlhbDogW10sCiAgICAgIHF1ZXN0aW9uVHlwZUZvcm1GaW5hbDogW10sCiAgICAgIGZpbmFsSW5zcGVjdGlvbk9wdGlvbnM6IFt7CiAgICAgICAgbGFiZWw6ICJTYW1lIEFzIEluaXRpYWwiLAogICAgICAgIHZhbHVlOiAic2FtZSIKICAgICAgfSwgewogICAgICAgIGxhYmVsOiAiU2VsZWN0IEV4aXN0aW5nIiwKICAgICAgICB2YWx1ZTogImV4aXN0aW5nIgogICAgICB9LCB7CiAgICAgICAgbGFiZWw6ICJDcmVhdGUgTmV3IEluc3BlY3Rpb24gVGVtcGxhdGUiLAogICAgICAgIHZhbHVlOiAiY3JlYXRlTmV3IgogICAgICB9XSwKICAgICAgZmluYWxJbnNwZWN0aW9uU2VsZWN0aW9uOiAiU2FtZSBBcyBJbml0aWFsIiwKICAgICAgc2FtZTogdHJ1ZSwKICAgICAgd29ya09yZGVyU3VtbWFyeUluZGV4OiAwLAogICAgICBpbml0aWFsQXNzZXRJbmRleDogMCwKICAgICAgaW5zcGVjdGlvblJlc2V0OiAwLAogICAgICBmaW5hbEluc3BlY3Rpb25SZXNldDogMCwKICAgICAgd29ya09yZGVyU3VtbWFyeTogewogICAgICAgIHByaW9yaXR5OiAiIiwKICAgICAgICBzaGlmdDogIiIsCiAgICAgICAgc2hlZHVsZTogIiIsCiAgICAgICAgdXNlckdyb3VwOiAiIiwKICAgICAgICB1c2VyOiAiIiwKICAgICAgICBpc3N1ZXM6IFtdLAogICAgICAgIGluaXRpYWxJbnNwZWN0aW9uVGl0bGU6ICIiLAogICAgICAgIGZpbmFsSW5zcGVjdGlvblRpdGxlOiAiIiwKICAgICAgICBjYXRlZ29yeTogIiIsCiAgICAgICAgbmFtZTogIiIsCiAgICAgICAgc2VsZWN0ZWRJbml0aWFsSW5zcGVjdGlvbkJ5QXNzZXRDYXRlZ29yeTogIiIsCiAgICAgICAgc2VsZWN0ZWRGaW5hbEluc3BlY3Rpb25CeUFzc2V0Q2F0ZWdvcnk6ICIiCiAgICAgIH0sCiAgICAgIHBlcml2b3VzSW5pdGlhbFRlbXBsYXRlOiB7fSwKICAgICAgcHJldmlvdXNGaW5hbFRlbXBsYXRlOiB7fSwKICAgICAgcGVyaXZvdXNJbml0aWFsRXhpc3Rpbmc6IHt9LAogICAgICBwZXJpdm91c0ZpbmFsRXhpc3Rpbmc6IHt9CiAgICB9OwogIH0sCgogIHByb3BzOiB7CiAgICB3b3JrdXVpZDoge30KICB9LAogIG1ldGhvZHM6IHsKICAgIHNldFR5cGVMYWJlbChpdGVtcykgewogICAgICBpdGVtcy5tYXAoaXRlbSA9PiB7CiAgICAgICAgaWYgKGl0ZW0udHlwZSA9PT0gImlucHV0IikgewogICAgICAgICAgaXRlbS50eXBlTGFiZWwgPSAiVGV4dC9JbWFnZS9BdWRpbyI7CiAgICAgICAgfSBlbHNlIGlmIChpdGVtLnR5cGUgPT09ICJib29sZWFuIikgewogICAgICAgICAgaXRlbS50eXBlTGFiZWwgPSAiWWVzL05vIjsKICAgICAgICB9IGVsc2UgewogICAgICAgICAgaXRlbS50eXBlTGFiZWwgPSAiTXVsdGlwbGUgQ2hvaWNlIjsKICAgICAgICB9CiAgICAgIH0pOwogICAgICByZXR1cm4gaXRlbXM7CiAgICB9LAoKICAgIGdldEluc3BlY3Rpb25UZW1wbGF0ZUJ5VVVJRCh1dWlkLCB0eXBlKSB7CiAgICAgIFdvcmtPcmRlclNlcnZpY2UuZ2V0SW5zcGVjdGlvblRlbXBsYXRlQnlJbnNwZWN0aW9uVVVJRCh1dWlkKS50aGVuKHJlc3BvbnNlID0+IHsKICAgICAgICBpZiAocmVzcG9uc2Uuc3RhdHVzID09PSAyMDApIHsKICAgICAgICAgIGxldCB3b3JrT3JkZXJJbnNwZWN0aW9uVGVtcGxhdGUgPSByZXNwb25zZS5kYXRhLndvcmtPcmRlckluc3BlY3Rpb25UZW1wbGF0ZTsKCiAgICAgICAgICBpZiAodHlwZSA9PT0gInNhbWUiKSB7CiAgICAgICAgICAgIHRoaXMud29ya09yZGVyU3VtbWFyeS5pbml0aWFsSW5zcGVjdGlvblRpdGxlID0gd29ya09yZGVySW5zcGVjdGlvblRlbXBsYXRlLm5hbWU7CiAgICAgICAgICAgIHRoaXMud29ya09yZGVyU3VtbWFyeS5maW5hbEluc3BlY3Rpb25UaXRsZSA9IHdvcmtPcmRlckluc3BlY3Rpb25UZW1wbGF0ZS5uYW1lOwogICAgICAgICAgICB0aGlzLnF1ZXN0aW9uVHlwZUZvcm1Jbml0aWFsID0gdGhpcy5zZXRUeXBlTGFiZWwod29ya09yZGVySW5zcGVjdGlvblRlbXBsYXRlLmluc3BlY3Rpb25JdGVtcyk7CiAgICAgICAgICAgIHRoaXMucGVyaXZvdXNJbml0aWFsVGVtcGxhdGUgPSB3b3JrT3JkZXJJbnNwZWN0aW9uVGVtcGxhdGU7CiAgICAgICAgICB9IGVsc2UgaWYgKHR5cGUgPT09ICJOZXcgSW5pdGlhbCIpIHsKICAgICAgICAgICAgdGhpcy53b3JrT3JkZXJTdW1tYXJ5LmluaXRpYWxJbnNwZWN0aW9uVGl0bGUgPSB3b3JrT3JkZXJJbnNwZWN0aW9uVGVtcGxhdGUubmFtZTsKICAgICAgICAgICAgdGhpcy5xdWVzdGlvblR5cGVGb3JtSW5pdGlhbCA9IHRoaXMuc2V0VHlwZUxhYmVsKHdvcmtPcmRlckluc3BlY3Rpb25UZW1wbGF0ZS5pbnNwZWN0aW9uSXRlbXMpOwogICAgICAgICAgICB0aGlzLnBlcml2b3VzSW5pdGlhbFRlbXBsYXRlID0gd29ya09yZGVySW5zcGVjdGlvblRlbXBsYXRlOwogICAgICAgICAgfSBlbHNlIGlmICh0eXBlID09PSAiTmV3IEZpbmFsIikgewogICAgICAgICAgICB0aGlzLndvcmtPcmRlclN1bW1hcnkuZmluYWxJbnNwZWN0aW9uVGl0bGUgPSB3b3JrT3JkZXJJbnNwZWN0aW9uVGVtcGxhdGUubmFtZTsKICAgICAgICAgICAgdGhpcy5xdWVzdGlvblR5cGVGb3JtRmluYWwgPSB0aGlzLnNldFR5cGVMYWJlbCh3b3JrT3JkZXJJbnNwZWN0aW9uVGVtcGxhdGUuaW5zcGVjdGlvbkl0ZW1zKTsKICAgICAgICAgICAgdGhpcy5wcmV2aW91c0ZpbmFsVGVtcGxhdGUgPSB3b3JrT3JkZXJJbnNwZWN0aW9uVGVtcGxhdGU7CiAgICAgICAgICB9CiAgICAgICAgfQogICAgICB9KS5jYXRjaChlcnJvciA9PiB7CiAgICAgICAgY29uc29sZS5sb2coZXJyb3IpOwogICAgICB9KTsKICAgIH0sCgogICAgLy9mdW5jdGlvbiB3aWxsIG1hcCBleGlzdGluZyBJbml0aWFsIEluc3BlY3Rpb24gVGVtcGxhdGUgRGF0YQogICAgbWFwSW5pdGlhbEV4aXN0aW5nVGVtcGxhdGUocGxhbm5pbmcpIHsKICAgICAgbGV0IHNlbGVjdGVkT3B0aW9uID0gdGhpcy5pbnBzZWN0aW9uQnlBc3NldENhdGVnb3J5T3B0aW9ucy5maW5kKHZhbCA9PiB2YWwudXVpZCA9PT0gcGxhbm5pbmcuaW5pdGlhbEluc3BlY3Rpb25VVUlEKTsKICAgICAgdGhpcy5pbml0aWFsSW5zcGVjdGlvbkJ5QXNzZXRDYXRlZ29yeSA9IHNlbGVjdGVkT3B0aW9uLm5hbWU7CiAgICAgIHRoaXMucGVyaXZvdXNJbml0aWFsRXhpc3RpbmcgPSBzZWxlY3RlZE9wdGlvbjsKICAgICAgdGhpcy5pbml0aWFsSW5zcGVjdGlvbkJ5QXNzZXRDYXRlZ29yeVNlbGVjdGVkKHsKICAgICAgICBzZWxlY3RlZE9iamVjdDogc2VsZWN0ZWRPcHRpb24KICAgICAgfSk7CiAgICB9LAoKICAgIC8vZnVuY3Rpb24gd2lsbCBtYXAgZXhpc3RpbmcgRmluYWwgSW5zcGVjdGlvbiBUZW1wbGF0ZSBEYXRhCiAgICBtYXBGaW5hbEV4aXN0aW5nVGVtcGxhdGUocGxhbm5pbmcpIHsKICAgICAgbGV0IHNlbGVjdGVkT3B0aW9uID0gdGhpcy5pbnBzZWN0aW9uQnlBc3NldENhdGVnb3J5T3B0aW9ucy5maW5kKHZhbCA9PiB2YWwudXVpZCA9PT0gcGxhbm5pbmcuZmluYWxJbnNwZWN0aW9uVVVJRCk7CiAgICAgIHRoaXMuZmluYWxJbnNwZWN0aW9uQnlBc3NldENhdGVnb3J5ID0gc2VsZWN0ZWRPcHRpb24ubmFtZTsKICAgICAgdGhpcy5wZXJpdm91c0ZpbmFsRXhpc3RpbmcgPSBzZWxlY3RlZE9wdGlvbjsKICAgICAgdGhpcy5maW5hbEluc3BlY3Rpb25CeUFzc2V0Q2F0ZWdvcnlTZWxlY3RlZCh7CiAgICAgICAgc2VsZWN0ZWRPYmplY3Q6IHNlbGVjdGVkT3B0aW9uCiAgICAgIH0pOwogICAgfSwKCiAgICAvL2Z1bmN0aW9uIHdpbGwgbWFwIEZpbmFsIGFuZCBJbml0aWFsIFRlbXBsYXRlcyBEYXRhCiAgICBtYXBJbml0aWFsQW5kRmluYWxJbnNwZWN0aW9uVGVtcGxhdGVzRGF0YShwbGFubmluZykgewogICAgICAvL2NoZWNraW5nIGlmIGZpbmFsIGFuZCBpbml0aWFsIGluc3BlY3Rpb24gVGVtcGxhdGVzIGFyZSBzYW1lCiAgICAgIGlmIChwbGFubmluZy5zYW1lSW5zcGVjdGlvbikgewogICAgICAgIC8vY2hlY2tpbmcgaWYgaXRzIG5ldyB0ZW1wbGF0ZSBvciBleGlzdGluZyBvbmUKICAgICAgICBpZiAoIXBsYW5uaW5nLmZyb21FeGlzdGluZ0luaXRpYWwgJiYgIXBsYW5uaW5nLmZyb21FeGlzdGluZ0ZpbmFsICYmICFwbGFubmluZy5mcm9tSW5zcGVjdGlvbkluaXRpYWwgJiYgIXBsYW5uaW5nLmZyb21JbnNwZWN0aW9uRmluYWwpIHsKICAgICAgICAgIHRoaXMuZmluYWxJbnNwZWN0aW9uU2VsZWN0aW9uID0gIlNhbWUgQXMgSW5pdGlhbCI7CiAgICAgICAgICB0aGlzLmNoZWNrRXhpc3RpbmdJbml0aWFsSW5zcGVjdGlvbiA9IGZhbHNlOwogICAgICAgICAgdGhpcy5nZXRJbnNwZWN0aW9uVGVtcGxhdGVCeVVVSUQocGxhbm5pbmcuaW5pdGlhbEluc3BlY3Rpb25VVUlELCAic2FtZSIpOyAvLyBjYWxsaW5nIGZ1bmN0aW9uIHRvIGdldCBuZXcgdGVtcGxhdGUKICAgICAgICB9IGVsc2UgewogICAgICAgICAgdGhpcy5maW5hbEluc3BlY3Rpb25TZWxlY3Rpb24gPSAiU2FtZSBBcyBJbml0aWFsIjsKICAgICAgICAgIHRoaXMuY2hlY2tFeGlzdGluZ0luaXRpYWxJbnNwZWN0aW9uID0gdHJ1ZTsKICAgICAgICAgIHRoaXMubWFwSW5pdGlhbEV4aXN0aW5nVGVtcGxhdGUocGxhbm5pbmcpOyAvL2NhbGxpbmcgZnVuY3Rpb24gdG8gbWFwIGV4aXN0aW5nIHRlbXBsYXRlCiAgICAgICAgfQogICAgICB9IGVsc2UgewogICAgICAgIHRoaXMuc2FtZSA9IGZhbHNlOyAvL2NoZWNraW5nIGlmIG5ldyBpbml0aWFsIGlucHNlY2l0b24gdGVtcGxhdGUgb3IgRXhpc3Rpbmcgb25lCgogICAgICAgIGlmICghcGxhbm5pbmcuZnJvbUV4aXN0aW5nSW5pdGlhbCAmJiAhcGxhbm5pbmcuZnJvbUluc3BlY3Rpb25Jbml0aWFsKSB7CiAgICAgICAgICB0aGlzLmNoZWNrRXhpc3RpbmdJbml0aWFsSW5zcGVjdGlvbiA9IGZhbHNlOwogICAgICAgICAgdGhpcy5nZXRJbnNwZWN0aW9uVGVtcGxhdGVCeVVVSUQocGxhbm5pbmcuaW5pdGlhbEluc3BlY3Rpb25VVUlELCAiTmV3IEluaXRpYWwiKTsKICAgICAgICB9IGVsc2UgewogICAgICAgICAgdGhpcy5jaGVja0V4aXN0aW5nSW5pdGlhbEluc3BlY3Rpb24gPSB0cnVlOwogICAgICAgICAgdGhpcy5tYXBJbml0aWFsRXhpc3RpbmdUZW1wbGF0ZShwbGFubmluZyk7CiAgICAgICAgfSAvL2NoZWNraW5nIGlmIG5ldyBmaW5hbCBpbnBzZWNpdG9uIHRlbXBsYXRlIG9yIEV4aXN0aW5nIG9uZQoKCiAgICAgICAgaWYgKCFwbGFubmluZy5mcm9tRXhpc3RpbmdGaW5hbCAmJiAhcGxhbm5pbmcuZnJvbUluc3BlY3Rpb25GaW5hbCkgewogICAgICAgICAgdGhpcy5maW5hbEluc3BlY3Rpb25TZWxlY3Rpb24gPSAiQ3JlYXRlIE5ldyBJbnNwZWN0aW9uIFRlbXBsYXRlIjsKICAgICAgICAgIHRoaXMuZ2V0SW5zcGVjdGlvblRlbXBsYXRlQnlVVUlEKHBsYW5uaW5nLmZpbmFsSW5zcGVjdGlvblVVSUQsICJOZXcgRmluYWwiKTsKICAgICAgICB9IGVsc2UgewogICAgICAgICAgdGhpcy5maW5hbEluc3BlY3Rpb25TZWxlY3Rpb24gPSAiU2VsZWN0IEV4aXN0aW5nIjsKICAgICAgICAgIHRoaXMubWFwRmluYWxFeGlzdGluZ1RlbXBsYXRlKHBsYW5uaW5nKTsKICAgICAgICB9CiAgICAgIH0KICAgIH0sCgogICAgZ2V0SW5zcGVjdGlvblRlbXBsYXRlcyhhc3NldFVVSUQsIHRlbmFudFVVSUQpIHsKICAgICAgSW5zcGVjdGlvblNlcnZpY2UuZ2V0SW5zcGVjdGlvblRlbXBsYXRlTmFtZUFuZFVVSUQoYXNzZXRVVUlELCB0ZW5hbnRVVUlEKS50aGVuKHJlc3BvbnNlID0+IHsKICAgICAgICBpZiAocmVzcG9uc2Uuc3RhdHVzID09PSAyMDApIHsKICAgICAgICAgIHRoaXMuaW5zcGVjdGlvbkJ5QXNzZXRPcHRpb25zID0gcmVzcG9uc2UuZGF0YS5pbnNwZWN0aW9uczsKICAgICAgICB9CiAgICAgIH0pLmNhdGNoKGVycm9yID0+IHsKICAgICAgICBjb25zb2xlLmxvZyhlcnJvcik7CiAgICAgIH0pOwogICAgfSwKCiAgICBnZXRJbnNwZWN0aW9uVGVtcGxhdGVGcm9tV29ya09yZGVyKHRlbmFudFVVSUQpIHsKICAgICAgV29ya09yZGVyU2VydmljZS5nZXRXb3JrT3JkZXJJbnNwZWN0aW9uVGVtcGxhdGVzKHRlbmFudFVVSUQpLnRoZW4ocmVzcG9uc2UgPT4gewogICAgICAgIGlmIChyZXNwb25zZS5zdGF0dXMgPT09IDIwMCkgewogICAgICAgICAgdGhpcy5pbnBzZWN0aW9uQnlXb3JrT3JkZXJPcHRpb25zID0gcmVzcG9uc2UuZGF0YS5pbnNwZWN0aW9uczsKCiAgICAgICAgICBmb3IgKGxldCBpbnNwZWN0aW9uIG9mIHRoaXMuaW5wc2VjdGlvbkJ5V29ya09yZGVyT3B0aW9ucykgewogICAgICAgICAgICBpZiAoaW5zcGVjdGlvbi5uYW1lID09PSAiIiB8fCAhaW5zcGVjdGlvbi5uYW1lKSB7CiAgICAgICAgICAgICAgaW5zcGVjdGlvbi5uYW1lID0gIi0iOwogICAgICAgICAgICB9CiAgICAgICAgICB9CiAgICAgICAgfQogICAgICB9KS5jYXRjaChlcnJvciA9PiB7CiAgICAgICAgY29uc29sZS5sb2coZXJyb3IpOwogICAgICB9KTsKICAgIH0sCgogICAgZ2V0SW5zcGVjdGlvblRlbWFwbGF0ZXNCeUFzc2V0Q2F0ZWdvcnkoY2F0ZWdvcnlVVUlEKSB7CiAgICAgIEluc3BlY3Rpb25TZXJ2aWNlLmdldEluc3BlY3Rpb25UZW1wbGF0ZU5hbWVBbmRVVUlEQnlDYXRlZ29yeVVVSUQoY2F0ZWdvcnlVVUlEKS50aGVuKHJlc3BvbnNlID0+IHsKICAgICAgICBpZiAocmVzcG9uc2Uuc3RhdHVzID09PSAyMDApIHsKICAgICAgICAgIHRoaXMuaW5wc2VjdGlvbkJ5QXNzZXRDYXRlZ29yeU9wdGlvbnMgPSByZXNwb25zZS5kYXRhLmluc3BlY3Rpb25zOwoKICAgICAgICAgIGlmICh0aGlzLndvcmtPcmRlckRldGFpbC53b3JrT3JkZXIuc3RhdHVzID09PSAiT3BlbiIpIHsKICAgICAgICAgICAgdGhpcy5tYXBJbml0aWFsQW5kRmluYWxJbnNwZWN0aW9uVGVtcGxhdGVzRGF0YSh0aGlzLndvcmtPcmRlckRldGFpbC53b3JrT3JkZXIucGxhbm5pbmcpOwogICAgICAgICAgfQogICAgICAgIH0KICAgICAgfSkuY2F0Y2goZXJyb3IgPT4gewogICAgICAgIGNvbnNvbGUubG9nKGVycm9yKTsKICAgICAgfSk7CiAgICB9LAoKICAgIHJlbW92ZU11bHRpcGxlQ2hvaWNlSW5pdGlhbChpbmRleCwgbSkgewogICAgICB0aGlzLnF1ZXN0aW9uVHlwZUZvcm1Jbml0aWFsW2luZGV4XS5hbnN3ZXJzLnNwbGljZShtLCAxKTsKICAgIH0sCgogICAgcmVtb3ZlTXVsdGlwbGVDaG9pY2VGaW5hbChpbmRleCwgbSkgewogICAgICB0aGlzLnF1ZXN0aW9uVHlwZUZvcm1GaW5hbFtpbmRleF0uYW5zd2Vycy5zcGxpY2UobSwgMSk7CiAgICB9LAoKICAgIGFkZEFuc3dlcnNBcnJheSh2YWx1ZSwgaW5kZXgpIHsKICAgICAgdGhpcy5xdWVzdGlvblR5cGVGb3JtSW5pdGlhbFtpbmRleF0udHlwZSA9IHZhbHVlLnNlbGVjdGVkT2JqZWN0LnZhbHVlOwoKICAgICAgaWYgKHZhbHVlLnZhbHVlID09PSAiTXVsdGlwbGUgQ2hvaWNlIikgewogICAgICAgIHRoaXMucXVlc3Rpb25UeXBlRm9ybUluaXRpYWxbaW5kZXhdLmFuc3dlcnMucHVzaCgiIiwgIiIpOwogICAgICB9IGVsc2UgewogICAgICAgIHRoaXMucXVlc3Rpb25UeXBlRm9ybUluaXRpYWxbaW5kZXhdLmFuc3dlcnMgPSBbXTsKICAgICAgfQogICAgfSwKCiAgICBhZGRBbnN3ZXJzQXJyYXlGaW5hbCh2YWx1ZSwgaW5kZXgpIHsKICAgICAgdGhpcy5xdWVzdGlvblR5cGVGb3JtRmluYWxbaW5kZXhdLnR5cGUgPSB2YWx1ZS5zZWxlY3RlZE9iamVjdC52YWx1ZTsKCiAgICAgIGlmICh2YWx1ZS52YWx1ZSA9PT0gIk11bHRpcGxlIENob2ljZSIpIHsKICAgICAgICB0aGlzLnF1ZXN0aW9uVHlwZUZvcm1GaW5hbFtpbmRleF0uYW5zd2Vycy5wdXNoKCIiLCAiIik7CiAgICAgIH0gZWxzZSB7CiAgICAgICAgdGhpcy5xdWVzdGlvblR5cGVGb3JtRmluYWxbaW5kZXhdLmFuc3dlcnMgPSBbXTsKICAgICAgfQogICAgfSwKCiAgICBhZGRNdWx0aXBsZUNob2ljZUluaXRpYWwoaW5kZXgpIHsKICAgICAgdGhpcy5xdWVzdGlvblR5cGVGb3JtSW5pdGlhbFtpbmRleF0uYW5zd2Vycy5wdXNoKCIiKTsKICAgIH0sCgogICAgYWRkTXVsdGlwbGVDaG9pY2VGaW5hbChpbmRleCkgewogICAgICB0aGlzLnF1ZXN0aW9uVHlwZUZvcm1GaW5hbFtpbmRleF0uYW5zd2Vycy5wdXNoKCIiKTsKICAgIH0sCgogICAgcmVtb3ZlSW5wdXRGaWVsZHNJbml0aWFsKGluZGV4KSB7CiAgICAgIHRoaXMucXVlc3Rpb25UeXBlRm9ybUluaXRpYWwuc3BsaWNlKGluZGV4LCAxKTsKICAgIH0sCgogICAgcmVtb3ZlSW5wdXRGaWVsZHNGaW5hbChpbmRleCkgewogICAgICB0aGlzLnF1ZXN0aW9uVHlwZUZvcm1GaW5hbC5zcGxpY2UoaW5kZXgsIDEpOwogICAgfSwKCiAgICBhZGRJbnB1dEZpZWxkc0luaXRpYWwoKSB7CiAgICAgIHRoaXMucXVlc3Rpb25UeXBlRm9ybUluaXRpYWwucHVzaCh7CiAgICAgICAgbmFtZTogIiIsCiAgICAgICAgdHlwZTogIiIsCiAgICAgICAgcXVlc3Rpb246ICIiLAogICAgICAgIGFuc3dlcnM6IFtdLAogICAgICAgIG1hbmRhdG9yeTogdHJ1ZQogICAgICB9KTsKICAgIH0sCgogICAgYWRkSW5wdXRGaWVsZHNGaW5hbCgpIHsKICAgICAgdGhpcy5xdWVzdGlvblR5cGVGb3JtRmluYWwucHVzaCh7CiAgICAgICAgbmFtZTogIiIsCiAgICAgICAgdHlwZTogIiIsCiAgICAgICAgcXVlc3Rpb246ICIiLAogICAgICAgIGFuc3dlcnM6IFtdLAogICAgICAgIG1hbmRhdG9yeTogdHJ1ZQogICAgICB9KTsKICAgIH0sCgogICAgZmluYWxJbnNwZWN0aW9uQnlBc3NldFNlbGVjdGVkKHZhbHVlKSB7CiAgICAgIHRoaXMuc2VsZWN0ZWRGaW5hbEluc3BlY3Rpb25CeUFzc2V0ID0gdmFsdWUuc2VsZWN0ZWRPYmplY3Q7CiAgICAgIHRoaXMuZmluYWxJbnNwZWN0aW9uQnlBc3NldENhdGVnb3J5ID0gIiI7CiAgICAgIHRoaXMuc2VsZWN0ZWRGaW5hbEluc3BlY3Rpb25CeUFzc2V0Q2F0ZWdvcnkgPSAiIjsKICAgICAgdGhpcy5maW5hbEluc3BlY3Rpb25CeVdvcmtPcmRlciA9ICIiOwogICAgICB0aGlzLnNlbGVjdGVkRmluYWxJbnNwZWN0aW9uQnlXb3JrT3JkZXIgPSAiIjsKICAgICAgdGhpcy5maW5hbEluc3BlY3Rpb25SZXNldCsrOwogICAgfSwKCiAgICBmaW5hbEluc3BlY3Rpb25CeUFzc2V0Q2F0ZWdvcnlTZWxlY3RlZCh2YWx1ZSkgewogICAgICB0aGlzLnNlbGVjdGVkRmluYWxJbnNwZWN0aW9uQnlBc3NldENhdGVnb3J5ID0gdmFsdWUuc2VsZWN0ZWRPYmplY3Q7CiAgICAgIHRoaXMud29ya09yZGVyU3VtbWFyeS5zZWxlY3RlZEZpbmFsSW5zcGVjdGlvbkJ5QXNzZXRDYXRlZ29yeSA9IHRoaXMuc2VsZWN0ZWRGaW5hbEluc3BlY3Rpb25CeUFzc2V0Q2F0ZWdvcnk7CiAgICAgIHRoaXMuZmluYWxJbnNwZWN0aW9uQnlBc3NldCA9ICIiOwogICAgICB0aGlzLnNlbGVjdGVkRmluYWxJbnNwZWN0aW9uQnlBc3NldCA9ICIiOwogICAgICB0aGlzLmZpbmFsSW5zcGVjdGlvbkJ5V29ya09yZGVyID0gIiI7CiAgICAgIHRoaXMuc2VsZWN0ZWRGaW5hbEluc3BlY3Rpb25CeVdvcmtPcmRlciA9ICIiOwogICAgICB0aGlzLmZpbmFsSW5zcGVjdGlvblJlc2V0Kys7CiAgICB9LAoKICAgIGZpbmFsSW5zcGVjdGlvbkJ5V29ya09yZGVyU2VsZWN0ZWQodmFsdWUpIHsKICAgICAgdGhpcy5zZWxlY3RlZEZpbmFsSW5zcGVjdGlvbkJ5V29ya09yZGVyID0gdmFsdWUuc2VsZWN0ZWRPYmplY3Q7CiAgICAgIHRoaXMuZmluYWxJbnNwZWN0aW9uQnlBc3NldCA9ICIiOwogICAgICB0aGlzLnNlbGVjdGVkRmluYWxJbnNwZWN0aW9uQnlBc3NldCA9ICIiOwogICAgICB0aGlzLmZpbmFsSW5zcGVjdGlvbkJ5QXNzZXRDYXRlZ29yeSA9ICIiOwogICAgICB0aGlzLnNlbGVjdGVkRmluYWxJbnNwZWN0aW9uQnlBc3NldENhdGVnb3J5ID0gIiI7CiAgICAgIHRoaXMuZmluYWxJbnNwZWN0aW9uUmVzZXQrKzsKICAgIH0sCgogICAgaW5pdGlhbEluc3BlY3Rpb25CeUFzc2V0U2VsZWN0ZWQodmFsdWUpIHsKICAgICAgdGhpcy5zZWxlY3RlZEluaXRpYWxJbnNwZWN0aW9uQnlBc3NldCA9IHZhbHVlLnNlbGVjdGVkT2JqZWN0OwogICAgICB0aGlzLmluaXRpYWxJbnNwZWN0aW9uQnlBc3NldENhdGVnb3J5ID0gIiI7CiAgICAgIHRoaXMuc2VsZWN0ZWRJbml0aWFsSW5zcGVjdGlvbkJ5QXNzZXRDYXRlZ29yeSA9ICIiOwogICAgICB0aGlzLmluaXRpYWxJbnNwZWN0aW9uQnlXb3JrT3JkZXIgPSAiIjsKICAgICAgdGhpcy5zZWxlY3RlZEluaXRpYWxJbnNwZWN0aW9uQnlXb3JrT3JkZXIgPSAiIjsKICAgICAgdGhpcy5pbnNwZWN0aW9uUmVzZXQrKzsKICAgIH0sCgogICAgaW5pdGlhbEluc3BlY3Rpb25CeUFzc2V0Q2F0ZWdvcnlTZWxlY3RlZCh2YWx1ZSkgewogICAgICB0aGlzLmluaXRpYWxJbnNwZWN0aW9uVGVtcCA9IHZhbHVlLnNlbGVjdGVkT2JqZWN0OwoKICAgICAgaWYgKHRoaXMuc2FtZSA9PT0gdHJ1ZSkgewogICAgICAgIGlmICh0aGlzLmNoZWNrRXhpc3RpbmdJbml0aWFsSW5zcGVjdGlvbiA9PT0gdHJ1ZSkgewogICAgICAgICAgdGhpcy53b3JrT3JkZXJTdW1tYXJ5LnNlbGVjdGVkRmluYWxJbnNwZWN0aW9uQnlBc3NldENhdGVnb3J5ID0gdmFsdWUuc2VsZWN0ZWRPYmplY3Q7CiAgICAgICAgICB0aGlzLndvcmtPcmRlclN1bW1hcnlJbmRleCsrOwogICAgICAgIH0KICAgICAgfQoKICAgICAgdGhpcy5zZWxlY3RlZEluaXRpYWxJbnNwZWN0aW9uQnlBc3NldENhdGVnb3J5ID0gdmFsdWUuc2VsZWN0ZWRPYmplY3Q7CiAgICAgIHRoaXMud29ya09yZGVyU3VtbWFyeS5zZWxlY3RlZEluaXRpYWxJbnNwZWN0aW9uQnlBc3NldENhdGVnb3J5ID0gdGhpcy5zZWxlY3RlZEluaXRpYWxJbnNwZWN0aW9uQnlBc3NldENhdGVnb3J5OwogICAgICB0aGlzLmluaXRpYWxJbnNwZWN0aW9uQnlBc3NldCA9ICIiOwogICAgICB0aGlzLnNlbGVjdGVkSW5pdGlhbEluc3BlY3Rpb25CeUFzc2V0ID0gIiI7CiAgICAgIHRoaXMuaW5pdGlhbEluc3BlY3Rpb25CeVdvcmtPcmRlciA9ICIiOwogICAgICB0aGlzLnNlbGVjdGVkSW5pdGlhbEluc3BlY3Rpb25CeVdvcmtPcmRlciA9ICIiOwogICAgICB0aGlzLmluc3BlY3Rpb25SZXNldCsrOwogICAgfSwKCiAgICBjbGVhckluaXRpYWxJbnNwZWN0aW9uQnlBc3NldENhdGVnb3J5KCkgewogICAgICB0aGlzLmluaXRpYWxJbnNwZWN0aW9uQnlBc3NldENhdGVnb3J5ID0gbnVsbDsKICAgICAgdGhpcy5pbml0aWFsQXNzZXRJbmRleCsrOwogICAgfSwKCiAgICBpbml0aWFsSW5zcGVjdGlvbkJ5V29ya09yZGVyU2VsZWN0ZWQodmFsdWUpIHsKICAgICAgdGhpcy5zZWxlY3RlZEluaXRpYWxJbnNwZWN0aW9uQnlXb3JrT3JkZXIgPSB2YWx1ZS5zZWxlY3RlZE9iamVjdDsKICAgICAgdGhpcy5pbml0aWFsSW5zcGVjdGlvbkJ5QXNzZXQgPSAiIjsKICAgICAgdGhpcy5zZWxlY3RlZEluaXRpYWxJbnNwZWN0aW9uQnlBc3NldCA9ICIiOwogICAgICB0aGlzLmluaXRpYWxJbnNwZWN0aW9uQnlBc3NldENhdGVnb3J5ID0gIiI7CiAgICAgIHRoaXMuc2VsZWN0ZWRJbml0aWFsSW5zcGVjdGlvbkJ5QXNzZXRDYXRlZ29yeSA9ICIiOwogICAgICB0aGlzLmluc3BlY3Rpb25SZXNldCsrOwogICAgfSwKCiAgICBmaW5hbEluc3BlY3Rpb25PcHRpb25TZWxlY3RlZCh2YWx1ZSkgewogICAgICB0aGlzLndvcmtPcmRlclN1bW1hcnkuZmluYWxJbnNwZWN0aW9uVGl0bGUgPSAiIjsKICAgICAgdGhpcy53b3JrT3JkZXJTdW1tYXJ5LnNlbGVjdGVkRmluYWxJbnNwZWN0aW9uQnlBc3NldENhdGVnb3J5ID0gIiI7CiAgICAgIHRoaXMuZmluYWxJbnNwZWN0aW9uQnlBc3NldENhdGVnb3J5ID0gW107CiAgICAgIHRoaXMuc2VsZWN0ZWRGaW5hbEluc3BlY3Rpb25CeUFzc2V0Q2F0ZWdvcnkgPSAiIjsKCiAgICAgIGlmICh2YWx1ZS52YWx1ZSA9PT0gIlNhbWUgQXMgSW5pdGlhbCIpIHsKICAgICAgICB0aGlzLnNhbWUgPSB0cnVlOwoKICAgICAgICBpZiAodGhpcy5jaGVja0V4aXN0aW5nSW5pdGlhbEluc3BlY3Rpb24pIHsKICAgICAgICAgIHRoaXMud29ya09yZGVyU3VtbWFyeS5zZWxlY3RlZEZpbmFsSW5zcGVjdGlvbkJ5QXNzZXRDYXRlZ29yeSA9IHRoaXMud29ya09yZGVyU3VtbWFyeS5zZWxlY3RlZEluaXRpYWxJbnNwZWN0aW9uQnlBc3NldENhdGVnb3J5OwogICAgICAgIH0gZWxzZSB7CiAgICAgICAgICB0aGlzLndvcmtPcmRlclN1bW1hcnkuZmluYWxJbnNwZWN0aW9uVGl0bGUgPSB0aGlzLndvcmtPcmRlclN1bW1hcnkuaW5pdGlhbEluc3BlY3Rpb25UaXRsZTsKICAgICAgICB9CiAgICAgIH0gZWxzZSB7CiAgICAgICAgdGhpcy5zYW1lID0gZmFsc2U7CgogICAgICAgIGlmICh2YWx1ZS52YWx1ZSA9PT0gIlNlbGVjdCBFeGlzdGluZyIpIHsKICAgICAgICAgIC8vY2hlY2tpbmcgaWYgZXhpc3RpbmcgdGVtcGxhdGUgd2FzIHRoZSBwZXJpdm91cyB0ZW1wbGF0ZQogICAgICAgICAgaWYgKHRoaXMud29ya09yZGVyRGV0YWlsLndvcmtPcmRlci5wbGFubmluZy5mcm9tRXhpc3RpbmdGaW5hbCB8fCB0aGlzLndvcmtPcmRlckRldGFpbC53b3JrT3JkZXIucGxhbm5pbmcuZnJvbUluc3BlY3Rpb25GaW5hbCkgewogICAgICAgICAgICB0aGlzLm1hcEZpbmFsRXhpc3RpbmdUZW1wbGF0ZSh0aGlzLndvcmtPcmRlckRldGFpbC53b3JrT3JkZXIucGxhbm5pbmcpOwogICAgICAgICAgICB0aGlzLnF1ZXN0aW9uVHlwZUZvcm1GaW5hbCA9IFtdOwogICAgICAgICAgICB0aGlzLmFkZElucHV0RmllbGRzRmluYWwoKTsKICAgICAgICAgIH0KICAgICAgICB9IGVsc2UgewogICAgICAgICAgLy9jaGVja2luZyBpZiBuZXcgdGVtcGxhdGUgd2FzIHRoZSBwZXJpdm91cyB0ZW1wbGF0ZQogICAgICAgICAgaWYgKCF0aGlzLndvcmtPcmRlckRldGFpbC53b3JrT3JkZXIucGxhbm5pbmcuZnJvbUV4aXN0aW5nRmluYWwgJiYgIXRoaXMud29ya09yZGVyRGV0YWlsLndvcmtPcmRlci5wbGFubmluZy5mcm9tSW5zcGVjdGlvbkZpbmFsKSB7CiAgICAgICAgICAgIGlmICghdGhpcy53b3JrT3JkZXJEZXRhaWwud29ya09yZGVyLnBsYW5uaW5nLnNhbWVJbnNwZWN0aW9uKSB7CiAgICAgICAgICAgICAgdGhpcy53b3JrT3JkZXJTdW1tYXJ5LmZpbmFsSW5zcGVjdGlvblRpdGxlID0gdGhpcy5wcmV2aW91c0ZpbmFsVGVtcGxhdGUubmFtZTsKICAgICAgICAgICAgICB0aGlzLnF1ZXN0aW9uVHlwZUZvcm1GaW5hbCA9IHRoaXMuc2V0VHlwZUxhYmVsKHRoaXMucHJldmlvdXNGaW5hbFRlbXBsYXRlLml0ZW1zKTsKICAgICAgICAgICAgfSBlbHNlIHsKICAgICAgICAgICAgICB0aGlzLnF1ZXN0aW9uVHlwZUZvcm1GaW5hbCA9IFtdOwogICAgICAgICAgICAgIHRoaXMuYWRkSW5wdXRGaWVsZHNGaW5hbCgpOwogICAgICAgICAgICB9CiAgICAgICAgICB9IGVsc2UgewogICAgICAgICAgICB0aGlzLnF1ZXN0aW9uVHlwZUZvcm1GaW5hbCA9IFtdOwogICAgICAgICAgICB0aGlzLmFkZElucHV0RmllbGRzRmluYWwoKTsKICAgICAgICAgIH0KICAgICAgICB9CiAgICAgIH0KCiAgICAgIHRoaXMud29ya09yZGVyU3VtbWFyeUluZGV4Kys7CiAgICB9LAoKICAgIGluaXRpYWxJbnNwZWN0aW9uRnVuYyh2YWx1ZSkgewogICAgICBpZiAodGhpcy5zYW1lID09PSB0cnVlKSB7CiAgICAgICAgaWYgKHRoaXMuY2hlY2tFeGlzdGluZ0luaXRpYWxJbnNwZWN0aW9uID09PSBmYWxzZSkgewogICAgICAgICAgdGhpcy53b3JrT3JkZXJTdW1tYXJ5LmZpbmFsSW5zcGVjdGlvblRpdGxlID0gdmFsdWU7CiAgICAgICAgfQogICAgICB9CgogICAgICB0aGlzLndvcmtPcmRlclN1bW1hcnlJbmRleCsrOwogICAgfSwKCiAgICBleGlzdGluZ0Z1bmN0aW9uKHZhbHVlKSB7CiAgICAgIHRoaXMud29ya09yZGVyU3VtbWFyeS5pbml0aWFsSW5zcGVjdGlvblRpdGxlID0gIiI7CiAgICAgIHRoaXMud29ya09yZGVyU3VtbWFyeS5zZWxlY3RlZEluaXRpYWxJbnNwZWN0aW9uQnlBc3NldENhdGVnb3J5ID0gIiI7CgogICAgICBpZiAodGhpcy5zYW1lID09PSB0cnVlKSB7CiAgICAgICAgdGhpcy53b3JrT3JkZXJTdW1tYXJ5LmZpbmFsSW5zcGVjdGlvblRpdGxlID0gIiI7CiAgICAgICAgdGhpcy53b3JrT3JkZXJTdW1tYXJ5LnNlbGVjdGVkRmluYWxJbnNwZWN0aW9uQnlBc3NldENhdGVnb3J5ID0gIiI7CiAgICAgIH0gLy93aGVuIGNoZWNrIG9yIHVuLWNoZWNrIGNoZWNrLWJveCBjaGVja2luZyB0aGVuIG1hcHBpbmcgVGVtcGxhdGVzIGRhdGEgYWdhaW4KCgogICAgICBpZiAodGhpcy53b3JrT3JkZXJEZXRhaWwud29ya09yZGVyLnBsYW5uaW5nLnNhbWVJbnNwZWN0aW9uKSB7CiAgICAgICAgdGhpcy5maW5hbEluc3BlY3Rpb25TZWxlY3Rpb24gPSAiU2FtZSBBcyBJbml0aWFsIjsKICAgICAgfQoKICAgICAgaWYgKHZhbHVlID09PSB0cnVlKSB7CiAgICAgICAgLy9jaGVja2luZyBpZiBleGlzdGluZyB0ZW1wbGF0ZSB3YXMgdGhlIHBlcml2b3VzIHRlbXBsYXRlCiAgICAgICAgaWYgKHRoaXMud29ya09yZGVyRGV0YWlsLndvcmtPcmRlci5wbGFubmluZy5mcm9tRXhpc3RpbmdJbml0aWFsIHx8IHRoaXMud29ya09yZGVyRGV0YWlsLndvcmtPcmRlci5wbGFubmluZy5mcm9tSW5zcGVjdGlvbkluaXRpYWwpIHsKICAgICAgICAgIHRoaXMubWFwSW5pdGlhbEV4aXN0aW5nVGVtcGxhdGUodGhpcy53b3JrT3JkZXJEZXRhaWwud29ya09yZGVyLnBsYW5uaW5nKTsKICAgICAgICAgIHRoaXMucXVlc3Rpb25UeXBlRm9ybUluaXRpYWwgPSBbXTsKICAgICAgICAgIHRoaXMuYWRkSW5wdXRGaWVsZHNJbml0aWFsKCk7CiAgICAgICAgfQogICAgICB9IGVsc2UgewogICAgICAgIC8vY2hlY2tpbmcgaWYgbmV3IHRlbXBsYXRlIHdhcyB0aGUgcGVyaXZvdXMgdGVtcGxhdGUKICAgICAgICBpZiAoIXRoaXMud29ya09yZGVyRGV0YWlsLndvcmtPcmRlci5wbGFubmluZy5mcm9tRXhpc3RpbmdJbml0aWFsICYmICF0aGlzLndvcmtPcmRlckRldGFpbC53b3JrT3JkZXIucGxhbm5pbmcuZnJvbUluc3BlY3Rpb25Jbml0aWFsKSB7CiAgICAgICAgICB0aGlzLndvcmtPcmRlclN1bW1hcnkuaW5pdGlhbEluc3BlY3Rpb25UaXRsZSA9IHRoaXMucGVyaXZvdXNJbml0aWFsVGVtcGxhdGUubmFtZTsKCiAgICAgICAgICBpZiAodGhpcy53b3JrT3JkZXJEZXRhaWwud29ya09yZGVyLnBsYW5uaW5nLnNhbWVJbnNwZWN0aW9uKSB7CiAgICAgICAgICAgIHRoaXMud29ya09yZGVyU3VtbWFyeS5maW5hbEluc3BlY3Rpb25UaXRsZSA9IHRoaXMud29ya09yZGVyU3VtbWFyeS5pbml0aWFsSW5zcGVjdGlvblRpdGxlOwogICAgICAgICAgfQoKICAgICAgICAgIHRoaXMucXVlc3Rpb25UeXBlRm9ybUluaXRpYWwgPSB0aGlzLnNldFR5cGVMYWJlbCh0aGlzLnBlcml2b3VzSW5pdGlhbFRlbXBsYXRlLmluc3BlY3Rpb25JdGVtcyk7CiAgICAgICAgfSBlbHNlIHsKICAgICAgICAgIHRoaXMucXVlc3Rpb25UeXBlRm9ybUluaXRpYWwgPSBbXTsKICAgICAgICAgIHRoaXMuYWRkSW5wdXRGaWVsZHNJbml0aWFsKCk7CiAgICAgICAgfQoKICAgICAgICB0aGlzLmluaXRpYWxJbnNwZWN0aW9uQnlBc3NldENhdGVnb3J5ID0gIiI7CiAgICAgICAgdGhpcy5zZWxlY3RlZEluaXRpYWxJbnNwZWN0aW9uQnlBc3NldENhdGVnb3J5ID0gIiI7CiAgICAgICAgdGhpcy5pbml0aWFsQXNzZXRJbmRleCsrOwogICAgICB9CgogICAgICB0aGlzLndvcmtPcmRlclN1bW1hcnlJbmRleCsrOwogICAgfSwKCiAgICBzaWRlQmFySW5kZXgoKSB7CiAgICAgIHRoaXMuc2lkZWJhclVwZGF0ZSsrOwogICAgfSwKCiAgICBnZXRGb3JtRXJyb3JNZXNzYWdlKGZpZWxkVmFsaWRhdGlvbikgewogICAgICBpZiAoZmllbGRWYWxpZGF0aW9uICYmIGZpZWxkVmFsaWRhdGlvbi4kZGlydHkpIHsKICAgICAgICByZXR1cm4gRnVuY3Rpb25zLmdldEZvcm1GaWVsZEVycm9yTWVzc2FnZShmaWVsZFZhbGlkYXRpb24pOwogICAgICB9CiAgICB9LAoKICAgIG9uSXNzdWVOdW1iZXJTZWxlY3QodmFsdWUpIHsKICAgICAgdGhpcy53b3JrT3JkZXJEZXRhaWwud29ya09yZGVyLmlzc3VlcyA9IFtdOwoKICAgICAgaWYgKHZhbHVlLmxlbmd0aCA+IDApIHsKICAgICAgICB0aGlzLndvcmtPcmRlckRldGFpbC53b3JrT3JkZXIuaXNzdWVzID0gdmFsdWUuZmlsdGVyKHYgPT4gdi5pZCAhPT0gbnVsbCAmJiB2LmlkICE9PSB1bmRlZmluZWQpOwogICAgICB9IGVsc2UgewogICAgICAgIHRoaXMud29ya09yZGVyRGV0YWlsLndvcmtPcmRlci5pc3N1ZXMgPSBudWxsOwogICAgICB9CiAgICB9LAoKICAgIGNsb3NlSXNzdWVEaWFsb2coKSB7CiAgICAgIHRoaXMudmlld1Bvb2xJc3N1ZSA9IGZhbHNlOwogICAgfSwKCiAgICB2aWV3SXNzdWUoaXNzdWUpIHsKICAgICAgdGhpcy5pc3N1ZVVVSUQgPSBpc3N1ZS51dWlkOwogICAgICB0aGlzLnZpZXdQb29sSXNzdWUgPSB0cnVlOwogICAgfSwKCiAgICB1cGRhdGVXb3JrT3JkZXIoKSB7CiAgICAgIHRoaXMuJHYuJHRvdWNoKCk7CgogICAgICBpZiAodGhpcy4kdi4kaW52YWxpZCkgewogICAgICAgIHRoaXMuc2hvd1RvYXN0KCJQbGVhc2UgZmlsbCBhbGwgcmVxdWlyZWQgZmllbGRzIiwgIndhcm5pbmciKTsKICAgICAgICByZXR1cm47CiAgICAgIH0KCiAgICAgIGxldCBzdW1tYXJ5X2Zvcm1fdmFsZGlhdGlvbnMgPSB0aGlzLiRyZWZzLndvcmtPcmRlclN1bW1hcnlGb3JtICYmIHRoaXMuJHJlZnMud29ya09yZGVyU3VtbWFyeUZvcm0uY2hlY2tWYWxpZGF0aW9ucygpID8gdGhpcy4kcmVmcy53b3JrT3JkZXJTdW1tYXJ5Rm9ybS5jaGVja1ZhbGlkYXRpb25zKCkgOiBudWxsOwogICAgICBsZXQgYXNzaWdubWVudF9mb3JtX3ZhbGlkYXRpb25zID0gdGhpcy4kcmVmcy53b3JrT3JkZXJBc3NpZ25tZW50Rm9ybSAmJiB0aGlzLiRyZWZzLndvcmtPcmRlckFzc2lnbm1lbnRGb3JtLmNoZWNrVmFsaWRhdGlvbnMoKSA/IHRoaXMuJHJlZnMud29ya09yZGVyQXNzaWdubWVudEZvcm0uY2hlY2tWYWxpZGF0aW9ucygpIDogbnVsbDsKCiAgICAgIGlmIChzdW1tYXJ5X2Zvcm1fdmFsZGlhdGlvbnMpIHsKICAgICAgICB0aGlzLnNob3dUb2FzdCgiUGxlYXNlIGZpbGwgYWxsIHJlcXVpcmVkIGZpZWxkcyIsICJ3YXJuaW5nIik7CiAgICAgICAgcmV0dXJuOwogICAgICB9CgogICAgICBpZiAoYXNzaWdubWVudF9mb3JtX3ZhbGlkYXRpb25zKSB7CiAgICAgICAgdGhpcy5zaG93VG9hc3QoIlBsZWFzZSBmaWxsIGFsbCByZXF1aXJlZCBmaWVsZHMiLCAid2FybmluZyIpOwogICAgICAgIHJldHVybjsKICAgICAgfQoKICAgICAgdGhpcy5sb2FkZXJGbGFnID0gdHJ1ZTsKICAgICAgbGV0IGluaXRpYWxJbnNwZWN0aW9uVGVtcGxhdGUgPSBudWxsOwogICAgICBsZXQgZmluYWxJbnNwZWN0aW9uVGVtcGxhdGUgPSBudWxsOwogICAgICBsZXQgZnJvbUluc3BlY3Rpb25Jbml0aWFsID0gZmFsc2U7CiAgICAgIGxldCBmcm9tSW5zcGVjdGlvbkZpbmFsID0gZmFsc2U7CiAgICAgIGxldCBpbml0aWFsSW5zcGVjdGlvbk9wdGlvbiA9IG51bGw7CiAgICAgIGxldCBmaW5hbEluc3BlY3Rpb25PcHRpb24gPSBudWxsOwogICAgICB2YXIgaW5pdGlhbEluc3BlY3Rpb25UZW1wbGF0ZUxpbmtpbmdVVUlEID0gbnVsbDsKICAgICAgbGV0IGZpbmFsSW5zcGVjdGlvblRlbXBsYXRlTGlua2luZ1VVSUQgPSBudWxsOwogICAgICBsZXQgaW5pdGlhbExpbmtJbnNwZWN0aW9uVHlwZSA9IG51bGw7CiAgICAgIGxldCBmaW5hbExpbmtJbnNwZWN0aW9uVHlwZSA9IG51bGw7CiAgICAgIHRoaXMuJHJlZnMuaXNzdWVzQWNjb3JkaW9uLm9wZW5GbGFnID0gZmFsc2U7CgogICAgICBpZiAodGhpcy5jaGVja0V4aXN0aW5nSW5pdGlhbEluc3BlY3Rpb24gPT09IHRydWUpIHsKICAgICAgICBpZiAodGhpcy5zZWxlY3RlZEluaXRpYWxJbnNwZWN0aW9uQnlBc3NldENhdGVnb3J5ICE9PSAiIikgewogICAgICAgICAgaW5pdGlhbExpbmtJbnNwZWN0aW9uVHlwZSA9ICJpbnNwZWN0aW9uIjsKICAgICAgICB9CiAgICAgIH0KCiAgICAgIGlmICh0aGlzLmZpbmFsSW5zcGVjdGlvblNlbGVjdGlvbiA9PT0gIlNlbGVjdCBFeGlzdGluZyIpIHsKICAgICAgICBpZiAodGhpcy5zZWxlY3RlZEZpbmFsSW5zcGVjdGlvbkJ5QXNzZXRDYXRlZ29yeSAhPT0gIiIpIHsKICAgICAgICAgIGZpbmFsTGlua0luc3BlY3Rpb25UeXBlID0gImluc3BlY3Rpb24iOwogICAgICAgIH0KICAgICAgfQoKICAgICAgaWYgKHRoaXMucXVlc3Rpb25UeXBlRm9ybUluaXRpYWwubGVuZ3RoID4gMCkgewogICAgICAgIGluaXRpYWxJbnNwZWN0aW9uVGVtcGxhdGUgPSB7CiAgICAgICAgICBuYW1lOiB0aGlzLndvcmtPcmRlclN1bW1hcnkuaW5pdGlhbEluc3BlY3Rpb25UaXRsZSwKICAgICAgICAgIGluc3BlY3Rpb25JdGVtczogdGhpcy5xdWVzdGlvblR5cGVGb3JtSW5pdGlhbCwKICAgICAgICAgIHV1aWQ6IHRoaXMucGVyaXZvdXNJbml0aWFsVGVtcGxhdGUudXVpZCAhPT0gbnVsbCAmJiB0aGlzLnBlcml2b3VzSW5pdGlhbFRlbXBsYXRlLnV1aWQgIT09IHVuZGVmaW5lZCA/IHRoaXMucGVyaXZvdXNJbml0aWFsVGVtcGxhdGUudXVpZCA6IG51bGwKICAgICAgICB9OwogICAgICAgIGluaXRpYWxJbnNwZWN0aW9uT3B0aW9uID0gInNhdmUiOwogICAgICAgIGZyb21JbnNwZWN0aW9uSW5pdGlhbCA9IGZhbHNlOwogICAgICB9IGVsc2UgewogICAgICAgIGZyb21JbnNwZWN0aW9uSW5pdGlhbCA9IHRydWU7CiAgICAgIH0KCiAgICAgIGlmICh0aGlzLnF1ZXN0aW9uVHlwZUZvcm1GaW5hbC5sZW5ndGggPiAwKSB7CiAgICAgICAgZmluYWxJbnNwZWN0aW9uVGVtcGxhdGUgPSB7CiAgICAgICAgICBuYW1lOiB0aGlzLndvcmtPcmRlclN1bW1hcnkuZmluYWxJbnNwZWN0aW9uVGl0bGUsCiAgICAgICAgICBpbnNwZWN0aW9uSXRlbXM6IHRoaXMucXVlc3Rpb25UeXBlRm9ybUZpbmFsLAogICAgICAgICAgdXVpZDogdGhpcy5wcmV2aW91c0ZpbmFsVGVtcGxhdGUudXVpZCAhPT0gbnVsbCAmJiB0aGlzLnByZXZpb3VzRmluYWxUZW1wbGF0ZS51dWlkICE9PSB1bmRlZmluZWQgPyB0aGlzLnByZXZpb3VzRmluYWxUZW1wbGF0ZS51dWlkIDogbnVsbAogICAgICAgIH07CiAgICAgICAgZmluYWxJbnNwZWN0aW9uT3B0aW9uID0gInNhdmUiOwogICAgICAgIGZyb21JbnNwZWN0aW9uRmluYWwgPSBmYWxzZTsKICAgICAgfSBlbHNlIHsKICAgICAgICBmcm9tSW5zcGVjdGlvbkZpbmFsID0gdHJ1ZTsKICAgICAgfQoKICAgICAgaWYgKHRoaXMuc2FtZUFzSW5pdGlhbEluc3BlY3Rpb24pIHsKICAgICAgICB0aGlzLndvcmtPcmRlckRldGFpbC53b3JrT3JkZXIucGxhbm5pbmcuc2FtZUluc3BlY3Rpb24gPSB0cnVlOwogICAgICB9CgogICAgICBpZiAodGhpcy53b3JrT3JkZXJEZXRhaWwud29ya09yZGVyLnBsYW5uaW5nLmZyb21JbnNwZWN0aW9uSW5pdGlhbCkgewogICAgICAgIGlmICh0aGlzLnNlbGVjdGVkSW5pdGlhbEluc3BlY3Rpb25CeUFzc2V0ICE9PSBudWxsKSB7CiAgICAgICAgICB0aGlzLndvcmtPcmRlckRldGFpbC53b3JrT3JkZXIucGxhbm5pbmcuaW5pdGlhbEluc3BlY3Rpb25VVUlEID0gdGhpcy5zZWxlY3RlZEluaXRpYWxJbnNwZWN0aW9uQnlBc3NldC52YWx1ZTsKICAgICAgICB9IGVsc2UgaWYgKHRoaXMuc2VsZWN0ZWRJbml0aWFsSW5zcGVjdGlvbkJ5QXNzZXRDYXRlZ29yeSAhPT0gbnVsbCkgewogICAgICAgICAgdGhpcy53b3JrT3JkZXJEZXRhaWwud29ya09yZGVyLnBsYW5uaW5nLmluaXRpYWxJbnNwZWN0aW9uVVVJRCA9IHRoaXMuc2VsZWN0ZWRJbml0aWFsSW5zcGVjdGlvbkJ5QXNzZXRDYXRlZ29yeS52YWx1ZTsKICAgICAgICB9IGVsc2UgewogICAgICAgICAgdGhpcy53b3JrT3JkZXJEZXRhaWwud29ya09yZGVyLnBsYW5uaW5nLmluaXRpYWxJbnNwZWN0aW9uVVVJRCA9IHRoaXMuc2VsZWN0ZWRGaW5hbEluc3BlY3Rpb25CeVdvcmtPcmRlci52YWx1ZTsKICAgICAgICB9CiAgICAgIH0KCiAgICAgIGlmICh0aGlzLndvcmtPcmRlckRldGFpbC53b3JrT3JkZXIucGxhbm5pbmcuZnJvbUluc3BlY3Rpb25GaW5hbCkgewogICAgICAgIGlmICh0aGlzLnNhbWVBc0luaXRpYWxJbnNwZWN0aW9uKSB7CiAgICAgICAgICB0aGlzLndvcmtPcmRlckRldGFpbC53b3JrT3JkZXIucGxhbm5pbmcuZmluYWxJbnNwZWN0aW9uVVVJRCA9IHRoaXMud29ya09yZGVyRGV0YWlsLndvcmtPcmRlci5wbGFubmluZy5pbml0aWFsSW5zcGVjdGlvblVVSUQ7CiAgICAgICAgfSBlbHNlIHsKICAgICAgICAgIGlmICh0aGlzLnNlbGVjdGVkRmluYWxJbnNwZWN0aW9uQnlBc3NldCAhPT0gbnVsbCkgewogICAgICAgICAgICB0aGlzLndvcmtPcmRlckRldGFpbC53b3JrT3JkZXIucGxhbm5pbmcuZmluYWxJbnNwZWN0aW9uVVVJRCA9IHRoaXMuc2VsZWN0ZWRGaW5hbEluc3BlY3Rpb25CeUFzc2V0LnZhbHVlOwogICAgICAgICAgfSBlbHNlIGlmICh0aGlzLnNlbGVjdGVkRmluYWxJbnNwZWN0aW9uQnlBc3NldENhdGVnb3J5ICE9PSBudWxsKSB7CiAgICAgICAgICAgIHRoaXMud29ya09yZGVyRGV0YWlsLndvcmtPcmRlci5wbGFubmluZy5maW5hbEluc3BlY3Rpb25VVUlEID0gdGhpcy5zZWxlY3RlZEZpbmFsSW5zcGVjdGlvbkJ5QXNzZXRDYXRlZ29yeS52YWx1ZTsKICAgICAgICAgIH0gZWxzZSB7CiAgICAgICAgICAgIHRoaXMud29ya09yZGVyRGV0YWlsLndvcmtPcmRlci5wbGFubmluZy5maW5hbEluc3BlY3Rpb25VVUlEID0gdGhpcy5zZWxlY3RlZEZpbmFsSW5zcGVjdGlvbkJ5V29ya09yZGVyLnZhbHVlOwogICAgICAgICAgfQogICAgICAgIH0KICAgICAgfQoKICAgICAgaWYgKHRoaXMuY2hlY2tFeGlzdGluZ0luaXRpYWxJbnNwZWN0aW9uKSB7CiAgICAgICAgdGhpcy53b3JrT3JkZXJEZXRhaWwud29ya09yZGVyLnBsYW5uaW5nLmZyb21FeGlzdGluZ0luaXRpYWwgPSB0cnVlOwogICAgICAgIHRoaXMud29ya09yZGVyRGV0YWlsLndvcmtPcmRlci5wbGFubmluZy5mcm9tSW5zcGVjdGlvbkluaXRpYWwgPSBmYWxzZTsKICAgICAgICB0aGlzLndvcmtPcmRlckRldGFpbC53b3JrT3JkZXIucGxhbm5pbmcuaW5pdGlhbEluc3BlY3Rpb25VVUlEID0gdGhpcy5pbml0aWFsSW5zcGVjdGlvblRlbXAudXVpZDsKICAgICAgfSBlbHNlIHsKICAgICAgICB0aGlzLndvcmtPcmRlckRldGFpbC53b3JrT3JkZXIucGxhbm5pbmcuaW5pdGlhbEluc3BlY3Rpb25VVUlEID0gbnVsbDsKICAgICAgfQoKICAgICAgaWYgKHRoaXMuZmluYWxJbnNwZWN0aW9uU2VsZWN0aW9uID09PSAiU2VsZWN0IEV4aXN0aW5nIikgewogICAgICAgIHRoaXMud29ya09yZGVyRGV0YWlsLndvcmtPcmRlci5wbGFubmluZy5mcm9tRXhpc3RpbmdGaW5hbCA9IHRydWU7CiAgICAgICAgdGhpcy53b3JrT3JkZXJEZXRhaWwud29ya09yZGVyLnBsYW5uaW5nLmZyb21JbnNwZWN0aW9uSW5pdGlhbCA9IGZhbHNlOwogICAgICAgIHRoaXMud29ya09yZGVyRGV0YWlsLndvcmtPcmRlci5wbGFubmluZy5maW5hbEluc3BlY3Rpb25VVUlEID0gdGhpcy5zZWxlY3RlZEZpbmFsSW5zcGVjdGlvbkJ5QXNzZXRDYXRlZ29yeS51dWlkOwogICAgICB9IGVsc2UgewogICAgICAgIHRoaXMud29ya09yZGVyRGV0YWlsLndvcmtPcmRlci5wbGFubmluZy5maW5hbEluc3BlY3Rpb25VVUlEID0gbnVsbDsKICAgICAgfQoKICAgICAgaWYgKHRoaXMuZmluYWxJbnNwZWN0aW9uU2VsZWN0aW9uID09PSAiU2FtZSBBcyBJbml0aWFsIiAmJiB0aGlzLmNoZWNrRXhpc3RpbmdJbml0aWFsSW5zcGVjdGlvbikgewogICAgICAgIHRoaXMud29ya09yZGVyRGV0YWlsLndvcmtPcmRlci5wbGFubmluZy5maW5hbEluc3BlY3Rpb25VVUlEID0gdGhpcy5pbml0aWFsSW5zcGVjdGlvblRlbXAudXVpZDsKICAgICAgICB0aGlzLndvcmtPcmRlckRldGFpbC53b3JrT3JkZXIucGxhbm5pbmcuZnJvbUV4aXN0aW5nRmluYWwgPSB0cnVlOwogICAgICB9CgogICAgICBpZiAodGhpcy53b3JrT3JkZXJEZXRhaWwud29ya09yZGVyLnBsYW5uaW5nLmluaXRpYWxJbnNwZWN0aW9uVVVJRCA9PT0gdGhpcy53b3JrT3JkZXJEZXRhaWwud29ya09yZGVyLnBsYW5uaW5nLmZpbmFsSW5zcGVjdGlvblVVSUQpIHsKICAgICAgICB0aGlzLndvcmtPcmRlckRldGFpbC53b3JrT3JkZXIucGxhbm5pbmcuc2FtZUluc3BlY3Rpb24gPSB0cnVlOwogICAgICB9IGVsc2UgaWYgKHRoaXMud29ya09yZGVyRGV0YWlsLndvcmtPcmRlci5wbGFubmluZy5pbml0aWFsSW5zcGVjdGlvblVVSUQgPT0gbnVsbCB8fCB0aGlzLndvcmtPcmRlckRldGFpbC53b3JrT3JkZXIucGxhbm5pbmcuZmluYWxJbnNwZWN0aW9uVVVJRCA9PSBudWxsKSB7CiAgICAgICAgdGhpcy53b3JrT3JkZXJEZXRhaWwud29ya09yZGVyLnBsYW5uaW5nLnNhbWVJbnNwZWN0aW9uID0gZmFsc2U7CiAgICAgIH0KCiAgICAgIGlmICh0aGlzLndvcmtPcmRlckRldGFpbC53b3JrT3JkZXIuc3RhcnRUaW1lID09PSAiLSIpIHsKICAgICAgICB0aGlzLndvcmtPcmRlckRldGFpbC53b3JrT3JkZXIuc3RhcnRUaW1lID0gbnVsbDsKICAgICAgfQoKICAgICAgaWYgKHRoaXMud29ya09yZGVyRGV0YWlsLndvcmtPcmRlci5lbmRUaW1lID09PSAiLSIpIHsKICAgICAgICB0aGlzLndvcmtPcmRlckRldGFpbC53b3JrT3JkZXIuZW5kVGltZSA9IG51bGw7CiAgICAgIH0KCiAgICAgIGlmICh0aGlzLndvcmtPcmRlckRldGFpbC53b3JrT3JkZXIuZW5kVGltZSA9PT0gIi0iKSB7CiAgICAgICAgdGhpcy53b3JrT3JkZXJEZXRhaWwud29ya09yZGVyLmVuZFRpbWUgPSBudWxsOwogICAgICB9CgogICAgICBmb3IgKGxldCBpc3N1ZSBvZiB0aGlzLndvcmtPcmRlckRldGFpbC53b3JrT3JkZXIuaXNzdWVzKSB7CiAgICAgICAgaXNzdWUub3JkZXJJbnN0cnVjdGlvbnMgPSBKU09OLnN0cmluZ2lmeShpc3N1ZS5vcmRlckluc3RydWN0aW9ucyk7CiAgICAgIH0KCiAgICAgIHRoaXMud29ya09yZGVyRGV0YWlsLndvcmtPcmRlci5zY2hlZHVsZSA9IG1vbWVudCh0aGlzLndvcmtPcmRlckRldGFpbC53b3JrT3JkZXIuc2NoZWR1bGUpLnRvSVNPU3RyaW5nKCk7CiAgICAgIHRoaXMud29ya09yZGVyRGV0YWlsLndvcmtPcmRlci5zdGFydFRpbWUgPSBtb21lbnQodGhpcy53b3JrT3JkZXJEZXRhaWwud29ya09yZGVyLnN0YXJ0VGltZSkudG9JU09TdHJpbmcoKTsKICAgICAgdGhpcy53b3JrT3JkZXJEZXRhaWwud29ya09yZGVyLmVuZFRpbWUgPSBtb21lbnQodGhpcy53b3JrT3JkZXJEZXRhaWwud29ya09yZGVyLmVuZFRpbWUpLnRvSVNPU3RyaW5nKCk7CiAgICAgIGxldCB1cGRhdGVXb3JrT3JkZXJSZXEgPSB7CiAgICAgICAgd29ya09yZGVyOiB0aGlzLndvcmtPcmRlckRldGFpbC53b3JrT3JkZXIsCiAgICAgICAgdXBkYXRlV29ya09yZGVyOiB0cnVlLAogICAgICAgIHRlbXBsYXRlVXBkYXRlOiB0cnVlCiAgICAgIH07CgogICAgICBpZiAodGhpcy5jaGVja0V4aXN0aW5nSW5pdGlhbEluc3BlY3Rpb24gPT09IHRydWUpIHsKICAgICAgICB1cGRhdGVXb3JrT3JkZXJSZXEuaW5pdGlhbEluc3BlY3Rpb25UZW1wbGF0ZSA9IG51bGw7CiAgICAgIH0gZWxzZSB7CiAgICAgICAgdXBkYXRlV29ya09yZGVyUmVxLmluaXRpYWxJbnNwZWN0aW9uVGVtcGxhdGUgPSBpbml0aWFsSW5zcGVjdGlvblRlbXBsYXRlOwogICAgICAgIHRoaXMud29ya09yZGVyRGV0YWlsLndvcmtPcmRlci5wbGFubmluZy5mcm9tRXhpc3RpbmdJbml0aWFsID0gZmFsc2U7CiAgICAgICAgdGhpcy53b3JrT3JkZXJEZXRhaWwud29ya09yZGVyLnBsYW5uaW5nLmZyb21JbnNwZWN0aW9uSW5pdGlhbCA9IGZhbHNlOwogICAgICB9CgogICAgICBpZiAodGhpcy5maW5hbEluc3BlY3Rpb25TZWxlY3Rpb24gPT09ICJDcmVhdGUgTmV3IEluc3BlY3Rpb24gVGVtcGxhdGUiKSB7CiAgICAgICAgdXBkYXRlV29ya09yZGVyUmVxLmZpbmFsSW5zcGVjdGlvblRlbXBsYXRlID0gZmluYWxJbnNwZWN0aW9uVGVtcGxhdGU7CiAgICAgICAgdGhpcy53b3JrT3JkZXJEZXRhaWwud29ya09yZGVyLnBsYW5uaW5nLmZyb21FeGlzdGluZ0ZpbmFsID0gZmFsc2U7CiAgICAgICAgdGhpcy53b3JrT3JkZXJEZXRhaWwud29ya09yZGVyLnBsYW5uaW5nLmZyb21JbnNwZWN0aW9uRmluYWwgPSBmYWxzZTsKICAgICAgICB0aGlzLndvcmtPcmRlckRldGFpbC53b3JrT3JkZXIucGxhbm5pbmcuc2FtZUluc3BlY3Rpb24gPSBmYWxzZTsKICAgICAgfSBlbHNlIGlmICh0aGlzLmZpbmFsSW5zcGVjdGlvblNlbGVjdGlvbiA9PT0gIlNhbWUgQXMgSW5pdGlhbCIgJiYgdGhpcy5jaGVja0V4aXN0aW5nSW5pdGlhbEluc3BlY3Rpb24gIT09IHRydWUpIHsKICAgICAgICB1cGRhdGVXb3JrT3JkZXJSZXEuZmluYWxJbnNwZWN0aW9uVGVtcGxhdGUgPSBpbml0aWFsSW5zcGVjdGlvblRlbXBsYXRlOwogICAgICAgIHRoaXMud29ya09yZGVyRGV0YWlsLndvcmtPcmRlci5wbGFubmluZy5mcm9tRXhpc3RpbmdGaW5hbCA9IHRoaXMud29ya09yZGVyRGV0YWlsLndvcmtPcmRlci5wbGFubmluZy5mcm9tRXhpc3RpbmdJbml0aWFsOwogICAgICAgIHRoaXMud29ya09yZGVyRGV0YWlsLndvcmtPcmRlci5wbGFubmluZy5mcm9tSW5zcGVjdGlvbkZpbmFsID0gdGhpcy53b3JrT3JkZXJEZXRhaWwud29ya09yZGVyLnBsYW5uaW5nLmZyb21JbnNwZWN0aW9uSW5pdGlhbDsKICAgICAgfSBlbHNlIGlmICh0aGlzLmZpbmFsSW5zcGVjdGlvblNlbGVjdGlvbiA9PT0gIlNlbGVjdCBFeGlzdGluZyIpIHsKICAgICAgICB1cGRhdGVXb3JrT3JkZXJSZXEuZmluYWxJbnNwZWN0aW9uVGVtcGxhdGUgPSBudWxsOwogICAgICAgIHRoaXMud29ya09yZGVyRGV0YWlsLndvcmtPcmRlci5wbGFubmluZy5zYW1lSW5zcGVjdGlvbiA9IGZhbHNlOwogICAgICB9IGVsc2UgewogICAgICAgIHVwZGF0ZVdvcmtPcmRlclJlcS5maW5hbEluc3BlY3Rpb25UZW1wbGF0ZSA9IG51bGw7CiAgICAgIH0KCiAgICAgIHVwZGF0ZVdvcmtPcmRlclJlcS5pbml0aWFsSW5zcGVjdGlvbk9wdGlvbiA9IGluaXRpYWxJbnNwZWN0aW9uT3B0aW9uOwogICAgICB1cGRhdGVXb3JrT3JkZXJSZXEuZmluYWxJbnNwZWN0aW9uT3B0aW9uID0gZmluYWxJbnNwZWN0aW9uT3B0aW9uOwogICAgICB1cGRhdGVXb3JrT3JkZXJSZXEuaW5pdGlhbEluc3BlY3Rpb25UZW1wbGF0ZUxpbmtpbmdVVUlEID0gaW5pdGlhbEluc3BlY3Rpb25UZW1wbGF0ZUxpbmtpbmdVVUlEOwogICAgICB1cGRhdGVXb3JrT3JkZXJSZXEuZmluYWxJbnNwZWN0aW9uVGVtcGxhdGVMaW5raW5nVVVJRCA9IGZpbmFsSW5zcGVjdGlvblRlbXBsYXRlTGlua2luZ1VVSUQ7CiAgICAgIHVwZGF0ZVdvcmtPcmRlclJlcS5pbml0aWFsTGlua0luc3BlY3Rpb25UeXBlID0gaW5pdGlhbExpbmtJbnNwZWN0aW9uVHlwZTsKICAgICAgdXBkYXRlV29ya09yZGVyUmVxLmZpbmFsTGlua0luc3BlY3Rpb25UeXBlID0gZmluYWxMaW5rSW5zcGVjdGlvblR5cGU7IC8vcmV0dXJuCgogICAgICBXb3JrT3JkZXJTZXJ2aWNlLnVwZGF0ZVdvcmtPcmRlcih1cGRhdGVXb3JrT3JkZXJSZXEpLnRoZW4ocmVzcG9uc2UgPT4gewogICAgICAgIGlmIChyZXNwb25zZS5zdGF0dXMgPT09IDIwMCkgewogICAgICAgICAgdGhpcy4kcm91dGVyLnB1c2goewogICAgICAgICAgICBuYW1lOiAid29yay1vcmRlciIsCiAgICAgICAgICAgIHBhcmFtczogewogICAgICAgICAgICAgIHRvYXN0RmxhZzogdHJ1ZSwKICAgICAgICAgICAgICBtZXNzYWdlOiAiV29yayBPcmRlciBVcGRhdGVkIFN1Y2Nlc3NmdWxseSIsCiAgICAgICAgICAgICAgdG9hc3RUeXBlOiAic3VjY2VzcyIKICAgICAgICAgICAgfQogICAgICAgICAgfSk7CiAgICAgICAgICB0aGlzLmxvYWRlckZsYWcgPSBmYWxzZTsKICAgICAgICB9CiAgICAgIH0pLmNhdGNoKGVycm9yID0+IHsKICAgICAgICB0aGlzLmxvYWRlckZsYWcgPSBmYWxzZTsKICAgICAgICBjb25zb2xlLmxvZyhlcnJvcik7CiAgICAgIH0pOwogICAgfSwKCiAgICBnZXRQb29sZWRJc3N1ZXMoKSB7CiAgICAgIEluc3BlY3Rpb25TZXJ2aWNlLmZpbHRlcklzc3Vlc0J5QXNzZXRVVUlEKHRoaXMuYXNzZXRJbmZvLmFzc2V0RGV0YWlsLnV1aWQsICJQT09MRUQiKS50aGVuKHJlc3BvbnNlID0+IHsKICAgICAgICBpZiAocmVzcG9uc2Uuc3RhdHVzID09PSAyMDApIHsKICAgICAgICAgIHRoaXMucG9vbGVkSXNzdWVzID0gcmVzcG9uc2UuZGF0YS5pc3N1ZXM7CiAgICAgICAgfQogICAgICB9KS5jYXRjaChlcnJvciA9PiB7CiAgICAgICAgY29uc29sZS5sb2coZXJyb3IpOwogICAgICB9KTsKICAgIH0sCgogICAgZ2V0SXNzdWVzQnlBc3NldFVVSUQoKSB7CiAgICAgIEluc3BlY3Rpb25TZXJ2aWNlLmZpbHRlcklzc3Vlc0J5QXNzZXRVVUlEKHRoaXMuYXNzZXRJbmZvLmFzc2V0RGV0YWlsLnV1aWQsICJyZXBvcnRlZCIpLnRoZW4ocmVzcG9uc2UgPT4gewogICAgICAgIGlmIChyZXNwb25zZS5zdGF0dXMgPT09IDIwMCkgewogICAgICAgICAgdGhpcy5pc3N1ZXNBcnJheUxpc3QgPSByZXNwb25zZS5kYXRhLmlzc3VlczsKICAgICAgICB9CiAgICAgIH0pLmNhdGNoKGVycm9yID0+IHsKICAgICAgICBjb25zb2xlLmxvZyhlcnJvcik7CiAgICAgIH0pOwogICAgfSwKCiAgICBnZXRDdXJyZW5jeSgpIHsKICAgICAgQXNzZXRQZXJzb25uZWxTZXJ2aWNlLmdldENvbXBhbnlDdXJyZW5jeSh0aGlzLmN1cnJlbnRVc2VyRGV0YWlscy5wcm9maWxlLm9yZ2FuaXphdGlvbklkKS50aGVuKHJlc3BvbnNlID0+IHsKICAgICAgICB0aGlzLmN1cnJlbmN5ID0gcmVzcG9uc2UuZGF0YS5jdXJyZW5jeTsKICAgICAgfSk7CiAgICB9LAoKICAgIGdldFdvcmtPcmRlcigpIHsKICAgICAgV29ya09yZGVyU2VydmljZS5nZXRXb3JrT3JkZXJCeVVVSUQodGhpcy4kcm91dGUucGFyYW1zLndvcmt1dWlkKS50aGVuKHJlc3BvbnNlID0+IHsKICAgICAgICBpZiAocmVzcG9uc2Uuc3RhdHVzID09PSAyMDApIHsKICAgICAgICAgIGZvciAobGV0IHdvcmtvcmRlcl9pc3N1ZSBvZiByZXNwb25zZS5kYXRhLndvcmtPcmRlci5pc3N1ZXMpIHsKICAgICAgICAgICAgd29ya29yZGVyX2lzc3VlLm9yZGVySW5zdHJ1Y3Rpb25zID0gSlNPTi5wYXJzZSh3b3Jrb3JkZXJfaXNzdWUub3JkZXJJbnN0cnVjdGlvbnMpOwogICAgICAgICAgfQoKICAgICAgICAgIHRoaXMuaXNzdWVzQXJyYXlMaXN0ID0gcmVzcG9uc2UuZGF0YS53b3JrT3JkZXIuaXNzdWVzOwogICAgICAgICAgdGhpcy5pc3N1ZXNTZWxlY3RlZCA9IHRoaXMuaXNzdWVzQXJyYXlMaXN0OyAvLyBmb3IgKGxldCB4IGluIHRoaXMuaXNzdWVzQXJyYXlMaXN0KSB7CiAgICAgICAgICAvLyAgIHRoaXMuaXNzdWVOdW1iZXIgPSB0aGlzLmlzc3Vlc1NlbGVjdGVkW3hdLmlzc3VlTnVtYmVyOwogICAgICAgICAgLy8gICBjb25zb2xlLmxvZygiaXNzdWVOdW1iZXIiLCB0aGlzLmlzc3VlTnVtYmVyKTsKICAgICAgICAgIC8vIH0KCiAgICAgICAgICB0aGlzLndvcmtPcmRlckRldGFpbCA9IHJlc3BvbnNlLmRhdGE7CiAgICAgICAgICBkb2N1bWVudC50aXRsZSA9IGAke3RoaXMud29ya09yZGVyRGV0YWlsLndvcmtPcmRlci53b3JrT3JkZXJOdW1iZXJ9ICR7dGhpcy4kcm91dGUubWV0YS50aXRsZX1gOwogICAgICAgICAgZG9jdW1lbnQudGl0bGUgPSBgJHt0aGlzLndvcmtPcmRlckRldGFpbC53b3JrT3JkZXIud29ya09yZGVyTnVtYmVyfSAke3RoaXMuJHJvdXRlLm1ldGEudGl0bGV9YDsKCiAgICAgICAgICBpZiAodGhpcy53b3JrT3JkZXJEZXRhaWwud29ya09yZGVyLnN0YXJ0VGltZSA9PT0gbnVsbCkgewogICAgICAgICAgICB0aGlzLndvcmtPcmRlckRldGFpbC53b3JrT3JkZXIuc3RhcnRUaW1lID0gIi0iOwogICAgICAgICAgfSBlbHNlIHsKICAgICAgICAgICAgdGhpcy53b3JrT3JkZXJEZXRhaWwud29ya09yZGVyLnN0YXJ0VGltZSA9IG1vbWVudCh0aGlzLndvcmtPcmRlckRldGFpbC53b3JrT3JkZXIuc3RhcnRUaW1lKS5mb3JtYXQoKTsKICAgICAgICAgIH0KCiAgICAgICAgICBpZiAodGhpcy53b3JrT3JkZXJEZXRhaWwud29ya09yZGVyLmVuZFRpbWUgPT09IG51bGwpIHsKICAgICAgICAgICAgdGhpcy53b3JrT3JkZXJEZXRhaWwud29ya09yZGVyLmVuZFRpbWUgPSAiLSI7CiAgICAgICAgICB9IGVsc2UgewogICAgICAgICAgICB0aGlzLndvcmtPcmRlckRldGFpbC53b3JrT3JkZXIuZW5kVGltZSA9IG1vbWVudCh0aGlzLndvcmtPcmRlckRldGFpbC53b3JrT3JkZXIuZW5kVGltZSkuZm9ybWF0KCk7CiAgICAgICAgICB9CgogICAgICAgICAgaWYgKHRoaXMud29ya09yZGVyRGV0YWlsLndvcmtPcmRlci5lbGFwc2VkVGltZUZvcm1hdHRlZCA9PT0gbnVsbCkgewogICAgICAgICAgICB0aGlzLndvcmtPcmRlckRldGFpbC53b3JrT3JkZXIuZWxhcHNlZFRpbWVGb3JtYXR0ZWQgPSAiLSI7CiAgICAgICAgICB9CgogICAgICAgICAgdGhpcy53b3JrT3JkZXJEZXRhaWwud29ya09yZGVyLnNjaGVkdWxlID0gbW9tZW50KHRoaXMud29ya09yZGVyRGV0YWlsLndvcmtPcmRlci5zY2hlZHVsZSkuZm9ybWF0KCJERCBNTU0gWVlZWSIpOwogICAgICAgICAgdGhpcy5nZXRBc3NldChyZXNwb25zZS5kYXRhLndvcmtPcmRlci5hc3NldFVVSUQpOwogICAgICAgIH0KICAgICAgfSk7CiAgICB9LAoKICAgIGdldEFzc2V0KGFzc2V0VVVJRCkgewogICAgICBBc3NldE1hbmFnZW1lbnRTZXJ2aWNlLmdldEFzc2V0V2l0aERldGFpbHMoYXNzZXRVVUlELCB0cnVlLCB0cnVlKS50aGVuKHJlc3BvbnNlID0+IHsKICAgICAgICBpZiAocmVzcG9uc2Uuc3RhdHVzID09PSAyMDApIHsKICAgICAgICAgIHRoaXMuYXNzZXRJbmZvID0gcmVzcG9uc2UuZGF0YS5hc3NldERldGFpbDsKICAgICAgICAgIHRoaXMuZ2V0UG9vbGVkSXNzdWVzKCk7CgogICAgICAgICAgaWYgKHRoaXMud29ya09yZGVyRGV0YWlsLndvcmtPcmRlci5zdGF0dXMgPT09ICJPcGVuIikgewogICAgICAgICAgICB0aGlzLmdldEluc3BlY3Rpb25UZW1wbGF0ZXMoYXNzZXRVVUlELCB0aGlzLmN1cnJlbnRVc2VyRGV0YWlscy5wcm9maWxlLm9yZ2FuaXphdGlvbklkKTsKICAgICAgICAgICAgdGhpcy5nZXRJbnNwZWN0aW9uVGVtcGxhdGVGcm9tV29ya09yZGVyKHRoaXMuY3VycmVudFVzZXJEZXRhaWxzLnByb2ZpbGUub3JnYW5pemF0aW9uSWQpOwogICAgICAgICAgICB0aGlzLmdldEluc3BlY3Rpb25UZW1hcGxhdGVzQnlBc3NldENhdGVnb3J5KHRoaXMuYXNzZXRJbmZvLmNhdGVnb3J5LnV1aWQpOwogICAgICAgICAgfQoKICAgICAgICAgIHRoaXMubG9hZGVyRmxhZyA9IGZhbHNlOwogICAgICAgIH0KICAgICAgfSkuY2F0Y2goZXJyb3IgPT4gewogICAgICAgIGNvbnNvbGUubG9nKGVycm9yKTsKICAgICAgfSk7CiAgICB9LAoKICAgIGFzc2V0SW5mb0FjY29yZGlvbkZ1bmN0aW9uKCkgewogICAgICBpZiAodGhpcy4kcmVmcy5hc3NldEluZm9BY2NvcmRpb24ub3BlbkZsYWcgPT09IHRydWUpIHsKICAgICAgICBpZiAodGhpcy53b3JrT3JkZXJUeXBlID09PSAiZWRpdCIpIHsKICAgICAgICAgIHRoaXMuJHJlZnMuYXNzaWdubWVudEFjY29yZGlvbi5vcGVuRmxhZyA9IGZhbHNlOwogICAgICAgIH0KCiAgICAgICAgdGhpcy4kcmVmcy50aW1pbmdBY2NvcmRpb24ub3BlbkZsYWcgPSBmYWxzZTsKCiAgICAgICAgaWYgKHRoaXMuJHJlZnMuaW5zcGVjdGlvblJlcG9ydHNBY2NvcmRpb24gIT09IHVuZGVmaW5lZCkgewogICAgICAgICAgdGhpcy4kcmVmcy5pbnNwZWN0aW9uUmVwb3J0c0FjY29yZGlvbi5vcGVuRmxhZyA9IGZhbHNlOwogICAgICAgIH0KCiAgICAgICAgdGhpcy4kcmVmcy5pc3N1ZXNBY2NvcmRpb24ub3BlbkZsYWcgPSBmYWxzZTsKICAgICAgICB0aGlzLiRyZWZzLmlzc3VlUG9vbEFjY29yZGlvbi5vcGVuRmxhZyA9IGZhbHNlOwoKICAgICAgICBpZiAodGhpcy4kcmVmcy5maW5hbEluc3BlY3Rpb25zQWNjb3JkaW9uICE9PSB1bmRlZmluZWQpIHsKICAgICAgICAgIHRoaXMuJHJlZnMuZmluYWxJbnNwZWN0aW9uc0FjY29yZGlvbi5vcGVuRmxhZyA9IGZhbHNlOwogICAgICAgIH0KCiAgICAgICAgaWYgKHRoaXMuJHJlZnMuaW5zcGVjdGlvbnNBY2NvcmRpb24gIT09IHVuZGVmaW5lZCkgewogICAgICAgICAgdGhpcy4kcmVmcy5pbnNwZWN0aW9uc0FjY29yZGlvbi5vcGVuRmxhZyA9IGZhbHNlOwogICAgICAgIH0KICAgICAgfQogICAgfSwKCiAgICBhc3NpZ25tZW50QWNjb3JkaW9uRnVuY3Rpb24oKSB7CiAgICAgIGlmICh0aGlzLiRyZWZzLmFzc2lnbm1lbnRBY2NvcmRpb24ub3BlbkZsYWcgPT09IHRydWUpIHsKICAgICAgICB0aGlzLiRyZWZzLnRpbWluZ0FjY29yZGlvbi5vcGVuRmxhZyA9IGZhbHNlOwoKICAgICAgICBpZiAodGhpcy4kcmVmcy5pbnNwZWN0aW9uUmVwb3J0c0FjY29yZGlvbiAhPT0gdW5kZWZpbmVkKSB7CiAgICAgICAgICB0aGlzLiRyZWZzLmluc3BlY3Rpb25SZXBvcnRzQWNjb3JkaW9uLm9wZW5GbGFnID0gZmFsc2U7CiAgICAgICAgfQoKICAgICAgICB0aGlzLiRyZWZzLmlzc3Vlc0FjY29yZGlvbi5vcGVuRmxhZyA9IGZhbHNlOwogICAgICAgIHRoaXMuJHJlZnMuaXNzdWVQb29sQWNjb3JkaW9uLm9wZW5GbGFnID0gZmFsc2U7CgogICAgICAgIGlmICh0aGlzLiRyZWZzLmZpbmFsSW5zcGVjdGlvbnNBY2NvcmRpb24gIT09IHVuZGVmaW5lZCkgewogICAgICAgICAgdGhpcy4kcmVmcy5maW5hbEluc3BlY3Rpb25zQWNjb3JkaW9uLm9wZW5GbGFnID0gZmFsc2U7CiAgICAgICAgfQoKICAgICAgICBpZiAodGhpcy4kcmVmcy5pbnNwZWN0aW9uc0FjY29yZGlvbiAhPT0gdW5kZWZpbmVkKSB7CiAgICAgICAgICB0aGlzLiRyZWZzLmluc3BlY3Rpb25zQWNjb3JkaW9uLm9wZW5GbGFnID0gZmFsc2U7CiAgICAgICAgfQogICAgICB9CiAgICB9LAoKICAgIHRpbWluZ0FjY29yZGlvbkZ1bmN0aW9uKCkgewogICAgICBpZiAodGhpcy4kcmVmcy50aW1pbmdBY2NvcmRpb24ub3BlbkZsYWcgPT09IHRydWUpIHsKICAgICAgICBpZiAodGhpcy53b3JrT3JkZXJUeXBlID09PSAiZWRpdCIpIHsKICAgICAgICAgIHRoaXMuJHJlZnMuYXNzaWdubWVudEFjY29yZGlvbi5vcGVuRmxhZyA9IGZhbHNlOwogICAgICAgIH0KCiAgICAgICAgdGhpcy4kcmVmcy5hc3NldEluZm9BY2NvcmRpb24ub3BlbkZsYWcgPSBmYWxzZTsKCiAgICAgICAgaWYgKHRoaXMuJHJlZnMuaW5zcGVjdGlvblJlcG9ydHNBY2NvcmRpb24gIT09IHVuZGVmaW5lZCkgewogICAgICAgICAgdGhpcy4kcmVmcy5pbnNwZWN0aW9uUmVwb3J0c0FjY29yZGlvbi5vcGVuRmxhZyA9IGZhbHNlOwogICAgICAgIH0KCiAgICAgICAgdGhpcy4kcmVmcy5pc3N1ZXNBY2NvcmRpb24ub3BlbkZsYWcgPSBmYWxzZTsKICAgICAgICB0aGlzLiRyZWZzLmlzc3VlUG9vbEFjY29yZGlvbi5vcGVuRmxhZyA9IGZhbHNlOwoKICAgICAgICBpZiAodGhpcy4kcmVmcy5maW5hbEluc3BlY3Rpb25zQWNjb3JkaW9uICE9PSB1bmRlZmluZWQpIHsKICAgICAgICAgIHRoaXMuJHJlZnMuZmluYWxJbnNwZWN0aW9uc0FjY29yZGlvbi5vcGVuRmxhZyA9IGZhbHNlOwogICAgICAgIH0KCiAgICAgICAgaWYgKHRoaXMuJHJlZnMuaW5zcGVjdGlvbnNBY2NvcmRpb24gIT09IHVuZGVmaW5lZCkgewogICAgICAgICAgdGhpcy4kcmVmcy5pbnNwZWN0aW9uc0FjY29yZGlvbi5vcGVuRmxhZyA9IGZhbHNlOwogICAgICAgIH0KICAgICAgfQogICAgfSwKCiAgICBpbnNwZWN0aW9uUmVwb3J0c0FjY29yZGlvbkZ1bmN0aW9uKCkgewogICAgICBpZiAodGhpcy4kcmVmcy5pbnNwZWN0aW9uUmVwb3J0c0FjY29yZGlvbi5vcGVuRmxhZyA9PT0gdHJ1ZSkgewogICAgICAgIHRoaXMuJHJlZnMudGltaW5nQWNjb3JkaW9uLm9wZW5GbGFnID0gZmFsc2U7CgogICAgICAgIGlmICh0aGlzLndvcmtPcmRlclR5cGUgPT09ICJlZGl0IikgewogICAgICAgICAgdGhpcy4kcmVmcy5hc3NpZ25tZW50QWNjb3JkaW9uLm9wZW5GbGFnID0gZmFsc2U7CiAgICAgICAgfQoKICAgICAgICB0aGlzLiRyZWZzLmFzc2V0SW5mb0FjY29yZGlvbi5vcGVuRmxhZyA9IGZhbHNlOwogICAgICAgIHRoaXMuJHJlZnMuaXNzdWVzQWNjb3JkaW9uLm9wZW5GbGFnID0gZmFsc2U7CiAgICAgICAgdGhpcy4kcmVmcy5pc3N1ZVBvb2xBY2NvcmRpb24ub3BlbkZsYWcgPSBmYWxzZTsKICAgICAgfQogICAgfSwKCiAgICBpc3N1ZXNBY2NvcmRpb25GdW5jdGlvbigpIHsKICAgICAgaWYgKHRoaXMuJHJlZnMuaXNzdWVzQWNjb3JkaW9uLm9wZW5GbGFnID09PSB0cnVlKSB7CiAgICAgICAgdGhpcy4kcmVmcy50aW1pbmdBY2NvcmRpb24ub3BlbkZsYWcgPSBmYWxzZTsKCiAgICAgICAgaWYgKHRoaXMud29ya09yZGVyVHlwZSA9PT0gImVkaXQiKSB7CiAgICAgICAgICB0aGlzLiRyZWZzLmFzc2lnbm1lbnRBY2NvcmRpb24ub3BlbkZsYWcgPSBmYWxzZTsKICAgICAgICB9CgogICAgICAgIHRoaXMuJHJlZnMuYXNzZXRJbmZvQWNjb3JkaW9uLm9wZW5GbGFnID0gZmFsc2U7CgogICAgICAgIGlmICh0aGlzLiRyZWZzLmluc3BlY3Rpb25SZXBvcnRzQWNjb3JkaW9uICE9PSB1bmRlZmluZWQpIHsKICAgICAgICAgIHRoaXMuJHJlZnMuaW5zcGVjdGlvblJlcG9ydHNBY2NvcmRpb24ub3BlbkZsYWcgPSBmYWxzZTsKICAgICAgICB9CgogICAgICAgIHRoaXMuJHJlZnMuaXNzdWVQb29sQWNjb3JkaW9uLm9wZW5GbGFnID0gZmFsc2U7CgogICAgICAgIGlmICh0aGlzLiRyZWZzLmZpbmFsSW5zcGVjdGlvbnNBY2NvcmRpb24gIT09IHVuZGVmaW5lZCkgewogICAgICAgICAgdGhpcy4kcmVmcy5maW5hbEluc3BlY3Rpb25zQWNjb3JkaW9uLm9wZW5GbGFnID0gZmFsc2U7CiAgICAgICAgfQoKICAgICAgICBpZiAodGhpcy4kcmVmcy5pbnNwZWN0aW9uc0FjY29yZGlvbiAhPT0gdW5kZWZpbmVkKSB7CiAgICAgICAgICB0aGlzLiRyZWZzLmluc3BlY3Rpb25zQWNjb3JkaW9uLm9wZW5GbGFnID0gZmFsc2U7CiAgICAgICAgfQogICAgICB9CiAgICB9LAoKICAgIGluc3BlY3Rpb25zQWNjb3JkaW9uRnVuY3Rpb24oKSB7CiAgICAgIGlmICh0aGlzLiRyZWZzLmluc3BlY3Rpb25zQWNjb3JkaW9uLm9wZW5GbGFnID09PSB0cnVlKSB7CiAgICAgICAgdGhpcy4kcmVmcy50aW1pbmdBY2NvcmRpb24ub3BlbkZsYWcgPSBmYWxzZTsKCiAgICAgICAgaWYgKHRoaXMud29ya09yZGVyVHlwZSA9PT0gImVkaXQiKSB7CiAgICAgICAgICB0aGlzLiRyZWZzLmFzc2lnbm1lbnRBY2NvcmRpb24ub3BlbkZsYWcgPSBmYWxzZTsKICAgICAgICB9CgogICAgICAgIHRoaXMuJHJlZnMuYXNzZXRJbmZvQWNjb3JkaW9uLm9wZW5GbGFnID0gZmFsc2U7CiAgICAgICAgdGhpcy4kcmVmcy5pc3N1ZVBvb2xBY2NvcmRpb24ub3BlbkZsYWcgPSBmYWxzZTsKICAgICAgICB0aGlzLiRyZWZzLmZpbmFsSW5zcGVjdGlvbnNBY2NvcmRpb24ub3BlbkZsYWcgPSBmYWxzZTsKICAgICAgfQogICAgfSwKCiAgICBmaW5hbEluc3BlY3Rpb25zQWNjb3JkaW9uRnVuY3Rpb24oKSB7CiAgICAgIGlmICh0aGlzLiRyZWZzLmZpbmFsSW5zcGVjdGlvbnNBY2NvcmRpb24ub3BlbkZsYWcgPT09IHRydWUpIHsKICAgICAgICB0aGlzLiRyZWZzLnRpbWluZ0FjY29yZGlvbi5vcGVuRmxhZyA9IGZhbHNlOwoKICAgICAgICBpZiAodGhpcy53b3JrT3JkZXJUeXBlID09PSAiZWRpdCIpIHsKICAgICAgICAgIHRoaXMuJHJlZnMuYXNzaWdubWVudEFjY29yZGlvbi5vcGVuRmxhZyA9IGZhbHNlOwogICAgICAgIH0KCiAgICAgICAgdGhpcy4kcmVmcy5hc3NldEluZm9BY2NvcmRpb24ub3BlbkZsYWcgPSBmYWxzZTsKICAgICAgICB0aGlzLiRyZWZzLmlzc3VlUG9vbEFjY29yZGlvbi5vcGVuRmxhZyA9IGZhbHNlOwogICAgICAgIHRoaXMuJHJlZnMuaW5zcGVjdGlvbnNBY2NvcmRpb24ub3BlbkZsYWcgPSBmYWxzZTsKICAgICAgfQogICAgfSwKCiAgICBpc3N1ZUFjY29yZGlvbkZ1bmN0aW9uKGluZHgpIHsKICAgICAgZm9yIChsZXQgaW5kZXggPSAwOyBpbmRleCA8IHRoaXMuJHJlZnMuaXNzdWVBY2NvcmRpb24ubGVuZ3RoOyBpbmRleCsrKSB7CiAgICAgICAgLy8gdGhpcy5sb2FkZXJGbGFnID0gdHJ1ZQogICAgICAgIGlmIChpbmRleCAhPT0gaW5keCkgewogICAgICAgICAgdGhpcy4kcmVmcy5pc3N1ZUFjY29yZGlvbltpbmRleF0ub3BlbkZsYWcgPSBmYWxzZTsKICAgICAgICB9CiAgICAgIH0KICAgIH0sCgogICAgbG9hZGVyRmFsc2UoKSB7CiAgICAgIHRoaXMubG9hZGVyRmxhZyA9IGZhbHNlOwogICAgfSwKCiAgICBpc3N1ZVBvb2xBY2NvcmRpb25GdW5jdGlvbigpIHsKICAgICAgaWYgKHRoaXMuJHJlZnMuaXNzdWVQb29sQWNjb3JkaW9uLm9wZW5GbGFnID09PSB0cnVlKSB7CiAgICAgICAgdGhpcy4kcmVmcy50aW1pbmdBY2NvcmRpb24ub3BlbkZsYWcgPSBmYWxzZTsKCiAgICAgICAgaWYgKHRoaXMud29ya09yZGVyVHlwZSA9PT0gImVkaXQiKSB7CiAgICAgICAgICB0aGlzLiRyZWZzLmFzc2lnbm1lbnRBY2NvcmRpb24ub3BlbkZsYWcgPSBmYWxzZTsKICAgICAgICB9CgogICAgICAgIHRoaXMuJHJlZnMuYXNzZXRJbmZvQWNjb3JkaW9uLm9wZW5GbGFnID0gZmFsc2U7CgogICAgICAgIGlmICh0aGlzLiRyZWZzLmluc3BlY3Rpb25SZXBvcnRzQWNjb3JkaW9uICE9PSB1bmRlZmluZWQpIHsKICAgICAgICAgIHRoaXMuJHJlZnMuaW5zcGVjdGlvblJlcG9ydHNBY2NvcmRpb24ub3BlbkZsYWcgPSBmYWxzZTsKICAgICAgICB9CgogICAgICAgIGlmICh0aGlzLiRyZWZzLmZpbmFsSW5zcGVjdGlvbnNBY2NvcmRpb24gIT09IHVuZGVmaW5lZCkgewogICAgICAgICAgdGhpcy4kcmVmcy5maW5hbEluc3BlY3Rpb25zQWNjb3JkaW9uLm9wZW5GbGFnID0gZmFsc2U7CiAgICAgICAgfQoKICAgICAgICBpZiAodGhpcy4kcmVmcy5pbnNwZWN0aW9uc0FjY29yZGlvbiAhPT0gdW5kZWZpbmVkKSB7CiAgICAgICAgICB0aGlzLiRyZWZzLmluc3BlY3Rpb25zQWNjb3JkaW9uLm9wZW5GbGFnID0gZmFsc2U7CiAgICAgICAgfQogICAgICB9CiAgICB9LAoKICAgIHNldFNpZGViYXJQb3MoKSB7CiAgICAgIGxldCBzaWRlQmFyQ29udGFpbmVyID0gZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoInNpZGViYXItY29udGFpbmVyIik7CiAgICAgIGxldCBzaWRlYmFyID0gZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoInNpZGViYXIiKTsKICAgICAgc2lkZWJhci5zdHlsZS53aWR0aCA9IHNpZGVCYXJDb250YWluZXIub2Zmc2V0V2lkdGggKyAicHgiOwogICAgICBzaWRlYmFyLnN0eWxlLnBvc2l0aW9uID0gImZpeGVkIjsKICAgICAgc2lkZWJhci5zdHlsZS5sZWZ0ID0gc2lkZUJhckNvbnRhaW5lci5vZmZzZXRMZWZ0OwogICAgfSwKCiAgICBjbGVhclNlbGVjdGVkQW5zd2VyKGluZGV4KSB7CiAgICAgIHRoaXMucXVlc3Rpb25UeXBlRm9ybUluaXRpYWxbaW5kZXhdLnR5cGVMYWJlbCA9ICIiOwogICAgICB0aGlzLmluaXRpYWxBc3NldEluZGV4Kys7CiAgICB9LAoKICAgIGNsZWFyU2VsZWN0ZWRGaW5hbEluc3BlY3Rpb25CeUFzc2V0KCkgewogICAgICB0aGlzLmZpbmFsSW5zcGVjdGlvbkJ5QXNzZXRDYXRlZ29yeSA9ICIiOwogICAgICB0aGlzLmZpbmFsSW5zcGVjdGlvblJlc2V0Kys7CiAgICB9LAoKICAgIGluc3BlY3Rpb25UZW1wbGF0ZVZhbGlkYXRpb24oKSB7CiAgICAgIGxldCB2YWxkaWF0aW9ucyA9IHt9OwoKICAgICAgaWYgKHRoaXMud29ya09yZGVyRGV0YWlsLndvcmtPcmRlci5zdGF0dXMgPT0gIk9wZW4iKSB7CiAgICAgICAgaWYgKHRoaXMuZmluYWxJbnNwZWN0aW9uU2VsZWN0aW9uID09ICJDcmVhdGUgTmV3IEluc3BlY3Rpb24gVGVtcGxhdGUiICYmICF0aGlzLmNoZWNrRXhpc3RpbmdJbml0aWFsSW5zcGVjdGlvbikgewogICAgICAgICAgdmFsZGlhdGlvbnMgPSB7CiAgICAgICAgICAgIHdvcmtPcmRlclN1bW1hcnk6IHsKICAgICAgICAgICAgICBpbml0aWFsSW5zcGVjdGlvblRpdGxlOiB7CiAgICAgICAgICAgICAgICByZXF1aXJlZCwKICAgICAgICAgICAgICAgIG1heExlbmd0aDogbWF4TGVuZ3RoKDE5MCkKICAgICAgICAgICAgICB9LAogICAgICAgICAgICAgIGZpbmFsSW5zcGVjdGlvblRpdGxlOiB7CiAgICAgICAgICAgICAgICByZXF1aXJlZCwKICAgICAgICAgICAgICAgIG1heExlbmd0aDogbWF4TGVuZ3RoKDE5MCkKICAgICAgICAgICAgICB9CiAgICAgICAgICAgIH0KICAgICAgICAgIH07CiAgICAgICAgfQogICAgICB9CgogICAgICByZXR1cm4gdmFsZGlhdGlvbnM7CiAgICB9LAoKICAgIGluaXRpYWxJbnNwZWN0aW9uVmFsaWRhdGlvbigpIHsKICAgICAgbGV0IHZhbGlkYXRpb25zID0ge307CgogICAgICBpZiAodGhpcy53b3JrT3JkZXJEZXRhaWwud29ya09yZGVyLnN0YXR1cyA9PSAiT3BlbiIpIHsKICAgICAgICBpZiAodGhpcy5jaGVja0V4aXN0aW5nSW5pdGlhbEluc3BlY3Rpb24pIHsKICAgICAgICAgIHZhbGlkYXRpb25zID0gewogICAgICAgICAgICBpbml0aWFsSW5zcGVjdGlvbkJ5QXNzZXRDYXRlZ29yeTogewogICAgICAgICAgICAgIHJlcXVpcmVkCiAgICAgICAgICAgIH0sCiAgICAgICAgICAgIHF1ZXN0aW9uVHlwZUZvcm1Jbml0aWFsOiB7CiAgICAgICAgICAgICAgJGVhY2g6IHsKICAgICAgICAgICAgICAgIG5hbWU6IHt9LAogICAgICAgICAgICAgICAgcXVlc3Rpb246IHt9LAogICAgICAgICAgICAgICAgdHlwZUxhYmVsOiB7fQogICAgICAgICAgICAgIH0KICAgICAgICAgICAgfQogICAgICAgICAgfTsKICAgICAgICB9IGVsc2UgewogICAgICAgICAgdmFsaWRhdGlvbnMgPSB7CiAgICAgICAgICAgIGluaXRpYWxJbnNwZWN0aW9uQnlBc3NldENhdGVnb3J5OiB7fSwKICAgICAgICAgICAgcXVlc3Rpb25UeXBlRm9ybUluaXRpYWw6IHsKICAgICAgICAgICAgICAkZWFjaDogewogICAgICAgICAgICAgICAgbmFtZTogewogICAgICAgICAgICAgICAgICByZXF1aXJlZCwKICAgICAgICAgICAgICAgICAgbWF4TGVuZ3RoOiBtYXhMZW5ndGgoMTkwKQogICAgICAgICAgICAgICAgfSwKICAgICAgICAgICAgICAgIHF1ZXN0aW9uOiB7CiAgICAgICAgICAgICAgICAgIHJlcXVpcmVkLAogICAgICAgICAgICAgICAgICBtYXhMZW5ndGg6IG1heExlbmd0aCgxOTApCiAgICAgICAgICAgICAgICB9LAogICAgICAgICAgICAgICAgdHlwZUxhYmVsOiB7CiAgICAgICAgICAgICAgICAgIHJlcXVpcmVkCiAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgfQogICAgICAgICAgICB9CiAgICAgICAgICB9OwogICAgICAgIH0KICAgICAgfSBlbHNlIHsKICAgICAgICB2YWxpZGF0aW9ucyA9IHsKICAgICAgICAgIGluaXRpYWxJbnNwZWN0aW9uQnlBc3NldENhdGVnb3J5OiB7fSwKICAgICAgICAgIHF1ZXN0aW9uVHlwZUZvcm1Jbml0aWFsOiB7CiAgICAgICAgICAgICRlYWNoOiB7CiAgICAgICAgICAgICAgbmFtZToge30sCiAgICAgICAgICAgICAgcXVlc3Rpb246IHt9LAogICAgICAgICAgICAgIHR5cGVMYWJlbDoge30KICAgICAgICAgICAgfQogICAgICAgICAgfQogICAgICAgIH07CiAgICAgIH0KCiAgICAgIHJldHVybiB2YWxpZGF0aW9uczsKICAgIH0sCgogICAgZmluYWxJbnNwZWN0aW9uVmFsaWRhdGlvbigpIHsKICAgICAgbGV0IHZhbGRpYXRpb25zID0ge307CgogICAgICBpZiAodGhpcy53b3JrT3JkZXJEZXRhaWwud29ya09yZGVyLnN0YXR1cyA9PSAiT3BlbiIpIHsKICAgICAgICBpZiAodGhpcy5maW5hbEluc3BlY3Rpb25TZWxlY3Rpb24gPT0gIkNyZWF0ZSBOZXcgSW5zcGVjdGlvbiBUZW1wbGF0ZSIpIHsKICAgICAgICAgIHZhbGRpYXRpb25zID0gewogICAgICAgICAgICBxdWVzdGlvblR5cGVGb3JtRmluYWw6IHsKICAgICAgICAgICAgICAkZWFjaDogewogICAgICAgICAgICAgICAgbmFtZTogewogICAgICAgICAgICAgICAgICByZXF1aXJlZCwKICAgICAgICAgICAgICAgICAgbWF4TGVuZ3RoOiBtYXhMZW5ndGgoMTkwKQogICAgICAgICAgICAgICAgfSwKICAgICAgICAgICAgICAgIHF1ZXN0aW9uOiB7CiAgICAgICAgICAgICAgICAgIHJlcXVpcmVkLAogICAgICAgICAgICAgICAgICBtYXhMZW5ndGg6IG1heExlbmd0aCgxOTApCiAgICAgICAgICAgICAgICB9LAogICAgICAgICAgICAgICAgdHlwZUxhYmVsOiB7CiAgICAgICAgICAgICAgICAgIHJlcXVpcmVkCiAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgfQogICAgICAgICAgICB9CiAgICAgICAgICB9OwogICAgICAgIH0gZWxzZSB7CiAgICAgICAgICB2YWxkaWF0aW9ucyA9IHsKICAgICAgICAgICAgcXVlc3Rpb25UeXBlRm9ybUZpbmFsOiB7CiAgICAgICAgICAgICAgJGVhY2g6IHsKICAgICAgICAgICAgICAgIG5hbWU6IHt9LAogICAgICAgICAgICAgICAgcXVlc3Rpb246IHt9LAogICAgICAgICAgICAgICAgdHlwZUxhYmVsOiB7fQogICAgICAgICAgICAgIH0KICAgICAgICAgICAgfQogICAgICAgICAgfTsKICAgICAgICB9CgogICAgICAgIGlmICh0aGlzLmZpbmFsSW5zcGVjdGlvblNlbGVjdGlvbiA9PT0gIlNlbGVjdCBFeGlzdGluZyIpIHsKICAgICAgICAgIHZhbGRpYXRpb25zLmZpbmFsSW5zcGVjdGlvbkJ5QXNzZXRDYXRlZ29yeSA9IHsKICAgICAgICAgICAgcmVxdWlyZWQKICAgICAgICAgIH07CiAgICAgICAgfSBlbHNlIHsKICAgICAgICAgIHZhbGRpYXRpb25zLmZpbmFsSW5zcGVjdGlvbkJ5QXNzZXRDYXRlZ29yeSA9IHt9OwogICAgICAgIH0KICAgICAgfSBlbHNlIHsKICAgICAgICB2YWxkaWF0aW9ucyA9IHsKICAgICAgICAgIGZpbmFsSW5zcGVjdGlvbkJ5QXNzZXRDYXRlZ29yeToge30sCiAgICAgICAgICBxdWVzdGlvblR5cGVGb3JtRmluYWw6IHsKICAgICAgICAgICAgJGVhY2g6IHsKICAgICAgICAgICAgICBuYW1lOiB7fSwKICAgICAgICAgICAgICBxdWVzdGlvbjoge30sCiAgICAgICAgICAgICAgdHlwZUxhYmVsOiB7fQogICAgICAgICAgICB9CiAgICAgICAgICB9CiAgICAgICAgfTsKICAgICAgfQoKICAgICAgcmV0dXJuIHZhbGRpYXRpb25zOwogICAgfSwKCiAgICBzaG93VG9hc3QobWVzc2FnZSwgdHlwZSkgewogICAgICB0aGlzLnRvYXN0TWVzc2FnZSA9IG1lc3NhZ2U7CiAgICAgIHRoaXMudG9hc3RUeXBlID0gdHlwZTsKICAgICAgdGhpcy50b2FzdEZsYWcrKzsKICAgIH0KCiAgfSwKCiAgdXBkYXRlZCgpIHsKICAgIHRoaXMuc2V0U2lkZWJhclBvcygpOwogIH0sCgogIHZhbGlkYXRpb25zOiBmdW5jdGlvbiAoKSB7CiAgICByZXR1cm4gewogICAgICBpc3N1ZXNTZWxlY3RlZDogewogICAgICAgIHJlcXVpcmVkCiAgICAgIH0sCiAgICAgIC4uLnRoaXMuaW5pdGlhbEluc3BlY3Rpb25WYWxpZGF0aW9uKCksCiAgICAgIC4uLnRoaXMuZmluYWxJbnNwZWN0aW9uVmFsaWRhdGlvbigpCiAgICB9OwogIH0sCgogIGNyZWF0ZWQoKSB7CiAgICB0aGlzLmN1cnJlbnRVc2VyRGV0YWlscyA9IEpTT04ucGFyc2UobG9jYWxTdG9yYWdlLmdldEl0ZW0oImN1cnJlbnRVc2VyRGV0YWlscyIpKTsKICAgIHRoaXMud29ya09yZGVyVHlwZSA9IHRoaXMuJHJvdXRlLnBhcmFtcy50eXBlOwoKICAgIGlmICh0aGlzLiRyb3V0ZS5uYW1lID09PSAid29yay1vcmRlci1kZXRhaWxzIikgewogICAgICB0aGlzLmRpc2FibGVGaWVsZHMgPSB0cnVlOwogICAgfQoKICAgIHRoaXMuZ2V0Q3VycmVuY3koKTsKICAgIHRoaXMubG9hZGVyRmxhZyA9IHRydWU7CiAgICB0aGlzLndvcmtPcmRlclVVSUQgPSB0aGlzLiRyb3V0ZS5wYXJhbXMud29ya3V1aWQ7CiAgICB0aGlzLmdldFdvcmtPcmRlcigpOwogIH0KCn07"},null]}