{"remainingRequest":"/home/alsharqi/Desktop/Deploy Fe-ui/fe-erohal-ui/node_modules/babel-loader/lib/index.js!/home/alsharqi/Desktop/Deploy Fe-ui/fe-erohal-ui/node_modules/cache-loader/dist/cjs.js??ref--1-0!/home/alsharqi/Desktop/Deploy Fe-ui/fe-erohal-ui/node_modules/vue-loader/lib/index.js??vue-loader-options!/home/alsharqi/Desktop/Deploy Fe-ui/fe-erohal-ui/src/views/service-requests/ServiceRequestDetails.vue?vue&type=script&lang=js&","dependencies":[{"path":"/home/alsharqi/Desktop/Deploy Fe-ui/fe-erohal-ui/src/views/service-requests/ServiceRequestDetails.vue","mtime":1661968702444},{"path":"/home/alsharqi/Desktop/Deploy Fe-ui/fe-erohal-ui/babel.config.js","mtime":1661968702388},{"path":"/home/alsharqi/Desktop/Deploy Fe-ui/fe-erohal-ui/node_modules/cache-loader/dist/cjs.js","mtime":499162500000},{"path":"/home/alsharqi/Desktop/Deploy Fe-ui/fe-erohal-ui/node_modules/babel-loader/lib/index.js","mtime":315532800000},{"path":"/home/alsharqi/Desktop/Deploy Fe-ui/fe-erohal-ui/node_modules/cache-loader/dist/cjs.js","mtime":499162500000},{"path":"/home/alsharqi/Desktop/Deploy Fe-ui/fe-erohal-ui/node_modules/vue-loader/lib/index.js","mtime":1655715099000}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:aW1wb3J0IHsgQXNzZXRNYW5hZ2VtZW50U2VydmljZSB9IGZyb20gIi4uLy4uL3NlcnZpY2VzL0Fzc2V0TWFuYWdlbWVudFNlcnZpY2UiOwppbXBvcnQgeyBBc3NldFBlcnNvbm5lbFNlcnZpY2UgfSBmcm9tICIuLi8uLi9zZXJ2aWNlcy9Bc3NldFBlcnNvbm5lbFNlcnZpY2UiOwppbXBvcnQgSW5zcGVjdGlvblNlcnZpY2UgZnJvbSAiLi4vLi4vc2VydmljZXMvSW5zcGVjdGlvblNlcnZpY2UiOwppbXBvcnQgU2lkZWJhciBmcm9tICIuLi9zZXJ2aWNlLXJlcXVlc3RzL2NvbXBvbmVudHMvU2lkZWJhciI7CmltcG9ydCBTZXJ2aWNlUmVxdWVzdFN1bW1hcnkgZnJvbSAiLi4vc2VydmljZS1yZXF1ZXN0cy9jb21wb25lbnRzL1NlcnZpY2VSZXF1ZXN0U3VtbWFyeSI7CmltcG9ydCBSZXF1ZXN0SW5zcGVjdGlvbiBmcm9tICIuLi8uLi92aWV3cy9pbnNwZWN0aW9uL2NvbXBvbmVudHMvUmVxdWVzdEluc3BlY3Rpb24udnVlIjsKaW1wb3J0IElzc3VlIGZyb20gIi4vY29tcG9uZW50cy9Jc3N1ZS52dWUiOwppbXBvcnQgSWdub3JlUmVxdWVzdCBmcm9tICIuLi8uLi9jb21wb25lbnRzL0lnbm9yZVJlcXVlc3QiOwppbXBvcnQgQ3JlYXRlSXNzdWUgZnJvbSAiLi4vLi4vY29tcG9uZW50cy9DcmVhdGVJc3N1ZSI7CmltcG9ydCBtb21lbnQgZnJvbSAibW9tZW50IjsKaW1wb3J0IGxvYWRlciBmcm9tICJAL2NvbXBvbmVudHMvTG9hZGVyLnZ1ZSI7CmV4cG9ydCBkZWZhdWx0IHsKICBuYW1lOiAibmFtZSIsCiAgY29tcG9uZW50czogewogICAgU2lkZWJhciwKICAgIElnbm9yZVJlcXVlc3QsCiAgICBDcmVhdGVJc3N1ZSwKICAgIFNlcnZpY2VSZXF1ZXN0U3VtbWFyeSwKICAgIFJlcXVlc3RJbnNwZWN0aW9uLAogICAgSXNzdWUsCiAgICBsb2FkZXIKICB9LAoKICBkYXRhKCkgewogICAgcmV0dXJuIHsKICAgICAgdG9hc3RGbGFnOiAwLAogICAgICB0b2FzdE1lc3NhZ2U6ICIiLAogICAgICB0b2FzdFR5cGU6ICIiLAogICAgICBsb2FkZXJGbGFnOiBmYWxzZSwKICAgICAgY3VycmVuY3k6ICJBRUQiLAogICAgICBpbmRleFZhbHVlOiAwLAogICAgICBwb3B1cEltYWdlOiAiIiwKICAgICAgZGlzYWJsZUZpZWxkczogIiIsCiAgICAgIGltYWdlRGlhbG9nOiBmYWxzZSwKICAgICAgaW5zcGVjdGlvblJlcXVlc3Q6IGZhbHNlLAogICAgICBhc3NldDoge30sCiAgICAgIGZpbGVSZWNvcmQ6IG51bGwsCiAgICAgIGF0dGFjaG1lbnRzOiBbXSwKICAgICAgY3VycmVudFBhZ2U6IDEsCiAgICAgIG51bWJlck9mUGFnZXM6ICIiLAogICAgICBkYXRhUGVuZGluZzogW10sCiAgICAgIGFzc2V0VVVJRDogIiIsCiAgICAgIGlzc3VlVVVJRDogIiIsCiAgICAgIGFkZGl0aW9uYWxJbnNwZWN0aW9uOiBbXSwKICAgICAgY3VycmVudFVzZXJEZXRhaWxzOiAiIiwKICAgICAgc3VibWl0TmV3SXNzdWU6IGZhbHNlLAogICAgICBJZ25vcmVJc3N1ZVZhbHVlOiBmYWxzZSwKICAgICAgbW9kZWxJbnN0cnVjdGlvbjogIklnbm9yZSBTZXJ2aWNlIFJlcXVlc3QiLAogICAgICBzZXJ2aWNlUmVxdWVzdE9iajoge30sCiAgICAgIGlzc3VlT3B0aW9uczogW10sCiAgICAgIHNySXNzdWVzOiBbXSwKICAgICAgcGFyZW50U2VydmljZVJlcXVlc3RVVUlEOiAiIiwKICAgICAgc2VydmljZVJlcXVlc3Q6IHt9LAogICAgICBzdWJtaXR0ZWRJbnBlY3Rpb246ICIiLAogICAgICBtb2RlbDogIiIsCiAgICAgIHR5cGU6ICJBZC1ob2MiLAogICAgICB0ZW1wbGF0ZU5hbWU6ICIiLAogICAgICBTZWxlY3RlZEl0ZW1zOiB7fSwKICAgICAgZmlsZVVwbG9hZDogW10sCiAgICAgIHNvdXJjZTogW3sKICAgICAgICBuYW1lOiAiQ3JlYXRlIElzc3VlIiwKICAgICAgICB2YWx1ZTogIkNyZWF0ZSBJc3N1ZSIKICAgICAgfSwgewogICAgICAgIG5hbWU6ICJJZ25vcmUgUmVxdWVzdCIsCiAgICAgICAgdmFsdWU6ICJJZ25vcmUgUmVxdWVzdCIKICAgICAgfV0sCiAgICAgIGluZm86IHsKICAgICAgICBhc3NldE5hbWU6ICJnbGFzcyIsCiAgICAgICAgbW9kZWxOdW1iZXI6ICIyMzFhczMiLAogICAgICAgIG1hbnVmYWN0dXJlcjogIlNvbWUgQ29tcGFueSIKICAgICAgfSwKICAgICAgYXNzZXRJZDogIiIKICAgIH07CiAgfSwKCiAgbWV0aG9kczogewogICAgZGlzcGxheU1lc3NhZ2UoKSB7CiAgICAgIHRoaXMubG9hZGVyRmxhZyA9IHRydWU7CiAgICAgIHRoaXMuZ2V0U2VydmljZVJlcXVlc3RCeVVVSUQoKTsKICAgICAgdGhpcy5zaG93VG9hc3QoIklzc3VlIENyZWF0ZWQgU3VjY2Vzc2Z1bGx5LiIsICJzdWNjZXNzIik7CiAgICB9LAoKICAgIGNyZWF0ZUFkZGl0b25hbEluc3BlY3Rpb24odmFsdWUpIHsKICAgICAgbGV0IGN1cnJlbnRVc2VyRGV0YWlscyA9IEpTT04ucGFyc2UobG9jYWxTdG9yYWdlLmdldEl0ZW0oImN1cnJlbnRVc2VyRGV0YWlscyIpKTsKCiAgICAgIGlmICh2YWx1ZS5hc3NpZ25lZFRvID09PSAiVXNlcnMiKSB7CiAgICAgICAgdGhpcy4kdi5hc3NpZ25lZFVzZXIuJHRvdWNoKCk7CgogICAgICAgIGlmICh0aGlzLiR2LmFzc2lnbmVkVXNlci4kZXJyb3IpIHsKICAgICAgICAgIHRoaXMuc2hvd1RvYXN0KCJQbGVhc2UgU2VsZWN0IFVzZXJzLiIsICJlcnJvciIpOwogICAgICAgICAgcmV0dXJuOwogICAgICAgIH0KICAgICAgfQoKICAgICAgaWYgKHZhbHVlLnNlbGVjdGVkVGVtcGxhdGUgPT09ICIiKSB7CiAgICAgICAgdGhpcy5zaG93VG9hc3QoIlBsZWFzZSBTZWxlY3QgVGVtcGxhdGUuIiwgImVycm9yIik7CiAgICAgICAgcmV0dXJuOwogICAgICB9CgogICAgICBsZXQgYWRkSW5zcGVjdGlvblRlbXBsYXRlUmVxdWVzdCA9IHt9OwogICAgICBsZXQgaW5zcGVjdGlvblRlbXBsYXRlID0ge307CiAgICAgIGxldCBpbnNwZWN0aW9uSXRlbUNhdGVnb3JpZXMgPSBbXTsKICAgICAgaW5zcGVjdGlvblRlbXBsYXRlLm5hbWUgPSB2YWx1ZS5uYW1lOwogICAgICBpbnNwZWN0aW9uVGVtcGxhdGUuZGVhZExpbmVEYXRlID0gbW9tZW50KHZhbHVlLmRlYWRsaW5lKS50b0lTT1N0cmluZygpOwogICAgICBpbnNwZWN0aW9uVGVtcGxhdGUuZGVhZExpbmVUaW1lID0gdmFsdWUuYWRob2NUaW1lOwogICAgICBpbnNwZWN0aW9uVGVtcGxhdGUuZGVzY3JpcHRpb24gPSBudWxsOwogICAgICBpbnNwZWN0aW9uVGVtcGxhdGUudHlwZSA9IHRoaXMudHlwZSArICIgSW5zcGVjdGlvbiBSZXBvcnQiOwoKICAgICAgaWYgKHZhbHVlLmFzc2lnbmVkVXNlciA9PT0gIiIpIHsKICAgICAgICBpbnNwZWN0aW9uVGVtcGxhdGUuY3JlYXRlZEZvclVzZXJVVUlEID0gbnVsbDsKICAgICAgfSBlbHNlIHsKICAgICAgICBpbnNwZWN0aW9uVGVtcGxhdGUuY3JlYXRlZEZvclVzZXJVVUlEID0gdmFsdWUuYXNzaWduZWRVc2VyOwogICAgICB9CgogICAgICBpZiAodmFsdWUuYXNzaWduZWRVc2VyR3JvdXAgPT09ICIiKSB7CiAgICAgICAgaW5zcGVjdGlvblRlbXBsYXRlLmNyZWF0ZWRGb3JVc2VyR3JvdXBVVUlEID0gbnVsbDsKICAgICAgfSBlbHNlIHsKICAgICAgICBpbnNwZWN0aW9uVGVtcGxhdGUuY3JlYXRlZEZvclVzZXJHcm91cFVVSUQgPSB2YWx1ZS5hc3NpZ25lZFVzZXJHcm91cDsKICAgICAgfQoKICAgICAgaW5zcGVjdGlvblRlbXBsYXRlLm5ld0FkZGl0aW9uYWwgPSB0cnVlOwogICAgICBpbnNwZWN0aW9uVGVtcGxhdGUuc2VydmljZVJlcXVlc3RVVUlEID0gdmFsdWUuc2VydmljZVJlcXVlc3RVVUlEOwogICAgICBpbnNwZWN0aW9uVGVtcGxhdGUucGFyZW50SW5zcGVjdGlvblVVSUQgPSBudWxsOwogICAgICBpbnNwZWN0aW9uVGVtcGxhdGUuY29tcGFueVVVSUQgPSBjdXJyZW50VXNlckRldGFpbHMucHJvZmlsZS5vcmdhbml6YXRpb25JZDsKICAgICAgaW5zcGVjdGlvblRlbXBsYXRlLmFzc2V0Q2F0ZWdvcnlVVUlEID0gdGhpcy5hc3NldC5jYXRlZ29yeVVVSUQ7CiAgICAgIGluc3BlY3Rpb25UZW1wbGF0ZS5hc3NldFVVSUQgPSB0aGlzLmFzc2V0LnV1aWQ7CiAgICAgIGluc3BlY3Rpb25UZW1wbGF0ZS5mcmVxdWVuY3lUeXBlID0gImFkLWhvYyI7CiAgICAgIGluc3BlY3Rpb25UZW1wbGF0ZS5jcmVhdGVkQnlVc2VyVVVJRCA9IGN1cnJlbnRVc2VyRGV0YWlscy5wcm9maWxlLnVzZXJpZDsKICAgICAgaW5zcGVjdGlvblRlbXBsYXRlLmNyZWF0ZWRCeVVzZXJOYW1lID0gYCR7Y3VycmVudFVzZXJEZXRhaWxzLnByb2ZpbGUuZmlyc3ROYW1lfSAKICAgICAgICAke2N1cnJlbnRVc2VyRGV0YWlscy5wcm9maWxlLmxhc3ROYW1lfWA7CiAgICAgIGxldCByZW1pbmRlcmFycmF5ID0gW107CgogICAgICBmb3IgKGxldCByZW1pbmRlciBvZiB2YWx1ZS5yZW1pbmRlckFycmF5KSB7CiAgICAgICAgbGV0IG9iaiA9IHsKICAgICAgICAgIHJlbWluZGVyOiByZW1pbmRlci5yZW1pbmRlciwKICAgICAgICAgIGR1cmF0aW9uVmFsdWU6IHJlbWluZGVyLmR1cmF0aW9uVmFsdWUsCiAgICAgICAgICBkdXJhdGlvblR5cGU6IHJlbWluZGVyLmR1cmF0aW9uVHlwZQogICAgICAgIH07CiAgICAgICAgcmVtaW5kZXJhcnJheS5wdXNoKG9iaik7CiAgICAgICAgaW5zcGVjdGlvblRlbXBsYXRlLnJlbWluZGVyID0gSlNPTi5zdHJpbmdpZnkocmVtaW5kZXJhcnJheSk7CiAgICAgIH0KCiAgICAgIGZvciAobGV0IHRlbXBsYXRlIG9mIHZhbHVlLnNlbGVjdGVkVGVtcGxhdGUpIHsKICAgICAgICBsZXQgaW5zcGVjdGlvbkl0ZW1DYXRlZ29yeSA9IHt9OwogICAgICAgIGxldCBpbnNwZWN0aW9uSXRlbXMgPSBbXTsKICAgICAgICBpbnNwZWN0aW9uSXRlbUNhdGVnb3J5Lm5hbWUgPSB0ZW1wbGF0ZS5pdGVtTmFtZS52YWx1ZTsKICAgICAgICBsZXQgYW5zd2VycyA9IHRlbXBsYXRlLmFuc3dlcnMudmFsdWU7CiAgICAgICAgbGV0IGFuc3dlciA9IFtdOwoKICAgICAgICBmb3IgKGxldCBhbnMgb2YgYW5zd2VycykgewogICAgICAgICAgYW5zd2VyLnB1c2goYW5zLnZhbHVlKTsKICAgICAgICB9CgogICAgICAgIGxldCBvYmogPSB7CiAgICAgICAgICBuYW1lOiB0ZW1wbGF0ZS5pdGVtTmFtZS52YWx1ZSwKICAgICAgICAgIHR5cGU6IHRlbXBsYXRlLnR5cGUudmFsdWUsCiAgICAgICAgICBtYW5kYXRvcnk6IHRlbXBsYXRlLm1hbmRhdG9yeS52YWx1ZSwKICAgICAgICAgIGRlc2NyaXB0aW9uOiAiIgogICAgICAgIH07CiAgICAgICAgb2JqLmFuc3dlcnMgPSBhbnN3ZXI7CiAgICAgICAgaW5zcGVjdGlvbkl0ZW1DYXRlZ29yaWVzLnB1c2goaW5zcGVjdGlvbkl0ZW1DYXRlZ29yeSk7CiAgICAgICAgaW5zcGVjdGlvbkl0ZW1zLnB1c2gob2JqKTsKICAgICAgICBpbnNwZWN0aW9uSXRlbUNhdGVnb3J5Lmluc3BlY3Rpb25JdGVtcyA9IGluc3BlY3Rpb25JdGVtczsKICAgICAgfQoKICAgICAgaW5zcGVjdGlvblRlbXBsYXRlLmluc3BlY3Rpb25JdGVtQ2F0ZWdvcmllcyA9IGluc3BlY3Rpb25JdGVtQ2F0ZWdvcmllczsKICAgICAgYWRkSW5zcGVjdGlvblRlbXBsYXRlUmVxdWVzdC5pbnNwZWN0aW9uVGVtcGxhdGUgPSBpbnNwZWN0aW9uVGVtcGxhdGU7CiAgICAgIEluc3BlY3Rpb25TZXJ2aWNlLmFkZEluc3BlY3Rpb25UZW1wbGF0ZU9mSW5zcGVjdGlvblJlcXVlc3QoYWRkSW5zcGVjdGlvblRlbXBsYXRlUmVxdWVzdCkudGhlbihyZXNwb25zZSA9PiB7CiAgICAgICAgaWYgKHJlc3BvbnNlLnN0YXR1cyA9PT0gMjAwKSB7CiAgICAgICAgICB0aGlzLnNob3dUb2FzdCgiQWRkaXRpb25hbCBTY2hlZHVsZSBDcmVhdGVkIFN1Y2Nlc3NmdWxseS4iLCAic3VjY2VzcyIpOwogICAgICAgICAgdGhpcy5pbnNwZWN0aW9uUmVxdWVzdCA9IGZhbHNlOwogICAgICAgICAgdGhpcy5zdWJtaXR0ZWRBbmRQZW5kaW5nSW5zcGVjdGlvbigpOwogICAgICAgIH0KICAgICAgfSkuY2F0Y2goZXJyb3IgPT4gewogICAgICAgIGlmIChlcnJvci5yZXNwb25zZS5zdGF0dXMgPT09IDQwNikgewogICAgICAgICAgdGhpcy5zaG93VG9hc3QoIlJlcXVlc3QgRXJyb3IuIiwgImVycm9yIik7CiAgICAgICAgfSBlbHNlIHsKICAgICAgICAgIHRoaXMuc2hvd1RvYXN0KGVycm9yLnJlc3BvbnNlLmRhdGEsICJlcnJvciIpOwogICAgICAgIH0KICAgICAgfSk7CiAgICB9LAoKICAgIGNoZWNrVmFsaWRhdGlvbigpIHt9LAoKICAgIHVwZGF0ZVNlcnZpY2VSZXF1ZXN0KCkgewogICAgICB0aGlzLiRyZWZzLm15Y2hpbGQuJHYuJHRvdWNoKCk7CiAgICAgIHRoaXMubG9hZGVyRmxhZyA9IHRydWU7CgogICAgICBpZiAodGhpcy5maWxlUmVjb3JkICE9PSBudWxsKSB7CiAgICAgICAgbGV0IFVwZGF0ZVNlcnZpY2VSZXF1ZXN0UmVxdWVzdCA9IHsKICAgICAgICAgIHV1aWQ6IHRoaXMuc2VydmljZVJlcXVlc3RPYmoudXVpZCwKICAgICAgICAgIG5hbWU6IHRoaXMuc2VydmljZVJlcXVlc3RPYmouaXNzdWVOYW1lLAogICAgICAgICAgYXNzZXRVVUlEOiB0aGlzLnNlcnZpY2VSZXF1ZXN0T2JqLmFzc2V0VVVJRCwKICAgICAgICAgIHByaW9yaXR5OiB0aGlzLnNlcnZpY2VSZXF1ZXN0T2JqLnByaW9yaXR5LAogICAgICAgICAgc3RhdHVzOiB0aGlzLnNlcnZpY2VSZXF1ZXN0T2JqLnN0YXR1cywKICAgICAgICAgIGNvbW1lbnRzOiB0aGlzLnNlcnZpY2VSZXF1ZXN0T2JqLmlzc3VlRGVzY3JpcHRpb24sCiAgICAgICAgICBpZ25vcmVDb21tZW50czogdGhpcy5zZXJ2aWNlUmVxdWVzdE9iai5pZ25vcmVDb21tZW50cwogICAgICAgIH07CiAgICAgICAgVXBkYXRlU2VydmljZVJlcXVlc3RSZXF1ZXN0LmltYWdlVm9pY2VzID0gdGhpcy5maWxlVXBsb2FkOwogICAgICAgIEluc3BlY3Rpb25TZXJ2aWNlLnVwZGF0ZVNlcnZpY2VSZXF1ZXN0KFVwZGF0ZVNlcnZpY2VSZXF1ZXN0UmVxdWVzdCkudGhlbihyZXMgPT4gewogICAgICAgICAgaWYgKHJlcy5kYXRhLnJlc3BvbnNlQ29kZSA9PSAiRjIwMCIpIHsKICAgICAgICAgICAgdGhpcy4kcm91dGVyLnB1c2goewogICAgICAgICAgICAgIG5hbWU6ICJzZXJ2aWNlLXJlcXVlc3RzIiwKICAgICAgICAgICAgICBwYXJhbXM6IHsKICAgICAgICAgICAgICAgIHRvYXN0RmxhZzogdHJ1ZSwKICAgICAgICAgICAgICAgIHRvYXN0U3VjY2VzczogInN1Y2Nlc3MiLAogICAgICAgICAgICAgICAgbWVzc2FnZTogIlNlcnZpY2UgUmVxdWVzdCBVcGRhdGVkIFN1Y2Nlc3NmdWxseS4iCiAgICAgICAgICAgICAgfQogICAgICAgICAgICB9KTsKICAgICAgICAgICAgdGhpcy5sb2FkZXJGbGFnID0gZmFsc2U7CiAgICAgICAgICB9CiAgICAgICAgfSkuY2F0Y2goZSA9PiB7CiAgICAgICAgICB0aGlzLnNob3dUb2FzdChlLnJlc3BvbnNlLmRhdGEsICJlcnJvciIpOwogICAgICAgICAgdGhpcy5sb2FkZXJGbGFnID0gZmFsc2U7CiAgICAgICAgfSk7CiAgICAgIH0gZWxzZSB7CiAgICAgICAgdGhpcy5sb2FkZXJGbGFnID0gdHJ1ZTsKICAgICAgICBsZXQgVXBkYXRlU2VydmljZVJlcXVlc3RSZXF1ZXN0ID0gewogICAgICAgICAgdXVpZDogdGhpcy5zZXJ2aWNlUmVxdWVzdE9iai51dWlkLAogICAgICAgICAgbmFtZTogdGhpcy5zZXJ2aWNlUmVxdWVzdE9iai5pc3N1ZU5hbWUsCiAgICAgICAgICBhc3NldFVVSUQ6IHRoaXMuc2VydmljZVJlcXVlc3RPYmouYXNzZXRVVUlELAogICAgICAgICAgcHJpb3JpdHk6IHRoaXMuc2VydmljZVJlcXVlc3RPYmoucHJpb3JpdHksCiAgICAgICAgICBzdGF0dXM6IHRoaXMuc2VydmljZVJlcXVlc3RPYmouc3RhdHVzLAogICAgICAgICAgY29tbWVudHM6IHRoaXMuc2VydmljZVJlcXVlc3RPYmouaXNzdWVEZXNjcmlwdGlvbiwKICAgICAgICAgIGlnbm9yZUNvbW1lbnRzOiB0aGlzLnNlcnZpY2VSZXF1ZXN0T2JqLmlnbm9yZUNvbW1lbnRzCiAgICAgICAgfTsKICAgICAgICBJbnNwZWN0aW9uU2VydmljZS51cGRhdGVTZXJ2aWNlUmVxdWVzdChVcGRhdGVTZXJ2aWNlUmVxdWVzdFJlcXVlc3QpLnRoZW4ocmVzID0+IHsKICAgICAgICAgIGlmIChyZXMuZGF0YS5yZXNwb25zZUNvZGUgPT0gIkYyMDAiKSB7CiAgICAgICAgICAgIHRoaXMubG9hZGVyRmxhZyA9IGZhbHNlOwogICAgICAgICAgICB0aGlzLiRyb3V0ZXIucHVzaCh7CiAgICAgICAgICAgICAgbmFtZTogInNlcnZpY2UtcmVxdWVzdHMiLAogICAgICAgICAgICAgIHBhcmFtczogewogICAgICAgICAgICAgICAgdG9hc3RGbGFnOiB0cnVlLAogICAgICAgICAgICAgICAgdG9hc3RTdWNjZXNzOiAic3VjY2VzcyIsCiAgICAgICAgICAgICAgICBtZXNzYWdlOiAiU2VydmljZSBSZXF1ZXN0IFVwZGF0ZWQgU3VjY2Vzc2Z1bGx5LiIKICAgICAgICAgICAgICB9CiAgICAgICAgICAgIH0pOwogICAgICAgICAgfQogICAgICAgIH0pLmNhdGNoKGUgPT4gewogICAgICAgICAgdGhpcy5zaG93VG9hc3QoZS5yZXNwb25zZS5kYXRhLCAiZXJyb3IiKTsKICAgICAgICAgIHRoaXMubG9hZGVyRmxhZyA9IGZhbHNlOwogICAgICAgIH0pOwogICAgICB9CiAgICB9LAoKICAgIG9wZW5Qb3BVcChpdGVtKSB7CiAgICAgIGlmIChpdGVtLnN0YXR1cyA9PT0gIlBlbmRpbmciKSB7CiAgICAgICAgdGhpcy4kcm91dGVyLnB1c2goewogICAgICAgICAgbmFtZTogInZpZXctYXNzaWduZWQtdGVtcGxhdGUiLAogICAgICAgICAgcGFyYW1zOiB7CiAgICAgICAgICAgIHRlbXBsYXRlVVVJRDogaXRlbS51dWlkLAogICAgICAgICAgICBhc3NldFVVSUQ6IHRoaXMuYXNzZXRVVUlELAogICAgICAgICAgICBUZW1wbGF0ZVR5cGU6ICJWaWV3IiwKICAgICAgICAgICAgZmxhZzogdHJ1ZQogICAgICAgICAgfQogICAgICAgIH0pOwogICAgICB9IGVsc2UgewogICAgICAgIHRoaXMuJHJvdXRlci5wdXNoKHsKICAgICAgICAgIG5hbWU6ICJpbnNwZWN0aW9uLWRldGFpbHMiLAogICAgICAgICAgcGFyYW1zOiB7CiAgICAgICAgICAgIGluc3BlY3Rpb25VVUlEOiBpdGVtLnV1aWQsCiAgICAgICAgICAgIGluc3BlY3Rpb25DaGlsZDogZmFsc2UsCiAgICAgICAgICAgIHBhcmVudFVVSUQ6IHRoaXMuaW5zcGVjdGlvblJlcG9ydFVVSUQsCiAgICAgICAgICAgIHNlcnZpY2VSZXF1ZXN0Q2hpbGQ6IHRydWUKICAgICAgICAgIH0KICAgICAgICB9KTsKICAgICAgfQogICAgfSwKCiAgICBvcGVuSXNzdWVQb3BVcCh1dWlkKSB7CiAgICAgIHRoaXMuJHJvdXRlci5wdXNoKHsKICAgICAgICBuYW1lOiAiaXNzdWUtZGV0YWlsIiwKICAgICAgICBwYXJhbXM6IHsKICAgICAgICAgIGlzc3VlSUQ6IHV1aWQKICAgICAgICB9CiAgICAgIH0pOwogICAgfSwKCiAgICBwYWdpbmF0aW9uKHZhbHVlKSB7CiAgICAgIGxldCBjdXJyZW50VXNlckRldGFpbHMgPSBKU09OLnBhcnNlKGxvY2FsU3RvcmFnZS5nZXRJdGVtKCJjdXJyZW50VXNlckRldGFpbHMiKSk7CiAgICAgIGxldCBvYmogPSB7CiAgICAgICAgbGltaXQ6IDUsCiAgICAgICAgb2Zmc2V0OiB2YWx1ZSwKICAgICAgICB0ZW5hbnRVVUlEOiBjdXJyZW50VXNlckRldGFpbHMucHJvZmlsZS5vcmdhbml6YXRpb25JZCwKICAgICAgICBwYXJlbnRJbnNwZWN0aW9uVVVJRDogdGhpcy5pbnNwZWN0aW9uUmVwb3J0VVVJRCwKICAgICAgICBuZXdBZGRpdGlvbmFsOiB0cnVlLAogICAgICAgIHNlcnZpY2VSZXF1ZXN0OiB0cnVlCiAgICAgIH07CiAgICAgIEluc3BlY3Rpb25TZXJ2aWNlLmdldEluc3BlY3Rpb25UZW1wbGF0ZXNQZW5kaW5nYW5kU3VibWl0dGVkKG9iaikudGhlbihyZXNwb25zZSA9PiB7CiAgICAgICAgdGhpcy5jdXJyZW50UGFnZSA9IHZhbHVlOwogICAgICAgIHRoaXMubnVtYmVyT2ZQYWdlcyA9IHJlc3BvbnNlLmRhdGEuY29udGVudC50b3RhbFBhZ2VzOwogICAgICAgIHJlc3BvbnNlLmRhdGEuY29udGVudC5hZGRpdGlvbmFsSW5zcGVjdGlvbi5tYXAocmVwb3J0ID0+IHsKICAgICAgICAgIHJlcG9ydC5jcmVhdGVkQXQgPSBtb21lbnQocmVwb3J0LmNyZWF0ZWRBdCkuZm9ybWF0KCJERCBNTU0gWVlZWSBoaDptbSBhIik7CiAgICAgICAgfSk7CiAgICAgICAgdGhpcy5kYXRhUGVuZGluZyA9IHJlc3BvbnNlLmRhdGEuY29udGVudC5hZGRpdGlvbmFsSW5zcGVjdGlvbjsKCiAgICAgICAgZm9yIChsZXQgdXNlciBvZiB0aGlzLmFsbFVzZXJzKSB7CiAgICAgICAgICBmb3IgKGxldCBkYXRhIG9mIHRoaXMuZGF0YVBlbmRpbmcpIHsKICAgICAgICAgICAgaWYgKHVzZXIudXVpZCA9PT0gZGF0YS5jcmVhdGVkRm9yVXNlclVVSUQpIHsKICAgICAgICAgICAgICBkYXRhLmFzc2lnbmVkVG8gPSB1c2VyLmxhYmVsOwogICAgICAgICAgICB9CiAgICAgICAgICB9CiAgICAgICAgfQogICAgICB9KS5jYXRjaChlcnJvciA9PiB7CiAgICAgICAgdGhpcy5zaG93VG9hc3QoIkFuIEVycm9yIG9jY3VycmVkIHdoaWxlIGZldGNoaW5nIFBlbmRpbmcgSW5zcGVjdGlvbnMuIiwgImVycm9yIik7CiAgICAgIH0pOwogICAgfSwKCiAgICBjbG9zZUFkZGl0aW9uYWwoKSB7CiAgICAgIHRoaXMuaW5zcGVjdGlvblJlcXVlc3QgPSBmYWxzZTsKICAgIH0sCgogICAgcmVxdWVzdEFkZGl0aW9uYWwoKSB7CiAgICAgIHRoaXMuaW5zcGVjdGlvblJlcXVlc3QgPSB0cnVlOwogICAgfSwKCiAgICBzZWxlY3RlZFRlbXBsYXRlcyh2YWx1ZSkgewogICAgICB0aGlzLlNlbGVjdGVkSXRlbXMgPSB2YWx1ZTsKICAgIH0sCgogICAgZnVsbHNjcmVlbkltYWdlKHZhbHVlKSB7CiAgICAgIHRoaXMucG9wdXBJbWFnZSA9IHZhbHVlOwogICAgICB0aGlzLmltYWdlRGlhbG9nID0gdHJ1ZTsKICAgIH0sCgogICAgZ2V0QXNzZXQodXVpZCkgewogICAgICB0aGlzLmxvYWRpbmcgPSB0cnVlOwogICAgICBBc3NldE1hbmFnZW1lbnRTZXJ2aWNlLmdldEFzc2V0TmFtZUFuZE51bWJlckFuZENhdGVnb3J5QnlBc3NldFVVSUQodXVpZCkudGhlbihyZXNwb25zZSA9PiB7CiAgICAgICAgdGhpcy5hc3NldCA9IHJlc3BvbnNlLmRhdGEuYXNzZXRJbmZvRFRPOwogICAgICAgIHRoaXMuYXNzZXRJbmRleCsrOwogICAgICAgIHRoaXMuc2hvdyA9IHRydWU7CiAgICAgIH0pLmNhdGNoKGUgPT4gewogICAgICAgIHRoaXMubG9hZGluZyA9IGZhbHNlOwogICAgICAgIHRoaXMuYXNzZXRFcnJvciA9IHRydWU7CiAgICAgICAgdGhpcy5zaG93VG9hc3QoIkZhaWxlZCB0byBsb2FkIGFzc2V0IGluZm9ybWF0aW9uISIsICJlcnJvciIpOwogICAgICB9KTsKICAgIH0sCgogICAgcmVjZWl2ZURvY3VtZW50KGZpbGUpIHsKICAgICAgdGhpcy5sb2FkZXJGbGFnID0gdHJ1ZTsKICAgICAgQXNzZXRNYW5hZ2VtZW50U2VydmljZS51cGxvYWRGaWxlVG9zMyh0aGlzLmZpbGVSZWNvcmQpLnRoZW4ocmVzID0+IHsKICAgICAgICBpZiAocmVzLmRhdGEucmVzcG9uc2VJZGVudGlmaWVyID09PSAiU3VjY2VzcyIpIHsKICAgICAgICAgIGxldCBpbWFnZVZvaWNlID0gewogICAgICAgICAgICBjb250ZW50VXJsOiByZXMuZGF0YS5maWxlVXJsCiAgICAgICAgICB9OwogICAgICAgICAgdGhpcy5maWxlVXBsb2FkID0gW107CiAgICAgICAgICB0aGlzLmZpbGVVcGxvYWQucHVzaChpbWFnZVZvaWNlKTsKICAgICAgICAgIHRoaXMuc2hvd1RvYXN0KCJJbWFnZSBhZGRlZCBzdWNjZXNzZnVsbHkhIiwgInN1Y2Nlc3MiKTsKICAgICAgICAgIHRoaXMubG9hZGVyRmxhZyA9IGZhbHNlOwogICAgICAgIH0KICAgICAgfSkuY2F0Y2goZSA9PiB7CiAgICAgICAgdGhpcy5zaG93VG9hc3QoZS5kYXRhLnJlc3BvbnNlLCAiZXJyb3IiKTsKICAgICAgICB0aGlzLmxvYWRlckZsYWcgPSBmYWxzZTsKICAgICAgfSk7CiAgICB9LAoKICAgIGFzc2V0SW5mb3JtYXRpb25BY2NvcmRpb25GdW5jdGlvbigpIHsKICAgICAgaWYgKHRoaXMuJHJlZnMuYXNzZXRJbmZvcm1hdGlvbkFjY29yZGlvbi5vcGVuRmxhZyA9PT0gdHJ1ZSkgewogICAgICAgIHRoaXMuJHJlZnMuQXR0YWNobWVudHNBY2NvcmRpb24ub3BlbkZsYWcgPSBmYWxzZTsKCiAgICAgICAgaWYgKHRoaXMuJHJlZnMuSXNzdWVzQWNjb3JkaW9uKSB7CiAgICAgICAgICB0aGlzLiRyZWZzLklzc3Vlc0FjY29yZGlvbi5vcGVuRmxhZyA9IGZhbHNlOwogICAgICAgIH0KICAgICAgfQogICAgfSwKCiAgICBDb21tZW50c0FjY29yZGlvbkZ1bmN0aW9uKCkgewogICAgICBpZiAodGhpcy4kcmVmcy5Db21tZW50c0FjY29yZGlvbi5vcGVuRmxhZyA9PT0gdHJ1ZSkgewogICAgICAgIHRoaXMuJHJlZnMuQXR0YWNobWVudHNBY2NvcmRpb24ub3BlbkZsYWcgPSBmYWxzZTsKICAgICAgICB0aGlzLiRyZWZzLmFzc2V0SW5mb3JtYXRpb25BY2NvcmRpb24ub3BlbkZsYWcgPSBmYWxzZTsKICAgICAgfQogICAgfSwKCiAgICBBdHRhY2htZW50c0FjY29yZGlvbkZ1bmN0aW9uKCkgewogICAgICBpZiAodGhpcy4kcmVmcy5BdHRhY2htZW50c0FjY29yZGlvbi5vcGVuRmxhZyA9PT0gdHJ1ZSkgewogICAgICAgIHRoaXMuJHJlZnMuYXNzZXRJbmZvcm1hdGlvbkFjY29yZGlvbi5vcGVuRmxhZyA9IGZhbHNlOwoKICAgICAgICBpZiAodGhpcy4kcmVmcy5Jc3N1ZXNBY2NvcmRpb24pIHsKICAgICAgICAgIHRoaXMuJHJlZnMuSXNzdWVzQWNjb3JkaW9uLm9wZW5GbGFnID0gZmFsc2U7CiAgICAgICAgfQogICAgICB9CiAgICB9LAoKICAgIGlzc3Vlc0luZm9ybWF0aW9uQWNjb3JkaW9uRnVuY3Rpb24oKSB7CiAgICAgIGlmICh0aGlzLiRyZWZzLklzc3Vlc0FjY29yZGlvbi5vcGVuRmxhZyA9PT0gdHJ1ZSkgewogICAgICAgIHRoaXMuJHJlZnMuYXNzZXRJbmZvcm1hdGlvbkFjY29yZGlvbi5vcGVuRmxhZyA9IGZhbHNlOwogICAgICAgIHRoaXMuJHJlZnMuQXR0YWNobWVudHNBY2NvcmRpb24ub3BlbkZsYWcgPSBmYWxzZTsKICAgICAgfQogICAgfSwKCiAgICBjbG9zZSgpIHsKICAgICAgdGhpcy5pbWFnZURpYWxvZyA9IGZhbHNlOwogICAgfSwKCiAgICBjbG9zZU5ld0lzc3VlKCkgewogICAgICB0aGlzLnN1Ym1pdE5ld0lzc3VlID0gZmFsc2U7CiAgICB9LAoKICAgIGNsb3NlSWdub3JlSXNzdWUoKSB7CiAgICAgIHRoaXMuSWdub3JlSXNzdWVWYWx1ZSA9IGZhbHNlOwogICAgfSwKCiAgICBpZ25vcmVJc3N1ZSgpIHsKICAgICAgdGhpcy5JZ25vcmVJc3N1ZVZhbHVlID0gdHJ1ZTsKICAgIH0sCgogICAgaWdub3JlUmVxdWVzdCh2YWx1ZSkgewogICAgICBsZXQgaWdub3JlQ29tbWVudHNGaWVsZCA9IHZhbHVlOwoKICAgICAgaWYgKCFpZ25vcmVDb21tZW50c0ZpZWxkLnZhbHVlKSB7CiAgICAgICAgaWdub3JlQ29tbWVudHNGaWVsZC52YWxpZCA9IGZhbHNlOwogICAgICAgIGlnbm9yZUNvbW1lbnRzRmllbGQudmFsaWRNZXNzYWdlID0gIlJlcXVpcmVkISI7CiAgICAgICAgdGhpcy5pZ25vcmVDb21tZW50c0ZpZWxkID0gaWdub3JlQ29tbWVudHNGaWVsZDsKICAgICAgICByZXR1cm47CiAgICAgIH0KCiAgICAgIHRoaXMubG9hZGVyRmxhZyA9IHRydWU7CiAgICAgIGxldCB1cGRhdGVJc3N1ZVJlcXVlc3QgPSB7fTsKICAgICAgbGV0IHNlcnZpY2VSZXF1ZXN0ID0gdGhpcy5zZXJ2aWNlUmVxdWVzdDsKICAgICAgc2VydmljZVJlcXVlc3Quc3RhdHVzID0gImlnbm9yZWQiOwogICAgICBzZXJ2aWNlUmVxdWVzdC5pZ25vcmVkQnkgPSB0aGlzLmN1cnJlbnRVc2VyRGV0YWlscy5wcm9maWxlLmZpcnN0TmFtZSArICIgIiArIHRoaXMuY3VycmVudFVzZXJEZXRhaWxzLnByb2ZpbGUubGFzdE5hbWU7CiAgICAgIHNlcnZpY2VSZXF1ZXN0LnJlcG9ydGVkQXQgPSBuZXcgbW9tZW50KHNlcnZpY2VSZXF1ZXN0LnJlcG9ydGVkQXQpLnRvSVNPU3RyaW5nKCk7CiAgICAgIHNlcnZpY2VSZXF1ZXN0Lmlnbm9yZUNvbW1lbnRzID0gaWdub3JlQ29tbWVudHNGaWVsZC52YWx1ZTsKICAgICAgdXBkYXRlSXNzdWVSZXF1ZXN0Lmlzc3VlUmVwb3J0aW5nID0gc2VydmljZVJlcXVlc3Q7CiAgICAgIHRoaXMuY2xvc2VJZ25vcmVJc3N1ZSgpOwogICAgICBJbnNwZWN0aW9uU2VydmljZS51cGRhdGVJc3N1ZSh1cGRhdGVJc3N1ZVJlcXVlc3QpLnRoZW4ocmVzcG9uc2UgPT4gewogICAgICAgIHRyeSB7CiAgICAgICAgICBpZiAocmVzcG9uc2Uuc3RhdHVzID09PSAyMDApIHsKICAgICAgICAgICAgdGhpcy5sb2FkZXJGbGFnID0gZmFsc2U7CiAgICAgICAgICAgIHRoaXMuc2VydmljZVJlcXVlc3Quc3RhdHVzID0gImlnbm9yZWQiOwogICAgICAgICAgICB0aGlzLnNob3dUb2FzdCgiU2VydmljZSByZXF1ZXN0IGlnbm9yZWQgc3VjY2Vzc2Z1bGx5ISIsICJzdWNjZXNzIik7IC8vIHp6enoKCiAgICAgICAgICAgIHRoaXMuJHJvdXRlci5wdXNoKHsKICAgICAgICAgICAgICBuYW1lOiAnc2VydmljZS1yZXF1ZXN0cycKICAgICAgICAgICAgfSk7CiAgICAgICAgICB9IGVsc2UgewogICAgICAgICAgICB0aGlzLnNob3dUb2FzdCgiRXJyb3Igd2hpbGUgaWdub3Jpbmcgc2VydmljZSByZXF1ZXN0LiBQbGVhc2UgdHJ5IGFnYWluISIsICJlcnJvciIpOwogICAgICAgICAgfQogICAgICAgIH0gY2F0Y2ggKGUpIHsKICAgICAgICAgIHRoaXMuc2hvd1RvYXN0KGUuZGF0YS5yZXNwb25zZSwgImVycm9yIik7CiAgICAgICAgfQogICAgICB9KS5jYXRjaChlcnJvciA9PiB7CiAgICAgICAgdGhpcy5sb2FkZXJGbGFnID0gZmFsc2U7CgogICAgICAgIGlmIChlcnJvci5yZXNwb25zZS5zdGF0dXMgPT09IDQwNikgewogICAgICAgICAgdGhpcy5zaG93VG9hc3QoIkFuIHVuZXhwZWN0ZWQgRXJyb3IgT2NjdXJyZWQuIiwgImVycm9yIik7CiAgICAgICAgfSBlbHNlIHsKICAgICAgICAgIHRoaXMuc2hvd1RvYXN0KGVycm9yLmRhdGEucmVzcG9uc2UsICJlcnJvciIpOwogICAgICAgIH0KICAgICAgfSkuZmluYWxseSgoKSA9PiB7CiAgICAgICAgdGhpcy5zZXJ2aWNlUmVxdWVzdCA9IHNlcnZpY2VSZXF1ZXN0OwogICAgICB9KTsKICAgIH0sCgogICAgZ2V0U2VydmljZVJlcXVlc3RCeVVVSUQoKSB7CiAgICAgIEluc3BlY3Rpb25TZXJ2aWNlLmdldFNlcnZpY2VSZXF1ZXN0QnlVVUlEKHRoaXMuaXNzdWVVVUlEKS50aGVuKHJlc3BvbnNlID0+IHsKICAgICAgICBpZiAocmVzcG9uc2Uuc3RhdHVzID09PSAyMDApIHsKICAgICAgICAgIHRoaXMuYXR0YWNobWVudHMgPSByZXNwb25zZS5kYXRhLmF0dGFjaG1lbnRzOwogICAgICAgICAgbGV0IHNlcnZpY2VSZXF1ZXN0ID0gcmVzcG9uc2UuZGF0YS5zZXJ2aWNlUmVxdWVzdDsKICAgICAgICAgIGRvY3VtZW50LnRpdGxlID0gc2VydmljZVJlcXVlc3QuaXNzdWVOdW1iZXIgKyAiIHwgIiArICJFcm9oYWwiOwogICAgICAgICAgdGhpcy51c2VyQ29tbWVudHMgPSBzZXJ2aWNlUmVxdWVzdC5pc3N1ZURlc2NyaXB0aW9uOwogICAgICAgICAgdGhpcy5yZXBhaXJJbnN0cnVjdGlvbiA9IHNlcnZpY2VSZXF1ZXN0LmRlc2NyaXB0aW9uOwogICAgICAgICAgdGhpcy5pc3N1ZU5hbWUgPSBzZXJ2aWNlUmVxdWVzdC5pc3N1ZU5hbWU7CiAgICAgICAgICB0aGlzLmlzc3VlVHlwZSA9IHNlcnZpY2VSZXF1ZXN0Lmlzc3VlVHlwZTsKICAgICAgICAgIHRoaXMuaXNzdWVDYXRlZ29yeSA9IHNlcnZpY2VSZXF1ZXN0Lmlzc3VlQ2F0ZWdvcnk7CiAgICAgICAgICB0aGlzLnNlcnZpY2VSZXF1ZXN0VVVJRCA9IHNlcnZpY2VSZXF1ZXN0LnV1aWQ7CiAgICAgICAgICB0aGlzLnRlbXBsYXRlTmFtZSA9IHNlcnZpY2VSZXF1ZXN0Lmlzc3VlTmFtZTsKICAgICAgICAgIHRoaXMucGFyZW50U2VydmljZVJlcXVlc3RVVUlEID0gc2VydmljZVJlcXVlc3QucGFyZW50U2VydmljZVJlcXVlc3RVVUlEOwogICAgICAgICAgbGV0IHVzZXJ1dWlkcyA9IFtdOwogICAgICAgICAgbGV0IGFzc2V0dXVpZHMgPSBbXTsKICAgICAgICAgIHRoaXMuZ2V0SXNzdWVzQnlBc3NldHMoc2VydmljZVJlcXVlc3QuYXNzZXRVVUlEKTsKICAgICAgICAgIGFzc2V0dXVpZHMucHVzaChzZXJ2aWNlUmVxdWVzdC5hc3NldFVVSUQpOwogICAgICAgICAgdGhpcy5hc3NldElkID0gc2VydmljZVJlcXVlc3QuYXNzZXRVVUlEOwogICAgICAgICAgdGhpcy5zdWJtaXR0ZWRBbmRQZW5kaW5nSW5zcGVjdGlvbigpOwogICAgICAgICAgdGhpcy5nZXRBc3NldChzZXJ2aWNlUmVxdWVzdC5hc3NldFVVSUQpOwogICAgICAgICAgdXNlcnV1aWRzLnB1c2goc2VydmljZVJlcXVlc3Quc3VibWl0dGVkQnlVc2VyVVVJRCk7CiAgICAgICAgICBsZXQgYXR0YWNobWVudHMgPSBbXTsKICAgICAgICAgIGxldCBjb21tZW50cyA9ICIiOwogICAgICAgICAgbGV0IGF0dGFjaG1lbnRzUmVzcG9uc2UgPSByZXNwb25zZS5kYXRhLmF0dGFjaG1lbnRzOwoKICAgICAgICAgIGlmIChhdHRhY2htZW50c1Jlc3BvbnNlICYmIGF0dGFjaG1lbnRzUmVzcG9uc2UubGVuZ3RoID4gMCkgewogICAgICAgICAgICBmb3IgKGxldCBhdHRhY2htZW50IG9mIGF0dGFjaG1lbnRzUmVzcG9uc2UpIHsKICAgICAgICAgICAgICBpZiAoYXR0YWNobWVudC5tZXNzYWdlRmxhZykgewogICAgICAgICAgICAgICAgaWYgKGNvbW1lbnRzLmxlbmd0aCA+IDApIHsKICAgICAgICAgICAgICAgICAgY29tbWVudHMgPSBgJHtjb21tZW50c30gJHthdHRhY2htZW50Lm1lc3NhZ2V9YDsKICAgICAgICAgICAgICAgIH0gZWxzZSB7CiAgICAgICAgICAgICAgICAgIGNvbW1lbnRzID0gYXR0YWNobWVudC5tZXNzYWdlOwogICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgIH0gZWxzZSB7CiAgICAgICAgICAgICAgICBhdHRhY2htZW50LmxvYWRpbmcgPSB0cnVlOwoKICAgICAgICAgICAgICAgIGlmIChhdHRhY2htZW50LmNvbnRlbnRVcmwgIT09IG51bGwpIHsKICAgICAgICAgICAgICAgICAgYXR0YWNobWVudHMucHVzaChhdHRhY2htZW50KTsKICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICB9CiAgICAgICAgICAgIH0KICAgICAgICAgIH0KCiAgICAgICAgICBpZiAoIWNvbW1lbnRzKSB7CiAgICAgICAgICAgIC8vcmVxdWVzdCBtYXkgbm90IGJlIGNyZWF0ZWQgaW4gbW9iaWxlIGFwcCwgdXNlIGRlc2NyaXB0aW9uCiAgICAgICAgICAgIGNvbW1lbnRzID0gc2VydmljZVJlcXVlc3QuaXNzdWVEZXNjcmlwdGlvbjsKICAgICAgICAgIH0KCiAgICAgICAgICBzZXJ2aWNlUmVxdWVzdC5yZXBvcnRlZERhdGUgPSBzZXJ2aWNlUmVxdWVzdC5yZXBvcnRlZEF0OwogICAgICAgICAgc2VydmljZVJlcXVlc3QucmVwb3J0ZWRBdCA9IG1vbWVudChzZXJ2aWNlUmVxdWVzdC5yZXBvcnRlZEF0KS5mb3JtYXQoIkREIE1NTSBZWVlZIGhoOm1tIGEiKTsKCiAgICAgICAgICBpZiAoc2VydmljZVJlcXVlc3QucmVzb2x2ZWRBdCAhPT0gbnVsbCkgewogICAgICAgICAgICBzZXJ2aWNlUmVxdWVzdC5yZXNvbHZlZEF0ID0gbW9tZW50KHNlcnZpY2VSZXF1ZXN0LnJlc29sdmVkQXQpLmZvcm1hdCgiREQgTU1NIFlZWVkgaGg6bW0gYSIpOwogICAgICAgICAgfQoKICAgICAgICAgIGlmIChzZXJ2aWNlUmVxdWVzdC5wcmlvcml0eSA9PT0gbnVsbCkgewogICAgICAgICAgICBzZXJ2aWNlUmVxdWVzdC5wcmlvcml0eSA9ICJOb3QgQXNzaWduZWQiOwogICAgICAgICAgfQoKICAgICAgICAgIHRoaXMuY29tbWVudHMgPSBjb21tZW50czsgLy9nZXQgYmFzaWMgaW5mbyBvZiBhc3NldHMgZnJvbSBhc3NldCBtYW5hZ2VtZW50IHNlcnZpY2UgbGlrZSBuYW1lIGFuZCBjYXRlZ29yeSBuYW1lIG9mIGFzc2V0CgogICAgICAgICAgQXNzZXRNYW5hZ2VtZW50U2VydmljZS5nZXROYW1lQW5kVHlwZU9mQXNzZXRzQnlVVUlEUyh7CiAgICAgICAgICAgIHV1aWRzOiBhc3NldHV1aWRzCiAgICAgICAgICB9KS50aGVuKHJlc3BvbnNlMSA9PiB7CiAgICAgICAgICAgIGlmIChyZXNwb25zZTEuc3RhdHVzID09PSAyMDApIHsKICAgICAgICAgICAgICBzZXJ2aWNlUmVxdWVzdC5hc3NldE5hbWUgPSByZXNwb25zZTEuZGF0YS5hc3NldHNbc2VydmljZVJlcXVlc3QuYXNzZXRVVUlEXS5uYW1lOwogICAgICAgICAgICAgIHNlcnZpY2VSZXF1ZXN0LmFzc2V0Q2F0ZWdvcnkgPSByZXNwb25zZTEuZGF0YS5hc3NldHNbc2VydmljZVJlcXVlc3QuYXNzZXRVVUlEXS50eXBlOwogICAgICAgICAgICAgIHNlcnZpY2VSZXF1ZXN0LmFzc2V0TnVtYmVyID0gcmVzcG9uc2UxLmRhdGEuYXNzZXRzW3NlcnZpY2VSZXF1ZXN0LmFzc2V0VVVJRF0uYXNzZXROdW1iZXI7CiAgICAgICAgICAgICAgQXNzZXRQZXJzb25uZWxTZXJ2aWNlLmdldE5hbWVPZlVzZXJzQnlVVUlEUyh7CiAgICAgICAgICAgICAgICB1dWlkczogdXNlcnV1aWRzCiAgICAgICAgICAgICAgfSkudGhlbihyZXNwb25zZTIgPT4gewogICAgICAgICAgICAgICAgaWYgKHJlc3BvbnNlMi5zdGF0dXMgPT09IDIwMCkgewogICAgICAgICAgICAgICAgICBzZXJ2aWNlUmVxdWVzdC5yZXBvcnRlZEJ5ID0gcmVzcG9uc2UyLmRhdGEudXNlcnNbc2VydmljZVJlcXVlc3Quc3VibWl0dGVkQnlVc2VyVVVJRF0ubmFtZTsKICAgICAgICAgICAgICAgICAgdGhpcy5zZXJ2aWNlUmVxdWVzdCA9IHNlcnZpY2VSZXF1ZXN0OwogICAgICAgICAgICAgICAgICB0aGlzLnNlcnZpY2VSZXF1ZXN0T2JqID0gc2VydmljZVJlcXVlc3Q7CiAgICAgICAgICAgICAgICAgIHRoaXMubG9hZGVyRmxhZyA9IGZhbHNlOwogICAgICAgICAgICAgICAgICB0aGlzLmluZGV4VmFsdWUrKzsKICAgICAgICAgICAgICAgIH0gZWxzZSB7CiAgICAgICAgICAgICAgICAgIHRoaXMuc2hvd1RvYXN0KCJFcnJvciBpbiBnZXR0aW5nIGFzc2V0IGJhc2ljIGRldGFpbC4gUGxlYXNlIHRyeSBhZ2FpbiIsICJlcnJvciIpOwogICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgIH0pLmNhdGNoKGVycm9yID0+IHsKICAgICAgICAgICAgICAgIHRoaXMuc2hvd1RvYXN0KGVycm9yLmRhdGEucmVzcG9uc2UsICJlcnJvciIpOwogICAgICAgICAgICAgIH0pOwogICAgICAgICAgICB9IGVsc2UgewogICAgICAgICAgICAgIHRoaXMuc2hvd1RvYXN0KCJFcnJvciBpbiBnZXR0aW5nIGFzc2V0IGJhc2ljIGRldGFpbC4gUGxlYXNlIHRyeSBhZ2FpbiIsICJlcnJvciIpOwogICAgICAgICAgICB9CiAgICAgICAgICB9KSAvLyBlc2xpbnQtZGlzYWJsZS1uZXh0LWxpbmUgaGFuZGxlLWNhbGxiYWNrLWVycgogICAgICAgICAgLmNhdGNoKGVycm9yID0+IHsKICAgICAgICAgICAgdGhpcy5zaG93VG9hc3QoZXJyb3IuZGF0YS5yZXNwb25zZSwgImVycm9yIik7CiAgICAgICAgICB9KTsgLy9nZXQgYXR0YWNobWVudCBjb250ZW50CgogICAgICAgICAgZm9yIChsZXQgYXR0YWNobWVudF9pdGVtIG9mIGF0dGFjaG1lbnRzKSB7CiAgICAgICAgICAgIEluc3BlY3Rpb25TZXJ2aWNlLmdldEZpbGUoYXR0YWNobWVudF9pdGVtLmNvbnRlbnRVcmwpLnRoZW4ocmVzcG9uc2U1ID0+IHsKICAgICAgICAgICAgICBpZiAocmVzcG9uc2U1LmRhdGEucmVzcG9uc2VJZGVudGlmaWVyID09PSAiU3VjY2VzcyIpIHsKICAgICAgICAgICAgICAgIGF0dGFjaG1lbnRfaXRlbS5sb2FkaW5nID0gZmFsc2U7CiAgICAgICAgICAgICAgICBhdHRhY2htZW50X2l0ZW0uY29udGVudCA9IHJlc3BvbnNlNS5kYXRhLmNvbnRlbnQ7CiAgICAgICAgICAgICAgICB0aGlzLmFsbGV4ZWN1dGUgPSB0cnVlOwogICAgICAgICAgICAgICAgdGhpcy5hdHRhY2htZW50cyA9IGF0dGFjaG1lbnRzOwogICAgICAgICAgICAgIH0KICAgICAgICAgICAgfSk7CiAgICAgICAgICB9CiAgICAgICAgfSBlbHNlIHsKICAgICAgICAgIHRoaXMuc2hvd1RvYXN0KCJBbiBFcnJvciBvY2N1cnJlZCIsICJlcnJvciIpOwogICAgICAgIH0KICAgICAgfSkuY2F0Y2goZXJyb3IgPT4gewogICAgICAgIHRoaXMuc2hvd1RvYXN0KGVycm9yLmRhdGEucmVzcG9uc2UsICJlcnJvciIpOwogICAgICB9KTsKICAgIH0sCgogICAgc3VibWl0dGVkQW5kUGVuZGluZ0luc3BlY3Rpb24oKSB7CiAgICAgIGxldCBjdXJyZW50VXNlckRldGFpbHMgPSBKU09OLnBhcnNlKGxvY2FsU3RvcmFnZS5nZXRJdGVtKCJjdXJyZW50VXNlckRldGFpbHMiKSk7CiAgICAgIGxldCBvYmogPSB7CiAgICAgICAgbGltaXQ6IDUsCiAgICAgICAgb2Zmc2V0OiAwLAogICAgICAgIHRlbmFudFVVSUQ6IGN1cnJlbnRVc2VyRGV0YWlscy5wcm9maWxlLm9yZ2FuaXphdGlvbklkLAogICAgICAgIHBhcmVudEluc3BlY3Rpb25VVUlEOiB0aGlzLmluc3BlY3Rpb25SZXBvcnRVVUlELAogICAgICAgIG5ld0FkZGl0aW9uYWw6IHRydWUsCiAgICAgICAgc2VydmljZVJlcXVlc3Q6IHRydWUKICAgICAgfTsKICAgICAgSW5zcGVjdGlvblNlcnZpY2UuZ2V0SW5zcGVjdGlvblRlbXBsYXRlc1BlbmRpbmdhbmRTdWJtaXR0ZWQob2JqKS50aGVuKHJlcyA9PiB7CiAgICAgICAgdGhpcy5kYXRhUGVuZGluZyA9IHJlcy5kYXRhLmNvbnRlbnQuYWRkaXRpb25hbEluc3BlY3Rpb247CiAgICAgICAgdGhpcy5udW1iZXJPZlBhZ2VzID0gcmVzLmRhdGEuY29udGVudC50b3RhbFBhZ2VzOwogICAgICB9KS5jYXRjaChlID0+IHsKICAgICAgICB0aGlzLnNob3dUb2FzdChlLmRhdGEucmVzcG9uc2UsICJlcnJvciIpOwogICAgICB9KTsKICAgIH0sCgogICAgZ2V0SW5zcGVjdGlvblJlcG9ydHNGb3JTZXJ2aWNlUmVxdWVzdCgpIHsKICAgICAgSW5zcGVjdGlvblNlcnZpY2UuZ2V0UGFnaW5hdGVkSW5zcGVjdGlvblJlcG9ydHNGb3JTZXJ2aWNlUmVxdWVzdCgwLCA1MCwgdGhpcy5jdXJyZW50VXNlckRldGFpbHMucHJvZmlsZS5vcmdhbml6YXRpb25JZCwgdGhpcy5zZXJ2aWNlUmVxdWVzdFVVSUQpLnRoZW4ocmVzcG9uc2UgPT4gewogICAgICAgIHJlc3BvbnNlLmRhdGEuaW5zcGVjdGlvblJlcG9ydHMuY29udGVudC5tYXAocmVwb3J0ID0+IHsKICAgICAgICAgIHJlcG9ydC5jcmVhdGVkQXQgPSBtb21lbnQocmVwb3J0LmNyZWF0ZWRBdCkuZm9ybWF0KCJERCBNTU0sWVlZWSBoaDptbSBhIik7CiAgICAgICAgfSk7CiAgICAgICAgdGhpcy5hZGRpdGlvbmFsSW5zcGVjdGlvbiA9IHJlc3BvbnNlLmRhdGEuaW5zcGVjdGlvblJlcG9ydHMuY29udGVudDsKICAgICAgfSkuY2F0Y2goZXJyb3IgPT4gewogICAgICAgIHRoaXMuc2hvd1RvYXN0KCJGZXRjaCBBZGRpdGlvbmFsIEluc3BlY3Rpb25zIEVycm9yIiwgImVycm9yIik7CiAgICAgIH0pOwogICAgfSwKCiAgICBWaWV3SW5zcGVjdGlvbigpIHt9LAoKICAgIG9uU2VsZWN0ZWQodmFsdWUpIHsKICAgICAgaWYgKHZhbHVlLmRpc3BsYXkgPT09ICJDcmVhdGUgSXNzdWUiKSB7CiAgICAgICAgaWYgKHRoaXMuc2VydmljZVJlcXVlc3Quc3RhdHVzID09PSAibmV3IiB8fCB0aGlzLnNlcnZpY2VSZXF1ZXN0LnN0YXR1cyA9PT0gIk5ldyIpIHsKICAgICAgICAgIHRoaXMuc3VibWl0TmV3SXNzdWUgPSB0cnVlOwogICAgICAgIH0gZWxzZSB7CiAgICAgICAgICB0aGlzLnNob3dUb2FzdCgiWW91IGNhbiBvbmx5IGNyZWF0ZSBpc3N1ZSB3aXRoIG5ldyBzZXJ2aWNlIHJlcXVlc3QuIiwgImVycm9yIik7CiAgICAgICAgfQogICAgICB9IGVsc2UgaWYgKHZhbHVlLmRpc3BsYXkgPT09ICJJZ25vcmUgUmVxdWVzdCIpIHsKICAgICAgICBpZiAodGhpcy5zZXJ2aWNlUmVxdWVzdC5zdGF0dXMgPT09ICJuZXciKSB7CiAgICAgICAgICB0aGlzLklnbm9yZUlzc3VlVmFsdWUgPSB0cnVlOwogICAgICAgIH0gZWxzZSB7CiAgICAgICAgICB0aGlzLnNob3dUb2FzdCgiWW91IGNhbiBvbmx5IGlnbm9yZSBuZXcgc2VydmljZSByZXF1ZXN0LiIsICJlcnJvciIpOwogICAgICAgIH0KICAgICAgfQogICAgfSwKCiAgICBkZWxldGVBc3NldEltYWdlKHV1aWQpIHsKICAgICAgdGhpcy5sb2FkZXJGbGFnID0gdHJ1ZTsKICAgICAgSW5zcGVjdGlvblNlcnZpY2UuZGVsZXRlSXNzdWVJbWFnZSh1dWlkKS50aGVuKHJlcyA9PiB7CiAgICAgICAgaWYgKHJlcy5zdGF0dXMgPT09IDIwMCkgewogICAgICAgICAgdGhpcy5sb2FkZXJGbGFnID0gZmFsc2U7CiAgICAgICAgICB0aGlzLnNob3dUb2FzdCgiSW1hZ2UgRGVsZXRlZCBTdWNjZXNzZnVsbHkiLCAic3VjY2VzcyIpOwogICAgICAgICAgdGhpcy5nZXRTZXJ2aWNlUmVxdWVzdEJ5VVVJRCgpOwogICAgICAgIH0gZWxzZSB7CiAgICAgICAgICB0aGlzLnNob3dUb2FzdChyZXMuZGF0YS5kZXNjcmlwdGlvbiwgImVycm9yIik7CiAgICAgICAgfQogICAgICB9KS5jYXRjaChlID0+IHsKICAgICAgICB0aGlzLnNob3dUb2FzdChlLmRhdGEucmVzcG9uc2UsICJlcnJvciIpOwogICAgICAgIHRoaXMubG9hZGVyRmxhZyA9IHRydWU7CiAgICAgIH0pOwogICAgfSwKCiAgICBnZXRJc3N1ZXNCeUFzc2V0cyhhc3NldFVVSUQpIHsKICAgICAgSW5zcGVjdGlvblNlcnZpY2UuZmlsdGVySXNzdWVzQnlBc3NldFVVSUQoYXNzZXRVVUlEKS50aGVuKHJlc3BvbnNlID0+IHsKICAgICAgICBpZiAocmVzcG9uc2Uuc3RhdHVzID09PSAyMDApIHsKICAgICAgICAgIHRoaXMuaXNzdWVzID0gcmVzcG9uc2UuZGF0YS5pc3N1ZXM7CgogICAgICAgICAgZm9yIChsZXQgaXNzdWUgb2YgcmVzcG9uc2UuZGF0YS5pc3N1ZXMpIHsKICAgICAgICAgICAgdGhpcy5pc3N1ZU9wdGlvbnMucHVzaCh7CiAgICAgICAgICAgICAgbmFtZTogaXNzdWUuaXNzdWVOYW1lICsgIiwgIiArIGlzc3VlLmlzc3VlTnVtYmVyLAogICAgICAgICAgICAgIHZhbHVlOiBpc3N1ZS51dWlkCiAgICAgICAgICAgIH0pOwogICAgICAgICAgfQogICAgICAgIH0KICAgICAgfSkuY2F0Y2goZXJyb3IgPT4ge30pOwogICAgfSwKCiAgICBzaG93VG9hc3QobWVzc2FnZSwgdHlwZSkgewogICAgICB0aGlzLnRvYXN0TWVzc2FnZSA9IG1lc3NhZ2U7CiAgICAgIHRoaXMudG9hc3RUeXBlID0gdHlwZTsKICAgICAgdGhpcy50b2FzdEZsYWcrKzsKICAgIH0KCiAgfSwKCiAgY3JlYXRlZCgpIHsKICAgIGRvY3VtZW50LnRpdGxlID0gdGhpcy4kcm91dGUubWV0YS50aXRsZTsKICAgIHRoaXMuaW5zcGVjdGlvblJlcG9ydFVVSUQgPSB0aGlzLiRyb3V0ZS5wYXJhbXMuc2VydmljZVJlcXVlc3RVVUlEOwogICAgdGhpcy5jdXJyZW50VXNlckRldGFpbHMgPSBKU09OLnBhcnNlKGxvY2FsU3RvcmFnZS5nZXRJdGVtKCJjdXJyZW50VXNlckRldGFpbHMiKSk7CiAgICB0aGlzLmRpc2FibGVGaWVsZHMgPSB0aGlzLiRyb3V0ZS5wYXJhbXMuZmxhZzsKCiAgICBpZiAodGhpcy4kcm91dGUucGFyYW1zLmFzc2V0VVVJRCAhPT0gdW5kZWZpbmVkKSB7CiAgICAgIGxvY2FsU3RvcmFnZS5zZXRJdGVtKCJhc3NldFVVSUQiLCB0aGlzLiRyb3V0ZS5wYXJhbXMuYXNzZXRVVUlEKTsKICAgIH0KCiAgICBpZiAodGhpcy4kcm91dGUucGFyYW1zLmFzc2V0VVVJRCAhPT0gdW5kZWZpbmVkKSB7CiAgICAgIGxvY2FsU3RvcmFnZS5zZXRJdGVtKCJpc3N1ZVVVSUQiLCB0aGlzLiRyb3V0ZS5wYXJhbXMuaXNzdWV1dWlkKTsKICAgIH0KCiAgICB0aGlzLmFzc2V0VVVJRCA9IGxvY2FsU3RvcmFnZS5nZXRJdGVtKCJhc3NldFVVSUQiKTsKICAgIHRoaXMuaXNzdWVVVUlEID0gbG9jYWxTdG9yYWdlLmdldEl0ZW0oImlzc3VlVVVJRCIpOwogICAgdGhpcy5sb2FkZXJGbGFnID0gdHJ1ZTsKICAgIHRoaXMuZ2V0U2VydmljZVJlcXVlc3RCeVVVSUQoKTsKICB9LAoKICB2YWxpZGF0aW9uczogZnVuY3Rpb24gKCkgewogICAgcmV0dXJuIHt9OwogIH0sCiAgY29tcHV0ZWQ6IHt9Cn07"},null]}