{"remainingRequest":"/home/alsharqi/Desktop/Deploy Fe-ui/fe-erohal-ui/node_modules/babel-loader/lib/index.js!/home/alsharqi/Desktop/Deploy Fe-ui/fe-erohal-ui/node_modules/cache-loader/dist/cjs.js??ref--1-0!/home/alsharqi/Desktop/Deploy Fe-ui/fe-erohal-ui/node_modules/vue-loader/lib/index.js??vue-loader-options!/home/alsharqi/Desktop/Deploy Fe-ui/fe-erohal-ui/src/views/work-orders/CreateWorkOrder.vue?vue&type=script&lang=js&","dependencies":[{"path":"/home/alsharqi/Desktop/Deploy Fe-ui/fe-erohal-ui/src/views/work-orders/CreateWorkOrder.vue","mtime":1661968702452},{"path":"/home/alsharqi/Desktop/Deploy Fe-ui/fe-erohal-ui/babel.config.js","mtime":1661968702388},{"path":"/home/alsharqi/Desktop/Deploy Fe-ui/fe-erohal-ui/node_modules/cache-loader/dist/cjs.js","mtime":499162500000},{"path":"/home/alsharqi/Desktop/Deploy Fe-ui/fe-erohal-ui/node_modules/babel-loader/lib/index.js","mtime":315532800000},{"path":"/home/alsharqi/Desktop/Deploy Fe-ui/fe-erohal-ui/node_modules/cache-loader/dist/cjs.js","mtime":499162500000},{"path":"/home/alsharqi/Desktop/Deploy Fe-ui/fe-erohal-ui/node_modules/vue-loader/lib/index.js","mtime":1655715099000}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:aW1wb3J0IFdvcmtPcmRlclNpZGViYXIgZnJvbSAiLi4vd29yay1vcmRlcnMvY29tcG9uZW50cy9Xb3JrT3JkZXJTaWRlYmFyIjsKaW1wb3J0IEFzc2V0UGVyc29ubmVsU2VydmljZSBmcm9tICIuLi8uLi9zZXJ2aWNlcy9Bc3NldFBlcnNvbm5lbFNlcnZpY2UiOwppbXBvcnQgSW5zcGVjdGlvblNlcnZpY2UgZnJvbSAiLi4vLi4vc2VydmljZXMvSW5zcGVjdGlvblNlcnZpY2UiOwppbXBvcnQgQXNzZXRNYW5hZ2VtZW50U2VydmljZSBmcm9tICIuLi8uLi9zZXJ2aWNlcy9Bc3NldE1hbmFnZW1lbnRTZXJ2aWNlIjsKaW1wb3J0IFdvcmtPcmRlclNlcnZpY2UgZnJvbSAiLi4vLi4vc2VydmljZXMvV29ya09yZGVyU2VydmljZSI7CmltcG9ydCBtb21lbnQgZnJvbSAibW9tZW50IjsKaW1wb3J0IHsgRnVuY3Rpb25zIH0gZnJvbSAiQC9zaGFyZWQvRnVuY3Rpb25zIjsKaW1wb3J0IHsgcmVxdWlyZWQsIG1heExlbmd0aCwgbnVtZXJpYywgaW50ZWdlciB9IGZyb20gInZ1ZWxpZGF0ZS9saWIvdmFsaWRhdG9ycyI7CmltcG9ydCBsb2FkZXIgZnJvbSAiQC9jb21wb25lbnRzL0xvYWRlci52dWUiOwpleHBvcnQgZGVmYXVsdCB7CiAgbmFtZTogIkNyZWF0ZVdvcmtPcmRlciIsCiAgY29tcG9uZW50czogewogICAgV29ya09yZGVyU2lkZWJhciwKICAgIGxvYWRlcgogIH0sCgogIGRhdGEoKSB7CiAgICByZXR1cm4gewogICAgICBsb2FkZXJGbGFnOiBmYWxzZSwKCiAgICAgIC8qIFRvYXN0IFByb3BlcnRpZXMgKi8KICAgICAgdG9hc3RUaW1lT3V0OiAzMDAwLAogICAgICB0b2FzdE1lc3NhZ2U6ICIiLAogICAgICB0b2FzdFR5cGU6ICIiLAogICAgICB0b2FzdEZsYWc6IDAsCgogICAgICAvKiBUb2FzdCBQcm9wZXJ0aWVzICovCiAgICAgIHVwZGF0ZVNlbGVjdENvbXA6IDAsCiAgICAgIHRvdGFsQ29zdDogMCwKICAgICAgc2FtZTogdHJ1ZSwKICAgICAgd29ya09yZGVyU3VtbWFyeUluZGV4OiAwLAogICAgICBpbml0aWFsQXNzZXRJbmRleDogMCwKICAgICAgaW5zcGVjdGlvblJlc2V0OiAwLAogICAgICBmaW5hbEluc3BlY3Rpb25SZXNldDogMCwKICAgICAgdXNlclJlc2V0OiAwLAogICAgICBjYXRlZ29yeUluZGV4OiAwLAogICAgICBhc3NldEluZGV4OiAwLAogICAgICBpc3N1ZUluZGV4OiAwLAogICAgICBjdXJyZW50VXNlckRldGFpbHM6IG51bGwsCiAgICAgIGRpc2JhYmxlZmllbGQ6IGZhbHNlLAogICAgICBwcmlvcml0eU9wdGlvbnM6IFt7CiAgICAgICAgbGFiZWw6ICJMb3ciCiAgICAgIH0sIHsKICAgICAgICBsYWJlbDogIk1lZGl1bSIKICAgICAgfSwgewogICAgICAgIGxhYmVsOiAiSGlnaCIKICAgICAgfV0sCiAgICAgIHNoaWZ0T3B0aW9uczogW3sKICAgICAgICBsYWJlbDogIk1vcm5pbmciCiAgICAgIH0sIHsKICAgICAgICBsYWJlbDogIkFmdGVybm9vbiIKICAgICAgfSwgewogICAgICAgIGxhYmVsOiAiRXZlbmluZyIKICAgICAgfV0sCiAgICAgIHNlbGVjdGVkVXNlckdyb3VwOiAiIiwKICAgICAgdXNlckdyb3VwT3B0aW9uczogW10sCiAgICAgIHNlbGVjdGVkVXNlcjogIiIsCiAgICAgIHVzZXJPcHRpb25zOiBbXSwKICAgICAgYWxsVXNlcnM6IFtdLAogICAgICBhc3NldHM6IG51bGwsCiAgICAgIHdvcmtPcmRlclN1bW1hcnk6IHsKICAgICAgICBwcmlvcml0eTogIiIsCiAgICAgICAgc2hpZnQ6ICIiLAogICAgICAgIHNoZWR1bGU6ICIiLAogICAgICAgIHVzZXJHcm91cDogIiIsCiAgICAgICAgdXNlcjogIiIsCiAgICAgICAgaXNzdWVzOiBbXSwKICAgICAgICBpbml0aWFsSW5zcGVjdGlvblRpdGxlOiAiIiwKICAgICAgICBmaW5hbEluc3BlY3Rpb25UaXRsZTogIiIsCiAgICAgICAgY2F0ZWdvcnk6ICIiLAogICAgICAgIG5hbWU6ICIiLAogICAgICAgIHNlbGVjdGVkSW5pdGlhbEluc3BlY3Rpb25CeUFzc2V0Q2F0ZWdvcnk6ICIiLAogICAgICAgIHNlbGVjdGVkRmluYWxJbnNwZWN0aW9uQnlBc3NldENhdGVnb3J5OiAiIgogICAgICB9LAogICAgICBjaGVja0V4aXN0aW5nSW5pdGlhbEluc3BlY3Rpb246IGZhbHNlLAogICAgICBjaGVja0V4aXN0aW5nRmluYWxJbnNwZWN0aW9uOiBmYWxzZSwKICAgICAgc2FtZUFzSW5pdGlhbEluc3BlY3Rpb246IHRydWUsCiAgICAgIGluaXRpYWxJbnNwZWN0aW9uQnlBc3NldDogIiIsCiAgICAgIGluaXRpYWxJbnNwZWN0aW9uQnlBc3NldENhdGVnb3J5OiAiIiwKICAgICAgaW5pdGlhbEluc3BlY3Rpb25CeVdvcmtPcmRlcjogIiIsCiAgICAgIGZpbmFsSW5zcGVjdGlvbkJ5QXNzZXQ6ICIiLAogICAgICBmaW5hbEluc3BlY3Rpb25CeUFzc2V0Q2F0ZWdvcnk6ICIiLAogICAgICBmaW5hbEluc3BlY3Rpb25CeVdvcmtPcmRlcjogIiIsCiAgICAgIHNlbGVjdGVkSW5pdGlhbEluc3BlY3Rpb25CeUFzc2V0OiAiIiwKICAgICAgc2VsZWN0ZWRJbml0aWFsSW5zcGVjdGlvbkJ5QXNzZXRDYXRlZ29yeTogIiIsCiAgICAgIHNlbGVjdGVkSW5pdGlhbEluc3BlY3Rpb25CeVdvcmtPcmRlcjogIiIsCiAgICAgIHNlbGVjdGVkRmluYWxJbnNwZWN0aW9uQnlBc3NldDogIiIsCiAgICAgIHNlbGVjdGVkRmluYWxJbnNwZWN0aW9uQnlBc3NldENhdGVnb3J5OiAiIiwKICAgICAgc2VsZWN0ZWRGaW5hbEluc3BlY3Rpb25CeVdvcmtPcmRlcjogIiIsCiAgICAgIGluc3BlY3Rpb25CeUFzc2V0T3B0aW9uczogW10sCiAgICAgIGlucHNlY3Rpb25CeUFzc2V0Q2F0ZWdvcnlPcHRpb25zOiBbXSwKICAgICAgaW5wc2VjdGlvbkJ5V29ya09yZGVyT3B0aW9uczogW10sCiAgICAgIGluaXRpYWxJbnNwZWN0aW9uVGVtcDogIiIsCiAgICAgIGZpbmFsSW5zcGVjdGlvblRpdGxlOiAiIiwKICAgICAgYW5zd2VyVHlwZU9wdGlvbnM6IFt7CiAgICAgICAgbGFiZWw6ICJUZXh0L0ltYWdlL0F1ZGlvIiwKICAgICAgICB2YWx1ZTogImlucHV0IgogICAgICB9LCB7CiAgICAgICAgbGFiZWw6ICJZZXMvTm8iLAogICAgICAgIHZhbHVlOiAiYm9vbGVhbiIKICAgICAgfSwgewogICAgICAgIGxhYmVsOiAiTXVsdGlwbGUgQ2hvaWNlIiwKICAgICAgICB2YWx1ZTogIm11bHRpcGxlIgogICAgICB9LCB7CiAgICAgICAgbGFiZWw6ICJOdW1lcmljIiwKICAgICAgICB2YWx1ZTogIk51bWVyaWMiCiAgICAgIH1dLAogICAgICBxdWVzdGlvblR5cGVGb3JtSW5pdGlhbDogW10sCiAgICAgIHF1ZXN0aW9uVHlwZUZvcm1GaW5hbDogW10sCiAgICAgIG9yZGVySW5zdHJ1Y3Rpb25zOiBbewogICAgICAgIHZhbHVlOiAiIgogICAgICB9XSwKICAgICAgYXNzZXRDYXRlZ29yeU9wdGlvbnM6IFtdLAogICAgICBhbGxBc3NldERhdGE6IFtdLAogICAgICBhc3NldE5hbWVzOiBbXSwKICAgICAgYXNzZXRVVUlEOiAiIiwKICAgICAgaXNzdWVzQXJyYXlMaXN0OiBbXSwKICAgICAgaXNzdWVzU2VsZWN0ZWQ6IFtdLAogICAgICBmaW5hbEluc3BlY3Rpb25PcHRpb25zOiBbewogICAgICAgIGxhYmVsOiAiU2FtZSBBcyBJbml0aWFsIiwKICAgICAgICB2YWx1ZTogInNhbWUiCiAgICAgIH0sIHsKICAgICAgICBsYWJlbDogIlNlbGVjdCBFeGlzdGluZyIsCiAgICAgICAgdmFsdWU6ICJleGlzdGluZyIKICAgICAgfSwgewogICAgICAgIGxhYmVsOiAiQ3JlYXRlIE5ldyBJbnNwZWN0aW9uIFRlbXBsYXRlIiwKICAgICAgICB2YWx1ZTogImNyZWF0ZU5ldyIKICAgICAgfV0sCiAgICAgIGZpbmFsSW5zcGVjdGlvblNlbGVjdGlvbjogIlNhbWUgQXMgSW5pdGlhbCIsCiAgICAgIHF1YW50aXR5VmFsOiB0cnVlLAogICAgICBjb3N0QW1vdW50VmFsOiB0cnVlLAogICAgICB0YXhBbW91bnRWYWw6IHRydWUKICAgIH07CiAgfSwKCiAgbWV0aG9kczogewogICAgLy8gdmFsZGlhdGVEYXRlKCkgewogICAgLy8gICBsZXQgY3VycmVudERhdGUgPSBgJHtuZXcgRGF0ZSgpLmdldEZ1bGxZZWFyKCl9LSR7CiAgICAvLyAgICAgbmV3IERhdGUoKS5nZXRNb250aCgpICsgMQogICAgLy8gICB9LSR7bmV3IERhdGUoKS5nZXREYXRlKCl9YDsKICAgIC8vICAgaWYgKCFtb21lbnQodGhpcy53b3JrT3JkZXJTdW1tYXJ5LnNoZWR1bGUpLmlzU2FtZU9yQWZ0ZXIoY3VycmVudERhdGUpKSB7CiAgICAvLyAgICAgdGhpcy5zaG93VG9hc3QoIlBsZWFzZSBzZWxlY3QgY3VycmVudCBvciBmdXR1cmUgZGF0ZSIsICJlcnJvciIpOwogICAgLy8gICAgIHJldHVybiBmYWxzZTsKICAgIC8vICAgfQogICAgLy8gfSwKICAgIFF1YW50aXR5Q2hhbmdlKHZhbCkgewogICAgICBpZiAodmFsID09IDApIHsKICAgICAgICB0aGlzLnNob3dUb2FzdCgnTmVnYXRpdmUgdmFsdWUgbm90IGFsbG93ZWQnLCAiZXJyb3IiKTsKICAgICAgICB0aGlzLnF1YW50aXR5VmFsID0gdHJ1ZTsKICAgICAgfSBlbHNlIHsKICAgICAgICB0aGlzLnF1YW50aXR5VmFsID0gZmFsc2U7CiAgICAgIH0KICAgIH0sCgogICAgY29zdEFtb3VudENoYW5nZSh2YWwpIHsKICAgICAgaWYgKHZhbCA9PSAwKSB7CiAgICAgICAgdGhpcy5zaG93VG9hc3QoJ05lZ2F0aXZlIHZhbHVlIG5vdCBhbGxvd2VkJywgImVycm9yIik7CiAgICAgICAgdGhpcy5jb3N0QW1vdW50VmFsID0gdHJ1ZTsKICAgICAgfSBlbHNlIHsKICAgICAgICB0aGlzLmNvc3RBbW91bnRWYWwgPSBmYWxzZTsKICAgICAgfQogICAgfSwKCiAgICB0YXhBbW91bnRDaGFuZ2UodmFsKSB7CiAgICAgIGlmICh2YWwgPT0gMCkgewogICAgICAgIHRoaXMuc2hvd1RvYXN0KCdOZWdhdGl2ZSB2YWx1ZSBub3QgYWxsb3dlZCcsICJlcnJvciIpOwogICAgICAgIHRoaXMudGF4QW1vdW50VmFsID0gdHJ1ZTsKICAgICAgfSBlbHNlIHsKICAgICAgICB0aGlzLnRheEFtb3VudFZhbCA9IGZhbHNlOwogICAgICB9CiAgICB9LAoKICAgIGluaXRpYWxJbnNwZWN0aW9uRnVuYyh2YWx1ZSkgewogICAgICBpZiAodGhpcy5zYW1lID09PSB0cnVlKSB7CiAgICAgICAgaWYgKHRoaXMuY2hlY2tFeGlzdGluZ0luaXRpYWxJbnNwZWN0aW9uID09PSBmYWxzZSkgewogICAgICAgICAgdGhpcy53b3JrT3JkZXJTdW1tYXJ5LmZpbmFsSW5zcGVjdGlvblRpdGxlID0gdmFsdWU7CiAgICAgICAgfQogICAgICB9CgogICAgICB0aGlzLndvcmtPcmRlclN1bW1hcnlJbmRleCsrOwogICAgfSwKCiAgICBleGlzdGluZ0Z1bmN0aW9uKHZhbHVlKSB7CiAgICAgIHRoaXMud29ya09yZGVyU3VtbWFyeS5pbml0aWFsSW5zcGVjdGlvblRpdGxlID0gIiI7CiAgICAgIHRoaXMud29ya09yZGVyU3VtbWFyeS5zZWxlY3RlZEluaXRpYWxJbnNwZWN0aW9uQnlBc3NldENhdGVnb3J5ID0gIiI7CgogICAgICBpZiAodGhpcy5zYW1lID09PSB0cnVlKSB7CiAgICAgICAgdGhpcy53b3JrT3JkZXJTdW1tYXJ5LmZpbmFsSW5zcGVjdGlvblRpdGxlID0gIiI7CiAgICAgICAgdGhpcy53b3JrT3JkZXJTdW1tYXJ5LnNlbGVjdGVkRmluYWxJbnNwZWN0aW9uQnlBc3NldENhdGVnb3J5ID0gIiI7CiAgICAgIH0KCiAgICAgIGlmICh2YWx1ZSA9PT0gdHJ1ZSkgewogICAgICAgIHRoaXMucXVlc3Rpb25UeXBlRm9ybUluaXRpYWwgPSBbXTsKICAgICAgICB0aGlzLmFkZElucHV0RmllbGRzSW5pdGlhbCgpOwogICAgICB9IGVsc2UgewogICAgICAgIHRoaXMuaW5pdGlhbEluc3BlY3Rpb25CeUFzc2V0Q2F0ZWdvcnkgPSAiIjsKICAgICAgICB0aGlzLnNlbGVjdGVkSW5pdGlhbEluc3BlY3Rpb25CeUFzc2V0Q2F0ZWdvcnkgPSAiIjsKICAgICAgICB0aGlzLmluaXRpYWxBc3NldEluZGV4Kys7CiAgICAgIH0KCiAgICAgIHRoaXMud29ya09yZGVyU3VtbWFyeUluZGV4Kys7CiAgICB9LAoKICAgIGdldEN1cnJlbmN5KCkgewogICAgICBBc3NldFBlcnNvbm5lbFNlcnZpY2UuZ2V0Q29tcGFueUN1cnJlbmN5KHRoaXMuY3VycmVudFVzZXJEZXRhaWxzLnByb2ZpbGUub3JnYW5pemF0aW9uSWQpLnRoZW4ocmVzcG9uc2UgPT4gewogICAgICAgIHRoaXMuY3VycmVuY3kgPSByZXNwb25zZS5kYXRhLmN1cnJlbmN5OwogICAgICB9KTsKICAgIH0sCgogICAgZmluYWxJbnNwZWN0aW9uT3B0aW9uU2VsZWN0ZWQodmFsdWUpIHsKICAgICAgdGhpcy53b3JrT3JkZXJTdW1tYXJ5LmZpbmFsSW5zcGVjdGlvblRpdGxlID0gIiI7CiAgICAgIHRoaXMud29ya09yZGVyU3VtbWFyeS5zZWxlY3RlZEZpbmFsSW5zcGVjdGlvbkJ5QXNzZXRDYXRlZ29yeSA9ICIiOwogICAgICB0aGlzLnF1ZXN0aW9uVHlwZUZvcm1GaW5hbCA9IFtdOwogICAgICB0aGlzLmFkZElucHV0RmllbGRzRmluYWwoKTsKICAgICAgdGhpcy5maW5hbEluc3BlY3Rpb25CeUFzc2V0Q2F0ZWdvcnkgPSBbXTsKICAgICAgdGhpcy5zZWxlY3RlZEZpbmFsSW5zcGVjdGlvbkJ5QXNzZXRDYXRlZ29yeSA9ICIiOwoKICAgICAgaWYgKHZhbHVlLnZhbHVlID09PSAiU2FtZSBBcyBJbml0aWFsIikgewogICAgICAgIHRoaXMuc2FtZSA9IHRydWU7CgogICAgICAgIGlmICh0aGlzLmNoZWNrRXhpc3RpbmdJbml0aWFsSW5zcGVjdGlvbikgewogICAgICAgICAgdGhpcy53b3JrT3JkZXJTdW1tYXJ5LnNlbGVjdGVkRmluYWxJbnNwZWN0aW9uQnlBc3NldENhdGVnb3J5ID0gdGhpcy53b3JrT3JkZXJTdW1tYXJ5LnNlbGVjdGVkSW5pdGlhbEluc3BlY3Rpb25CeUFzc2V0Q2F0ZWdvcnk7CiAgICAgICAgfSBlbHNlIHsKICAgICAgICAgIHRoaXMud29ya09yZGVyU3VtbWFyeS5maW5hbEluc3BlY3Rpb25UaXRsZSA9IHRoaXMud29ya09yZGVyU3VtbWFyeS5pbml0aWFsSW5zcGVjdGlvblRpdGxlOwogICAgICAgIH0KICAgICAgfSBlbHNlIHsKICAgICAgICB0aGlzLnNhbWUgPSBmYWxzZTsKICAgICAgfQoKICAgICAgdGhpcy53b3JrT3JkZXJTdW1tYXJ5SW5kZXgrKzsKICAgIH0sCgogICAgY2xlYXJTZWxlY3RlZEZpbmFsSW5zcGVjdGlvbk9wdGlvbigpIHsKICAgICAgdGhpcy5maW5hbEluc3BlY3Rpb25TZWxlY3Rpb24gPSAiIjsKICAgICAgdGhpcy5maW5hbEluc3BlY3Rpb25SZXNldCsrOwogICAgfSwKCiAgICBvbklzc3VlTnVtYmVyU2VsZWN0KHZhbHVlKSB7CiAgICAgIHRoaXMud29ya09yZGVyU3VtbWFyeS5pc3N1ZXMgPSBbXTsKCiAgICAgIGlmICh2YWx1ZS5sZW5ndGggPiAwKSB7CiAgICAgICAgdGhpcy53b3JrT3JkZXJTdW1tYXJ5Lmlzc3VlcyA9IHZhbHVlOwogICAgICB9CiAgICB9LAoKICAgIGdldElzc3Vlc0J5QXNzZXRVVUlEKEFzc2V0VVVJRCkgewogICAgICB0aGlzLmlzc3Vlc0FycmF5TGlzdCA9IFtdOwogICAgICBJbnNwZWN0aW9uU2VydmljZS5maWx0ZXJJc3N1ZXNCeUFzc2V0VVVJRChBc3NldFVVSUQsICJyZXBvcnRlZCIpLnRoZW4ocmVzcG9uc2UgPT4gewogICAgICAgIGlmIChyZXNwb25zZS5zdGF0dXMgPT09IDIwMCkgewogICAgICAgICAgZm9yIChsZXQgaXNzdWUgb2YgcmVzcG9uc2UuZGF0YS5pc3N1ZXMpIHsKICAgICAgICAgICAgbGV0IHBhcnQgPSB7CiAgICAgICAgICAgICAgbmFtZTogIiIsCiAgICAgICAgICAgICAgdXVpZDogdGhpcy5nZW5lcmF0ZVVVSUQoKSwKICAgICAgICAgICAgICBxdWFudGl0eTogMCwKICAgICAgICAgICAgICBjb3N0OiB7CiAgICAgICAgICAgICAgICBjYXRlZ29yeTogInBhcnQtY29zdCIsCiAgICAgICAgICAgICAgICBhbW91bnQ6IDAsCiAgICAgICAgICAgICAgICB0YXhBbW91bnQ6IDAsCiAgICAgICAgICAgICAgICByZXBvcnRhYmxlOiB0cnVlCiAgICAgICAgICAgICAgfSwKICAgICAgICAgICAgICBleHRyYUNvc3Q6IFt7CiAgICAgICAgICAgICAgICBjYXRlZ29yeTogInRheC1jb3N0IiwKICAgICAgICAgICAgICAgIGFtb3VudDogMCwKICAgICAgICAgICAgICAgIHJlcG9ydGFibGU6IHRydWUKICAgICAgICAgICAgICB9XQogICAgICAgICAgICB9OwogICAgICAgICAgICBpc3N1ZS5pbnN0cnVjdGlvbkNoZWNrbGlzdCA9IEpTT04ucGFyc2UoaXNzdWUuaW5zdHJ1Y3Rpb25DaGVja2xpc3QpOwoKICAgICAgICAgICAgaWYgKGlzc3VlLmluc3RydWN0aW9uQ2hlY2tsaXN0ID09PSBudWxsKSB7CiAgICAgICAgICAgICAgaXNzdWUuaW5zdHJ1Y3Rpb25DaGVja2xpc3QgPSBbXTsKICAgICAgICAgICAgICBpc3N1ZS5pbnN0cnVjdGlvbkNoZWNrbGlzdC5wdXNoKHsKICAgICAgICAgICAgICAgIHZhbHVlOiAiIgogICAgICAgICAgICAgIH0pOwogICAgICAgICAgICB9CgogICAgICAgICAgICBpc3N1ZS5wYXJ0cyA9IFtdOwogICAgICAgICAgICBpc3N1ZS5wYXJ0cy5wdXNoKHBhcnQpOwogICAgICAgICAgICBpc3N1ZS5yZXBvcnRlZEF0ID0gbW9tZW50KGlzc3VlLnJlcG9ydGVkQXQpLmZvcm1hdCgiREQgTU1NIFlZWVkiKTsKICAgICAgICAgICAgaXNzdWUubmFtZSA9IGlzc3VlLmlzc3VlTmFtZSArICIgLSAiICsgaXNzdWUuaXNzdWVOdW1iZXI7CiAgICAgICAgICAgIHRoaXMuaXNzdWVzQXJyYXlMaXN0LnB1c2goaXNzdWUpOwogICAgICAgICAgfQogICAgICAgIH0KICAgICAgfSkuY2F0Y2goZXJyb3IgPT4gewogICAgICAgIHRoaXMuc2hvd1RvYXN0KGVycm9yLmRhdGEucmVzcG9uc2UsICJlcnJvciIpOwogICAgICB9KTsKICAgIH0sCgogICAgb25TZWxlY3RlZEFzc2V0Q2F0ZWdvcnkodmFsdWUpIHsKICAgICAgdGhpcy5hc3NldE5hbWVzID0gW107CgogICAgICBmb3IgKGxldCBhc3NldCBvZiB0aGlzLmFsbEFzc2V0RGF0YSkgewogICAgICAgIGlmIChhc3NldC5jYXRlZ29yeVVVSUQgPT09IHZhbHVlLnNlbGVjdGVkT2JqZWN0LmNhdGVnb3J5VVVJRCkgewogICAgICAgICAgdGhpcy5hc3NldE5hbWVzLnB1c2goYXNzZXQpOwogICAgICAgIH0KICAgICAgfQoKICAgICAgdGhpcy5nZXRJbnNwZWN0aW9uVGVtYXBsYXRlc0J5QXNzZXRDYXRlZ29yeSh2YWx1ZS5zZWxlY3RlZE9iamVjdC5jYXRlZ29yeVVVSUQpOwogICAgICB0aGlzLndvcmtPcmRlclN1bW1hcnkubmFtZSA9ICIiOwogICAgICB0aGlzLmFzc2V0SW5kZXgrKzsKICAgIH0sCgogICAgY2xlYXJTZWxlY3RlZEFzc2V0Q2F0ZWdvcnkoKSB7CiAgICAgIHRoaXMuYXNzZXROYW1lcyA9IFtdOwogICAgICB0aGlzLndvcmtPcmRlclN1bW1hcnkuY2F0ZWdvcnkgPSAiIjsKICAgICAgdGhpcy53b3JrT3JkZXJTdW1tYXJ5Lm5hbWUgPSAiIjsKICAgICAgdGhpcy5jYXRlZ29yeUluZGV4Kys7CiAgICAgIHRoaXMuYXNzZXRJbmRleCsrOwogICAgfSwKCiAgICBvblNlbGVjdGVkQXNzZXROYW1lKHZhbHVlKSB7CiAgICAgIHRoaXMuYXNzZXRVVUlEID0gdmFsdWUuc2VsZWN0ZWRPYmplY3QudXVpZDsKICAgICAgdGhpcy5nZXRJc3N1ZXNCeUFzc2V0VVVJRCh0aGlzLmFzc2V0VVVJRCk7CiAgICB9LAoKICAgIGNsZWFyU2VsZWN0ZWRBc3NldE5hbWUoKSB7CiAgICAgIHRoaXMuYXNzZXRVVUlEID0gIiI7CiAgICAgIHRoaXMud29ya09yZGVyU3VtbWFyeS5uYW1lID0gIiI7CiAgICAgIHRoaXMuZ2V0SXNzdWVzQnlBc3NldFVVSUQodGhpcy5hc3NldFVVSUQpOwogICAgICB0aGlzLmFzc2V0SW5kZXgrKzsKICAgIH0sCgogICAgY2xlYXJTZWxlY3RlZFByaW9yaXR5KCkgewogICAgICB0aGlzLndvcmtPcmRlclN1bW1hcnkucHJpb3JpdHkgPSAiIjsKICAgICAgdGhpcy5hc3NldEluZGV4Kys7CiAgICB9LAoKICAgIGNsZWFyU2VsZWN0ZWRTaGlmdCgpIHsKICAgICAgdGhpcy53b3JrT3JkZXJTdW1tYXJ5LnNoaWZ0ID0gIiI7CiAgICAgIHRoaXMuYXNzZXRJbmRleCsrOwogICAgfSwKCiAgICBnZXRBbGxDYXRlZ29yaWVzKGN1cnJlbnRVc2VyRGV0YWlscykgewogICAgICB0aGlzLmxvYWRlckZsYWcgPSB0cnVlOwogICAgICBBc3NldE1hbmFnZW1lbnRTZXJ2aWNlLmdldEFsbEFzc2V0Q2F0ZWdvcmllcyhjdXJyZW50VXNlckRldGFpbHMucHJvZmlsZS5vcmdhbml6YXRpb25JZCkudGhlbihyZXMgPT4gewogICAgICAgIGZvciAobGV0IGNhdGVnb3J5IG9mIHJlcy5kYXRhLmNhdGVnb3JpZXMpIHsKICAgICAgICAgIGxldCBvYmogPSB7CiAgICAgICAgICAgIGlkOiBjYXRlZ29yeS5pZCwKICAgICAgICAgICAgY2F0ZWdvcnlVVUlEOiBjYXRlZ29yeS51dWlkLAogICAgICAgICAgICBsYWJlbDogY2F0ZWdvcnkubmFtZQogICAgICAgICAgfTsKICAgICAgICAgIHRoaXMuYXNzZXRDYXRlZ29yeU9wdGlvbnMucHVzaChvYmopOwogICAgICAgIH0KCiAgICAgICAgdGhpcy5nZXRBbGxBc3NldChjdXJyZW50VXNlckRldGFpbHMpOwoKICAgICAgICBpZiAodGhpcy4kcm91dGUucGFyYW1zLndvcmt1dWlkICE9PSAiIikgewogICAgICAgICAgdGhpcy5hc3NldERldGFpbHNmcm9tU3RkKHRoaXMuJHJvdXRlLnBhcmFtcy53b3JrdXVpZCk7CiAgICAgICAgfQoKICAgICAgICB0aGlzLmxvYWRlckZsYWcgPSBmYWxzZTsKICAgICAgfSkuY2F0Y2goZXJyID0+IHsKICAgICAgICB0aGlzLnNob3dUb2FzdChlcnIuZGF0YS5yZXNwb25zZSwgImVycm9yIik7CiAgICAgIH0pOwogICAgfSwKCiAgICBnZXRBbGxBc3NldChjdXJyZW50VXNlckRldGFpbHMpIHsKICAgICAgbGV0IGNhdGVnb3J5VVVJRCA9ICIiOwogICAgICBBc3NldE1hbmFnZW1lbnRTZXJ2aWNlLmdldEFsbEFzc2V0cyhjdXJyZW50VXNlckRldGFpbHMucHJvZmlsZS5vcmdhbml6YXRpb25JZCkudGhlbihyZXMgPT4gewogICAgICAgIGZvciAobGV0IGFzc2V0IG9mIHJlcy5kYXRhLmFzc2V0cykgewogICAgICAgICAgbGV0IG9iaiA9IHsKICAgICAgICAgICAgdXVpZDogYXNzZXQudXVpZCwKICAgICAgICAgICAgY2F0ZWdvcnlVVUlEOiBhc3NldC5jYXRlZ29yeVVVSUQsCiAgICAgICAgICAgIGxhYmVsOiBhc3NldC5uYW1lLAogICAgICAgICAgICB0eXBlOiBhc3NldC50eXBlCiAgICAgICAgICB9OwogICAgICAgICAgdGhpcy5hbGxBc3NldERhdGEucHVzaChvYmopOwogICAgICAgIH0KCiAgICAgICAgaWYgKHRoaXMuJHJvdXRlLnBhcmFtcy5jcmVhdGVXb3JrT3JkZXIgPT09IHRydWUpIHsKICAgICAgICAgIGZvciAobGV0IGFzc2V0X2RhdGEgb2YgdGhpcy5hbGxBc3NldERhdGEpIHsKICAgICAgICAgICAgaWYgKHRoaXMuJHJvdXRlLnBhcmFtcy5hc3NldFVVSUQgPT09IGFzc2V0X2RhdGEudXVpZCkgewogICAgICAgICAgICAgIGNhdGVnb3J5VVVJRCA9IGFzc2V0X2RhdGEuY2F0ZWdvcnlVVUlEOwogICAgICAgICAgICB9CiAgICAgICAgICB9CgogICAgICAgICAgZm9yIChsZXQgYXNzZXRfb3B0aW9uIG9mIHRoaXMuYXNzZXRDYXRlZ29yeU9wdGlvbnMpIHsKICAgICAgICAgICAgaWYgKGFzc2V0X29wdGlvbi5jYXRlZ29yeVVVSUQgPT09IGNhdGVnb3J5VVVJRCkgewogICAgICAgICAgICAgIHRoaXMud29ya09yZGVyU3VtbWFyeS5jYXRlZ29yeSA9IGFzc2V0X29wdGlvbi5sYWJlbDsKICAgICAgICAgICAgfQogICAgICAgICAgfQoKICAgICAgICAgIGZvciAobGV0IGFzc2V0RGF0YSBvZiB0aGlzLmFsbEFzc2V0RGF0YSkgewogICAgICAgICAgICBpZiAoYXNzZXREYXRhLmNhdGVnb3J5VVVJRCA9PT0gY2F0ZWdvcnlVVUlEKSB7CiAgICAgICAgICAgICAgdGhpcy5hc3NldE5hbWVzLnB1c2goYXNzZXREYXRhKTsKICAgICAgICAgICAgfQogICAgICAgICAgfQoKICAgICAgICAgIGZvciAobGV0IGFzc2V0X25hbWUgb2YgdGhpcy5hc3NldE5hbWVzKSB7CiAgICAgICAgICAgIGlmIChhc3NldF9uYW1lLnV1aWQgPT09IHRoaXMuJHJvdXRlLnBhcmFtcy5hc3NldFVVSUQpIHsKICAgICAgICAgICAgICB0aGlzLndvcmtPcmRlclN1bW1hcnkubmFtZSA9IGFzc2V0X25hbWUubGFiZWw7CiAgICAgICAgICAgIH0KICAgICAgICAgIH0KCiAgICAgICAgICB0aGlzLmNhdGVnb3J5SW5kZXgrKzsKICAgICAgICAgIHRoaXMuYXNzZXRJbmRleCsrOwogICAgICAgIH0KICAgICAgfSkuY2F0Y2goZXJyID0+IHsKICAgICAgICB0aGlzLnNob3dUb2FzdChlcnIuZGF0YS5yZXNwb25zZSwgImVycm9yIik7CiAgICAgIH0pOwogICAgfSwKCiAgICBiYXNpY0RldGFpbHNBY2NvcmRpb25GdW5jdGlvbigpIHsKICAgICAgaWYgKHRoaXMuJHJlZnMuYmFzaWNEZXRhaWxzQWNjb3JkaW9uLm9wZW5GbGFnID09PSB0cnVlKSB7CiAgICAgICAgdGhpcy4kcmVmcy5maW5hbEluc3BlY3Rpb25zQWNjb3JkaW9uLm9wZW5GbGFnID0gZmFsc2U7CiAgICAgICAgdGhpcy4kcmVmcy51c2VyQXNzaWdubWVudEFjY29yZGlvbi5vcGVuRmxhZyA9IGZhbHNlOwogICAgICAgIHRoaXMuJHJlZnMuaXNzdWVzQWNjb3JkaW9uLm9wZW5GbGFnID0gZmFsc2U7CiAgICAgICAgdGhpcy4kcmVmcy5pbnNwZWN0aW9uc0FjY29yZGlvbi5vcGVuRmxhZyA9IGZhbHNlOwogICAgICB9CiAgICB9LAoKICAgIHVzZXJBc3NpZ25tZW50QWNjb3JkaW9uRnVuY3Rpb24oKSB7CiAgICAgIGlmICh0aGlzLiRyZWZzLnVzZXJBc3NpZ25tZW50QWNjb3JkaW9uLm9wZW5GbGFnID09PSB0cnVlKSB7CiAgICAgICAgdGhpcy4kcmVmcy5iYXNpY0RldGFpbHNBY2NvcmRpb24ub3BlbkZsYWcgPSBmYWxzZTsKICAgICAgICB0aGlzLiRyZWZzLmlzc3Vlc0FjY29yZGlvbi5vcGVuRmxhZyA9IGZhbHNlOwogICAgICAgIHRoaXMuJHJlZnMuaW5zcGVjdGlvbnNBY2NvcmRpb24ub3BlbkZsYWcgPSBmYWxzZTsKICAgICAgICB0aGlzLiRyZWZzLmZpbmFsSW5zcGVjdGlvbnNBY2NvcmRpb24ub3BlbkZsYWcgPSBmYWxzZTsKICAgICAgfQogICAgfSwKCiAgICBpc3N1ZXNBY2NvcmRpb25GdW5jdGlvbigpIHsKICAgICAgaWYgKHRoaXMuJHJlZnMuaXNzdWVzQWNjb3JkaW9uLm9wZW5GbGFnID09PSB0cnVlKSB7CiAgICAgICAgdGhpcy4kcmVmcy5iYXNpY0RldGFpbHNBY2NvcmRpb24ub3BlbkZsYWcgPSBmYWxzZTsKICAgICAgICB0aGlzLiRyZWZzLnVzZXJBc3NpZ25tZW50QWNjb3JkaW9uLm9wZW5GbGFnID0gZmFsc2U7CiAgICAgICAgdGhpcy4kcmVmcy5pbnNwZWN0aW9uc0FjY29yZGlvbi5vcGVuRmxhZyA9IGZhbHNlOwogICAgICAgIHRoaXMuJHJlZnMuZmluYWxJbnNwZWN0aW9uc0FjY29yZGlvbi5vcGVuRmxhZyA9IGZhbHNlOwogICAgICB9CiAgICB9LAoKICAgIGluc3BlY3Rpb25zQWNjb3JkaW9uRnVuY3Rpb24oKSB7CiAgICAgIGlmICh0aGlzLiRyZWZzLmluc3BlY3Rpb25zQWNjb3JkaW9uLm9wZW5GbGFnID09PSB0cnVlKSB7CiAgICAgICAgdGhpcy4kcmVmcy5iYXNpY0RldGFpbHNBY2NvcmRpb24ub3BlbkZsYWcgPSBmYWxzZTsKICAgICAgICB0aGlzLiRyZWZzLnVzZXJBc3NpZ25tZW50QWNjb3JkaW9uLm9wZW5GbGFnID0gZmFsc2U7CiAgICAgICAgdGhpcy4kcmVmcy5pc3N1ZXNBY2NvcmRpb24ub3BlbkZsYWcgPSBmYWxzZTsKICAgICAgICB0aGlzLiRyZWZzLmZpbmFsSW5zcGVjdGlvbnNBY2NvcmRpb24ub3BlbkZsYWcgPSBmYWxzZTsKICAgICAgfQogICAgfSwKCiAgICBmaW5hbEluc3BlY3Rpb25zQWNjb3JkaW9uRnVuY3Rpb24oKSB7CiAgICAgIGlmICh0aGlzLiRyZWZzLmZpbmFsSW5zcGVjdGlvbnNBY2NvcmRpb24ub3BlbkZsYWcgPT09IHRydWUpIHsKICAgICAgICB0aGlzLiRyZWZzLmJhc2ljRGV0YWlsc0FjY29yZGlvbi5vcGVuRmxhZyA9IGZhbHNlOwogICAgICAgIHRoaXMuJHJlZnMudXNlckFzc2lnbm1lbnRBY2NvcmRpb24ub3BlbkZsYWcgPSBmYWxzZTsKICAgICAgICB0aGlzLiRyZWZzLmlzc3Vlc0FjY29yZGlvbi5vcGVuRmxhZyA9IGZhbHNlOwogICAgICAgIHRoaXMuJHJlZnMuaW5zcGVjdGlvbnNBY2NvcmRpb24ub3BlbkZsYWcgPSBmYWxzZTsKICAgICAgfQogICAgfSwKCiAgICBjcmVhdGVXb3JrT3JkZXIoKSB7CiAgICAgIHRoaXMuJHYuJHRvdWNoKCk7CgogICAgICBpZiAodGhpcy4kdi4kaW52YWxpZCkgewogICAgICAgIHRoaXMuc2hvd1RvYXN0KCJQbGVhc2UgZmlsbCBhbGwgcmVxdWlyZWQgZmllbGRzIiwgIndhcm5pbmciKTsKICAgICAgICByZXR1cm47CiAgICAgIH0KCiAgICAgIGlmICh0aGlzLmlzc3Vlc1NlbGVjdGVkLmxlbmdodCA8IDApIHsKICAgICAgICB0aGlzLnNob3dUb2FzdCgiUGxlYXNlIHNlbGVjdCBhbiBpc3N1ZSIsICJ3YXJuaW5nIik7CiAgICAgICAgcmV0dXJuOwogICAgICB9CgogICAgICB0aGlzLmxvYWRlckZsYWcgPSB0cnVlOwogICAgICBsZXQgd29ya09yZGVyID0ge307CiAgICAgIGxldCByZXNvbHV0aW9ucyA9IFtdOwogICAgICBsZXQgaXNzdWVzID0gW107CiAgICAgIGxldCB0ZW1wT3JkZXIgPSBbXTsKICAgICAgbGV0IG9yZGVySnNvbiA9IG51bGw7CiAgICAgIGxldCBpbml0aWFsSW5zcGVjdGlvblRlbXBsYXRlID0gbnVsbDsKICAgICAgbGV0IGZpbmFsSW5zcGVjdGlvblRlbXBsYXRlID0gbnVsbDsKICAgICAgbGV0IGZyb21JbnNwZWN0aW9uSW5pdGlhbCA9IGZhbHNlOwogICAgICBsZXQgZnJvbUluc3BlY3Rpb25GaW5hbCA9IGZhbHNlOwogICAgICBsZXQgaW5pdGlhbEluc3BlY3Rpb25PcHRpb24gPSBudWxsOwogICAgICBsZXQgZmluYWxJbnNwZWN0aW9uT3B0aW9uID0gbnVsbDsKICAgICAgdmFyIGluaXRpYWxJbnNwZWN0aW9uVGVtcGxhdGVMaW5raW5nVVVJRCA9IG51bGw7CiAgICAgIGxldCBmaW5hbEluc3BlY3Rpb25UZW1wbGF0ZUxpbmtpbmdVVUlEID0gbnVsbDsKICAgICAgbGV0IGluaXRpYWxMaW5rSW5zcGVjdGlvblR5cGUgPSBudWxsOwogICAgICBsZXQgZmluYWxMaW5rSW5zcGVjdGlvblR5cGUgPSBudWxsOwogICAgICBsZXQgY3JlYXRlV29ya09yZGVyUmVxdWVzdCA9IHt9OwoKICAgICAgZm9yIChsZXQgd29ya19vcmRlcl9pc3N1ZSBvZiB0aGlzLndvcmtPcmRlclN1bW1hcnkuaXNzdWVzKSB7CiAgICAgICAgbGV0IGlzc3VlID0ge307CiAgICAgICAgbGV0IHJlc29sdXRpb24gPSB7fTsKICAgICAgICByZXNvbHV0aW9uLnV1aWQgPSB0aGlzLmdlbmVyYXRlVVVJRCgpOwogICAgICAgIHJlc29sdXRpb24ucGFydHNVc2VkID0gW107CiAgICAgICAgd29ya19vcmRlcl9pc3N1ZS5wYXJ0cy5tYXAocGFydCA9PiB7CiAgICAgICAgICBsZXQgcGFydE9iamVjdCA9IHBhcnQ7CiAgICAgICAgICBwYXJ0T2JqZWN0LnBhcnROYW1lID0gcGFydC5uYW1lOwogICAgICAgICAgcGFydE9iamVjdC5pc3N1ZVVVSUQgPSB3b3JrX29yZGVyX2lzc3VlLnV1aWQ7CiAgICAgICAgICBwYXJ0T2JqZWN0LnBhcnRVVUlEID0gImR1bW15LXBhcnQtdXVpZC1saW5rLXdpdGgtaW52ZW50b3J5IjsKICAgICAgICAgIHBhcnRPYmplY3QuYWRkZWRCeVVzZXJOYW1lID0gdGhpcy5jdXJyZW50VXNlckRldGFpbHMucHJvZmlsZS5maXJzdE5hbWUgKyAiICIgKyB0aGlzLmN1cnJlbnRVc2VyRGV0YWlscy5wcm9maWxlLmxhc3ROYW1lOwogICAgICAgICAgcGFydE9iamVjdC5hZGRlZEJ5VXNlclVVSUQgPSB0aGlzLmN1cnJlbnRVc2VyRGV0YWlscy5wcm9maWxlLnVzZXJpZDsKICAgICAgICAgIHBhcnRPYmplY3QuY29zdC5hZGVkQnlVc2VyTmFtZSA9IHBhcnRPYmplY3QuYWRkZWRCeVVzZXJOYW1lOwogICAgICAgICAgcGFydE9iamVjdC5jb3N0LmFkZGVkQnlVc2VyVVVJRCA9IHBhcnRPYmplY3QuYWRkZWRCeVVzZXJVVUlEOwogICAgICAgICAgcGFydE9iamVjdC5jb3N0Lmlzc3VlVVVJRCA9IHdvcmtfb3JkZXJfaXNzdWUudXVpZDsKICAgICAgICAgIHJlc29sdXRpb24ucGFydHNVc2VkLnB1c2gocGFydE9iamVjdCk7CiAgICAgICAgICByZXR1cm4gcGFydDsKICAgICAgICB9KTsKICAgICAgICByZXNvbHV0aW9ucy5wdXNoKHJlc29sdXRpb24pOwogICAgICAgIGlzc3VlLmlzc3VlTnVtYmVyID0gd29ya19vcmRlcl9pc3N1ZS5pc3N1ZU51bWJlcjsKICAgICAgICBpc3N1ZS5pc3N1ZVVVSUQgPSB3b3JrX29yZGVyX2lzc3VlLnV1aWQ7CiAgICAgICAgaXNzdWUucmVzb2x2ZWQgPSBmYWxzZTsKICAgICAgICBpc3N1ZS5pbnNwZWN0aW9uVVVJRCA9IHdvcmtfb3JkZXJfaXNzdWUuaW5zcGVjdGlvblVVSUQ7CiAgICAgICAgaXNzdWUuc2VydmljZVVVSUQgPSB3b3JrX29yZGVyX2lzc3VlLnNlcnZpY2VVVUlEOwogICAgICAgIGlzc3VlLmluc3RydWN0aW9ucyA9IHdvcmtfb3JkZXJfaXNzdWUuaXNzdWVEZXNjcmlwdGlvbjsKICAgICAgICBpc3N1ZS5yZXNvbHV0aW9uVVVJRCA9IHJlc29sdXRpb24udXVpZDsKICAgICAgICBpc3N1ZS5zdGF0dXMgPSB3b3JrX29yZGVyX2lzc3VlLnN0YXR1czsKICAgICAgICB3b3JrX29yZGVyX2lzc3VlLmluc3RydWN0aW9uQ2hlY2tsaXN0Lm1hcChlbGVtZW50ID0+IHsKICAgICAgICAgIHRlbXBPcmRlci5wdXNoKHsKICAgICAgICAgICAgbmFtZTogZWxlbWVudC52YWx1ZSwKICAgICAgICAgICAgY2hlY2tlZDogZmFsc2UKICAgICAgICAgIH0pOwogICAgICAgICAgb3JkZXJKc29uID0gSlNPTi5zdHJpbmdpZnkodGVtcE9yZGVyKTsKICAgICAgICAgIGlzc3VlLm9yZGVySW5zdHJ1Y3Rpb25zID0gb3JkZXJKc29uOwogICAgICAgIH0pOwogICAgICAgIGlzc3Vlcy5wdXNoKGlzc3VlKTsKICAgICAgICBvcmRlckpzb24gPSBudWxsOwogICAgICAgIHRlbXBPcmRlciA9IFtdOwogICAgICB9CgogICAgICBpZiAodGhpcy5jaGVja0V4aXN0aW5nSW5pdGlhbEluc3BlY3Rpb24gPT09IHRydWUpIHsKICAgICAgICBpZiAodGhpcy5zZWxlY3RlZEluaXRpYWxJbnNwZWN0aW9uQnlBc3NldENhdGVnb3J5ICE9PSAiIikgewogICAgICAgICAgaW5pdGlhbExpbmtJbnNwZWN0aW9uVHlwZSA9ICJpbnNwZWN0aW9uIjsKICAgICAgICB9CiAgICAgIH0KCiAgICAgIGlmICh0aGlzLmZpbmFsSW5zcGVjdGlvblNlbGVjdGlvbiA9PT0gIlNlbGVjdCBFeGlzdGluZyIpIHsKICAgICAgICBpZiAodGhpcy5zZWxlY3RlZEZpbmFsSW5zcGVjdGlvbkJ5QXNzZXRDYXRlZ29yeSAhPT0gIiIpIHsKICAgICAgICAgIGZpbmFsTGlua0luc3BlY3Rpb25UeXBlID0gImluc3BlY3Rpb24iOwogICAgICAgIH0KICAgICAgfQoKICAgICAgaWYgKHRoaXMucXVlc3Rpb25UeXBlRm9ybUluaXRpYWwubGVuZ3RoID4gMCkgewogICAgICAgIGluaXRpYWxJbnNwZWN0aW9uVGVtcGxhdGUgPSB7CiAgICAgICAgICBuYW1lOiB0aGlzLndvcmtPcmRlclN1bW1hcnkuaW5pdGlhbEluc3BlY3Rpb25UaXRsZSwKICAgICAgICAgIGluc3BlY3Rpb25JdGVtczogdGhpcy5xdWVzdGlvblR5cGVGb3JtSW5pdGlhbAogICAgICAgIH07CiAgICAgICAgaW5pdGlhbEluc3BlY3Rpb25PcHRpb24gPSAic2F2ZSI7CiAgICAgICAgZnJvbUluc3BlY3Rpb25Jbml0aWFsID0gZmFsc2U7CiAgICAgIH0gZWxzZSB7CiAgICAgICAgZnJvbUluc3BlY3Rpb25Jbml0aWFsID0gdHJ1ZTsKICAgICAgfSAvLyBpZiAoaW5pdGlhbEluc3BlY3Rpb25UZW1wbGF0ZSkgewogICAgICAvLyAJLy8JZmluYWxJbnNwZWN0aW9uVGVtcGxhdGUgPSBpbml0aWFsSW5zcGVjdGlvblRlbXBsYXRlOwogICAgICAvLyB9IGVsc2UgewogICAgICAvLyAJZnJvbUluc3BlY3Rpb25GaW5hbCA9IGZyb21JbnNwZWN0aW9uSW5pdGlhbDsKICAgICAgLy8gfQogICAgICAvLyBmaW5hbEluc3BlY3Rpb25PcHRpb24gPSBpbml0aWFsSW5zcGVjdGlvbk9wdGlvbjsKCgogICAgICBpZiAodGhpcy5xdWVzdGlvblR5cGVGb3JtRmluYWwubGVuZ3RoID4gMCkgewogICAgICAgIGZpbmFsSW5zcGVjdGlvblRlbXBsYXRlID0gewogICAgICAgICAgbmFtZTogdGhpcy53b3JrT3JkZXJTdW1tYXJ5LmZpbmFsSW5zcGVjdGlvblRpdGxlLAogICAgICAgICAgaW5zcGVjdGlvbkl0ZW1zOiB0aGlzLnF1ZXN0aW9uVHlwZUZvcm1GaW5hbAogICAgICAgIH07CiAgICAgICAgZmluYWxJbnNwZWN0aW9uT3B0aW9uID0gInNhdmUiOwogICAgICAgIGZyb21JbnNwZWN0aW9uRmluYWwgPSBmYWxzZTsKICAgICAgfSBlbHNlIHsKICAgICAgICBmcm9tSW5zcGVjdGlvbkZpbmFsID0gdHJ1ZTsKICAgICAgfQoKICAgICAgd29ya09yZGVyLnBsYW5uaW5nID0gewogICAgICAgIHVzZXJHcm91cFVVSUQ6IHRoaXMuc2VsZWN0ZWRVc2VyR3JvdXAgPyB0aGlzLnNlbGVjdGVkVXNlckdyb3VwLmdyb3VwVVVJRCA6IG51bGwsCiAgICAgICAgdXNlckdyb3VwTmFtZTogdGhpcy5zZWxlY3RlZFVzZXJHcm91cCA/IHRoaXMuc2VsZWN0ZWRVc2VyR3JvdXAuZ3JvdXBOYW1lIDogbnVsbCwKICAgICAgICBmcm9tSW5zcGVjdGlvbkluaXRpYWw6IGZyb21JbnNwZWN0aW9uSW5pdGlhbCwKICAgICAgICBmcm9tSW5zcGVjdGlvbkZpbmFsOiBmcm9tSW5zcGVjdGlvbkZpbmFsCiAgICAgIH07CgogICAgICBpZiAodGhpcy5zYW1lQXNJbml0aWFsSW5zcGVjdGlvbikgewogICAgICAgIHdvcmtPcmRlci5wbGFubmluZy5zYW1lSW5zcGVjdGlvbiA9IHRydWU7CiAgICAgIH0KCiAgICAgIGlmICh3b3JrT3JkZXIucGxhbm5pbmcuZnJvbUluc3BlY3Rpb25Jbml0aWFsKSB7CiAgICAgICAgaWYgKHRoaXMuc2VsZWN0ZWRJbml0aWFsSW5zcGVjdGlvbkJ5QXNzZXQgIT09IG51bGwpIHsKICAgICAgICAgIHdvcmtPcmRlci5wbGFubmluZy5pbml0aWFsSW5zcGVjdGlvblVVSUQgPSB0aGlzLnNlbGVjdGVkSW5pdGlhbEluc3BlY3Rpb25CeUFzc2V0LnZhbHVlOwogICAgICAgIH0gZWxzZSBpZiAodGhpcy5zZWxlY3RlZEluaXRpYWxJbnNwZWN0aW9uQnlBc3NldENhdGVnb3J5ICE9PSBudWxsKSB7CiAgICAgICAgICB3b3JrT3JkZXIucGxhbm5pbmcuaW5pdGlhbEluc3BlY3Rpb25VVUlEID0gdGhpcy5zZWxlY3RlZEluaXRpYWxJbnNwZWN0aW9uQnlBc3NldENhdGVnb3J5LnZhbHVlOwogICAgICAgIH0gZWxzZSB7CiAgICAgICAgICB3b3JrT3JkZXIucGxhbm5pbmcuaW5pdGlhbEluc3BlY3Rpb25VVUlEID0gdGhpcy5zZWxlY3RlZEZpbmFsSW5zcGVjdGlvbkJ5V29ya09yZGVyLnZhbHVlOwogICAgICAgIH0KICAgICAgfQoKICAgICAgaWYgKHdvcmtPcmRlci5wbGFubmluZy5mcm9tSW5zcGVjdGlvbkZpbmFsKSB7CiAgICAgICAgaWYgKHRoaXMuc2FtZUFzSW5pdGlhbEluc3BlY3Rpb24pIHsKICAgICAgICAgIHdvcmtPcmRlci5wbGFubmluZy5maW5hbEluc3BlY3Rpb25VVUlEID0gd29ya09yZGVyLnBsYW5uaW5nLmluaXRpYWxJbnNwZWN0aW9uVVVJRDsKICAgICAgICB9IGVsc2UgewogICAgICAgICAgaWYgKHRoaXMuc2VsZWN0ZWRGaW5hbEluc3BlY3Rpb25CeUFzc2V0ICE9PSBudWxsKSB7CiAgICAgICAgICAgIHdvcmtPcmRlci5wbGFubmluZy5maW5hbEluc3BlY3Rpb25VVUlEID0gdGhpcy5zZWxlY3RlZEZpbmFsSW5zcGVjdGlvbkJ5QXNzZXQudmFsdWU7CiAgICAgICAgICB9IGVsc2UgaWYgKHRoaXMuc2VsZWN0ZWRGaW5hbEluc3BlY3Rpb25CeUFzc2V0Q2F0ZWdvcnkgIT09IG51bGwpIHsKICAgICAgICAgICAgd29ya09yZGVyLnBsYW5uaW5nLmZpbmFsSW5zcGVjdGlvblVVSUQgPSB0aGlzLnNlbGVjdGVkRmluYWxJbnNwZWN0aW9uQnlBc3NldENhdGVnb3J5LnZhbHVlOwogICAgICAgICAgfSBlbHNlIHsKICAgICAgICAgICAgd29ya09yZGVyLnBsYW5uaW5nLmZpbmFsSW5zcGVjdGlvblVVSUQgPSB0aGlzLnNlbGVjdGVkRmluYWxJbnNwZWN0aW9uQnlXb3JrT3JkZXIudmFsdWU7CiAgICAgICAgICB9CiAgICAgICAgfQogICAgICB9CgogICAgICBpZiAodGhpcy5jaGVja0V4aXN0aW5nSW5pdGlhbEluc3BlY3Rpb24pIHsKICAgICAgICB3b3JrT3JkZXIucGxhbm5pbmcuZnJvbUV4aXN0aW5nSW5pdGlhbCA9IHRydWU7CiAgICAgICAgd29ya09yZGVyLnBsYW5uaW5nLmZyb21JbnNwZWN0aW9uSW5pdGlhbCA9IGZhbHNlOwogICAgICAgIHdvcmtPcmRlci5wbGFubmluZy5pbml0aWFsSW5zcGVjdGlvblVVSUQgPSB0aGlzLmluaXRpYWxJbnNwZWN0aW9uVGVtcC51dWlkOwogICAgICB9IGVsc2UgewogICAgICAgIHdvcmtPcmRlci5wbGFubmluZy5pbml0aWFsSW5zcGVjdGlvblVVSUQgPSBudWxsOwogICAgICB9CgogICAgICBpZiAodGhpcy5maW5hbEluc3BlY3Rpb25TZWxlY3Rpb24gPT09ICJTZWxlY3QgRXhpc3RpbmciKSB7CiAgICAgICAgd29ya09yZGVyLnBsYW5uaW5nLmZyb21FeGlzdGluZ0ZpbmFsID0gdHJ1ZTsKICAgICAgICB3b3JrT3JkZXIucGxhbm5pbmcuZnJvbUluc3BlY3Rpb25Jbml0aWFsID0gZmFsc2U7CiAgICAgICAgd29ya09yZGVyLnBsYW5uaW5nLmZpbmFsSW5zcGVjdGlvblVVSUQgPSB0aGlzLnNlbGVjdGVkRmluYWxJbnNwZWN0aW9uQnlBc3NldENhdGVnb3J5LnV1aWQ7CiAgICAgIH0gZWxzZSB7CiAgICAgICAgd29ya09yZGVyLnBsYW5uaW5nLmZpbmFsSW5zcGVjdGlvblVVSUQgPSBudWxsOwogICAgICB9CgogICAgICBpZiAodGhpcy5maW5hbEluc3BlY3Rpb25TZWxlY3Rpb24gPT09ICJTYW1lIEFzIEluaXRpYWwiICYmIHRoaXMuY2hlY2tFeGlzdGluZ0luaXRpYWxJbnNwZWN0aW9uID09IHRydWUpIHsKICAgICAgICB3b3JrT3JkZXIucGxhbm5pbmcuZmluYWxJbnNwZWN0aW9uVVVJRCA9IHRoaXMuaW5pdGlhbEluc3BlY3Rpb25UZW1wLnV1aWQ7CiAgICAgICAgd29ya09yZGVyLnBsYW5uaW5nLmZyb21FeGlzdGluZ0ZpbmFsID0gdHJ1ZTsKICAgICAgfQoKICAgICAgaWYgKHdvcmtPcmRlci5wbGFubmluZy5pbml0aWFsSW5zcGVjdGlvblVVSUQgPT09IHdvcmtPcmRlci5wbGFubmluZy5maW5hbEluc3BlY3Rpb25VVUlEKSB7CiAgICAgICAgd29ya09yZGVyLnBsYW5uaW5nLnNhbWVJbnNwZWN0aW9uID0gdHJ1ZTsKICAgICAgfSBlbHNlIGlmICh3b3JrT3JkZXIucGxhbm5pbmcuaW5pdGlhbEluc3BlY3Rpb25VVUlEID09IG51bGwgfHwgd29ya09yZGVyLnBsYW5uaW5nLmZpbmFsSW5zcGVjdGlvblVVSUQgPT0gbnVsbCkgewogICAgICAgIHdvcmtPcmRlci5wbGFubmluZy5zYW1lSW5zcGVjdGlvbiA9IGZhbHNlOwogICAgICB9CgogICAgICBpZiAodGhpcy5zZWxlY3RlZFVzZXIpIHsKICAgICAgICB3b3JrT3JkZXIuYXNzaWduZWRUb1VzZXJOYW1lID0gdGhpcy5zZWxlY3RlZFVzZXIubmFtZTsKICAgICAgICB3b3JrT3JkZXIuYXNzaWduZWRUb1VzZXJVVUlEID0gdGhpcy5zZWxlY3RlZFVzZXIudXVpZDsKICAgICAgfQoKICAgICAgaWYgKHdvcmtPcmRlci5hc3NpZ25lZFRvVXNlck5hbWUpIHsKICAgICAgICB3b3JrT3JkZXIuYXNzaWduZWVzID0gW3sKICAgICAgICAgIHV1aWQ6IHdvcmtPcmRlci5hc3NpZ25lZFRvVXNlclVVSUQsCiAgICAgICAgICBuYW1lOiB3b3JrT3JkZXIuYXNzaWduZWRUb1VzZXJOYW1lCiAgICAgICAgfV07CiAgICAgIH0gZWxzZSB7CiAgICAgICAgbGV0IHJlc3BvbnNlID0gQXNzZXRQZXJzb25uZWxTZXJ2aWNlLmdldFVzZXJHcm91cEJ5VVVJRCh0aGlzLnNlbGVjdGVkVXNlckdyb3VwLnNlbGVjdGVkT2JqZWN0Lmdyb3VwVVVJRCk7CgogICAgICAgIGlmIChyZXNwb25zZS5zdGF0dXMgPT09IDIwMCkgewogICAgICAgICAgd29ya09yZGVyLmFzc2lnbmVlcyA9IFtdOwogICAgICAgICAgcmVzcG9uc2UuZGF0YS51c2VyR3JvdXAudXNlcnMubWFwKHVzZXIgPT4gewogICAgICAgICAgICB3b3JrT3JkZXIuYXNzaWduZWVzLnB1c2goewogICAgICAgICAgICAgIHV1aWQ6IHVzZXIudXVpZCwKICAgICAgICAgICAgICBuYW1lOiB1c2VyLmZpcnN0TmFtZSArICIgIiArIHVzZXIubGFzdE5hbWUKICAgICAgICAgICAgfSk7CiAgICAgICAgICAgIHJldHVybiB1c2VyOwogICAgICAgICAgfSk7CiAgICAgICAgfQogICAgICB9CgogICAgICB3b3JrT3JkZXIucHJpb3JpdHkgPSB0aGlzLndvcmtPcmRlclN1bW1hcnkucHJpb3JpdHk7CiAgICAgIHdvcmtPcmRlci5zY2hlZHVsZSA9IG1vbWVudCh0aGlzLndvcmtPcmRlclN1bW1hcnkuc2hlZHVsZSk7CiAgICAgIHdvcmtPcmRlci5hc3NldFVVSUQgPSB0aGlzLndvcmtPcmRlclN1bW1hcnkuaXNzdWVzWzBdLmFzc2V0VVVJRDsKICAgICAgd29ya09yZGVyLmFzc2V0TmFtZSA9IHRoaXMud29ya09yZGVyU3VtbWFyeS5uYW1lOwogICAgICB3b3JrT3JkZXIudGVuYW50VVVJRCA9IHRoaXMuY3VycmVudFVzZXJEZXRhaWxzLnByb2ZpbGUub3JnYW5pemF0aW9uSWQ7CiAgICAgIHdvcmtPcmRlci5zdGF0dXMgPSB0aGlzLndvcmtPcmRlclN1bW1hcnkuaXNzdWVzWzBdLnN0YXR1czsKICAgICAgd29ya09yZGVyLnNoaWZ0ID0gdGhpcy53b3JrT3JkZXJTdW1tYXJ5LnNoaWZ0OwogICAgICB3b3JrT3JkZXIuaXNzdWVzID0gaXNzdWVzOwogICAgICBjcmVhdGVXb3JrT3JkZXJSZXF1ZXN0LndvcmtPcmRlciA9IHdvcmtPcmRlcjsKCiAgICAgIGlmICh0aGlzLmNoZWNrRXhpc3RpbmdJbml0aWFsSW5zcGVjdGlvbiA9PT0gdHJ1ZSkgewogICAgICAgIGNyZWF0ZVdvcmtPcmRlclJlcXVlc3QuaW5pdGlhbEluc3BlY3Rpb25UZW1wbGF0ZSA9IG51bGw7CiAgICAgIH0gZWxzZSB7CiAgICAgICAgY3JlYXRlV29ya09yZGVyUmVxdWVzdC5pbml0aWFsSW5zcGVjdGlvblRlbXBsYXRlID0gaW5pdGlhbEluc3BlY3Rpb25UZW1wbGF0ZTsKICAgICAgICB3b3JrT3JkZXIucGxhbm5pbmcuZnJvbUV4aXN0aW5nSW5pdGlhbCA9IGZhbHNlOwogICAgICAgIHdvcmtPcmRlci5wbGFubmluZy5mcm9tSW5zcGVjdGlvbkluaXRpYWwgPSBmYWxzZTsKICAgICAgfQoKICAgICAgaWYgKHRoaXMuZmluYWxJbnNwZWN0aW9uU2VsZWN0aW9uID09PSAiQ3JlYXRlIE5ldyBJbnNwZWN0aW9uIFRlbXBsYXRlIikgewogICAgICAgIGNyZWF0ZVdvcmtPcmRlclJlcXVlc3QuZmluYWxJbnNwZWN0aW9uVGVtcGxhdGUgPSBmaW5hbEluc3BlY3Rpb25UZW1wbGF0ZTsKICAgICAgICB3b3JrT3JkZXIucGxhbm5pbmcuZnJvbUV4aXN0aW5nRmluYWwgPSBmYWxzZTsKICAgICAgICB3b3JrT3JkZXIucGxhbm5pbmcuZnJvbUluc3BlY3Rpb25GaW5hbCA9IGZhbHNlOwogICAgICAgIHdvcmtPcmRlci5wbGFubmluZy5zYW1lSW5zcGVjdGlvbiA9IGZhbHNlOwogICAgICB9IGVsc2UgaWYgKHRoaXMuZmluYWxJbnNwZWN0aW9uU2VsZWN0aW9uID09PSAiU2FtZSBBcyBJbml0aWFsIiAmJiB0aGlzLmNoZWNrRXhpc3RpbmdJbml0aWFsSW5zcGVjdGlvbiAhPT0gdHJ1ZSkgewogICAgICAgIGNyZWF0ZVdvcmtPcmRlclJlcXVlc3QuZmluYWxJbnNwZWN0aW9uVGVtcGxhdGUgPSBpbml0aWFsSW5zcGVjdGlvblRlbXBsYXRlOwogICAgICAgIHdvcmtPcmRlci5wbGFubmluZy5mcm9tRXhpc3RpbmdGaW5hbCA9IHdvcmtPcmRlci5wbGFubmluZy5mcm9tRXhpc3RpbmdJbml0aWFsOwogICAgICAgIHdvcmtPcmRlci5wbGFubmluZy5mcm9tSW5zcGVjdGlvbkZpbmFsID0gd29ya09yZGVyLnBsYW5uaW5nLmZyb21JbnNwZWN0aW9uSW5pdGlhbDsKICAgICAgfSBlbHNlIGlmICh0aGlzLmZpbmFsSW5zcGVjdGlvblNlbGVjdGlvbiA9PT0gIlNlbGVjdCBFeGlzdGluZyIpIHsKICAgICAgICBjcmVhdGVXb3JrT3JkZXJSZXF1ZXN0LmZpbmFsSW5zcGVjdGlvblRlbXBsYXRlID0gbnVsbDsKICAgICAgICB3b3JrT3JkZXIucGxhbm5pbmcuc2FtZUluc3BlY3Rpb24gPSBmYWxzZTsKICAgICAgfSBlbHNlIHsKICAgICAgICBjcmVhdGVXb3JrT3JkZXJSZXF1ZXN0LmZpbmFsSW5zcGVjdGlvblRlbXBsYXRlID0gbnVsbDsKICAgICAgfQoKICAgICAgY3JlYXRlV29ya09yZGVyUmVxdWVzdC5pbml0aWFsSW5zcGVjdGlvbk9wdGlvbiA9IGluaXRpYWxJbnNwZWN0aW9uT3B0aW9uOwogICAgICBjcmVhdGVXb3JrT3JkZXJSZXF1ZXN0LmZpbmFsSW5zcGVjdGlvbk9wdGlvbiA9IGZpbmFsSW5zcGVjdGlvbk9wdGlvbjsKICAgICAgY3JlYXRlV29ya09yZGVyUmVxdWVzdC5pbml0aWFsSW5zcGVjdGlvblRlbXBsYXRlTGlua2luZ1VVSUQgPSBpbml0aWFsSW5zcGVjdGlvblRlbXBsYXRlTGlua2luZ1VVSUQ7CiAgICAgIGNyZWF0ZVdvcmtPcmRlclJlcXVlc3QuZmluYWxJbnNwZWN0aW9uVGVtcGxhdGVMaW5raW5nVVVJRCA9IGZpbmFsSW5zcGVjdGlvblRlbXBsYXRlTGlua2luZ1VVSUQ7CiAgICAgIGNyZWF0ZVdvcmtPcmRlclJlcXVlc3QuaW5pdGlhbExpbmtJbnNwZWN0aW9uVHlwZSA9IGluaXRpYWxMaW5rSW5zcGVjdGlvblR5cGU7CiAgICAgIGNyZWF0ZVdvcmtPcmRlclJlcXVlc3QuZmluYWxMaW5rSW5zcGVjdGlvblR5cGUgPSBmaW5hbExpbmtJbnNwZWN0aW9uVHlwZTsKICAgICAgY3JlYXRlV29ya09yZGVyUmVxdWVzdC5yZXNvbHV0aW9ucyA9IHJlc29sdXRpb25zOwogICAgICBXb3JrT3JkZXJTZXJ2aWNlLmFkZFdvcmtPcmRlcihjcmVhdGVXb3JrT3JkZXJSZXF1ZXN0LCB0aGlzLmN1cnJlbnRVc2VyRGV0YWlscy5wcm9maWxlLm9yZ2FuaXphdGlvbklkKS50aGVuKHJlc3BvbnNlID0+IHsKICAgICAgICBpZiAocmVzcG9uc2UpIHsKICAgICAgICAgIHRoaXMubG9hZGVyRmxhZyA9IGZhbHNlOwogICAgICAgICAgdGhpcy4kcm91dGVyLnB1c2goewogICAgICAgICAgICBuYW1lOiAid29yay1vcmRlciIsCiAgICAgICAgICAgIHBhcmFtczogewogICAgICAgICAgICAgIHRvYXN0RmxhZzogdHJ1ZSwKICAgICAgICAgICAgICB0b2FzdFR5cGU6ICJzdWNjZXNzIiwKICAgICAgICAgICAgICBtZXNzYWdlOiByZXNwb25zZS5kYXRhLmRlc2NyaXB0aW9uCiAgICAgICAgICAgIH0KICAgICAgICAgIH0pOwogICAgICAgIH0KICAgICAgfSkuY2F0Y2goZXJyb3IgPT4gewogICAgICAgIGlmIChlcnJvcikgewogICAgICAgICAgdGhpcy5sb2FkZXJGbGFnID0gZmFsc2U7CiAgICAgICAgICB0aGlzLnNob3dUb2FzdChlcnJvci5kYXRhLnJlc3BvbnNlLCAiZXJyb3IiKTsKICAgICAgICB9CiAgICAgIH0pOwogICAgfSwKCiAgICBnZXRGb3JtRXJyb3JNZXNzYWdlKGZpZWxkVmFsaWRhdGlvbikgewogICAgICBpZiAoZmllbGRWYWxpZGF0aW9uLiRkaXJ0eSkgewogICAgICAgIHJldHVybiBGdW5jdGlvbnMuZ2V0Rm9ybUZpZWxkRXJyb3JNZXNzYWdlKGZpZWxkVmFsaWRhdGlvbik7CiAgICAgIH0KICAgIH0sCgogICAgYWRkSW5zdHJ1Y3Rpb24oaW5kZXgpIHsKICAgICAgdGhpcy53b3JrT3JkZXJTdW1tYXJ5Lmlzc3Vlc1tpbmRleF0uaW5zdHJ1Y3Rpb25DaGVja2xpc3QucHVzaCh7CiAgICAgICAgdmFsdWU6ICIiCiAgICAgIH0pOwogICAgfSwKCiAgICBzdWJJbnN0cnVjdGlvbihpbmRleCwgaW5zdHJ1Y3Rpb25JbmRleCkgewogICAgICB0aGlzLndvcmtPcmRlclN1bW1hcnkuaXNzdWVzW2luZGV4XS5pbnN0cnVjdGlvbkNoZWNrbGlzdC5zcGxpY2UoaW5zdHJ1Y3Rpb25JbmRleCwgMSk7CiAgICB9LAoKICAgIHVzZXJzU2VsZWN0ZWQodmFsdWUpIHsKICAgICAgdGhpcy5zZWxlY3RlZFVzZXIgPSB2YWx1ZS5zZWxlY3RlZE9iamVjdDsKICAgIH0sCgogICAgY2xlYXJTZWxlY3RlZFVzZXIoKSB7CiAgICAgIHRoaXMud29ya09yZGVyU3VtbWFyeS51c2VyID0gIiI7CiAgICAgIHRoaXMuc2VsZWN0ZWRVc2VyID0gIiI7CiAgICAgIHRoaXMudXNlclJlc2V0Kys7CiAgICB9LAoKICAgIGZpbmFsSW5zcGVjdGlvbkJ5QXNzZXRTZWxlY3RlZCh2YWx1ZSkgewogICAgICB0aGlzLnNlbGVjdGVkRmluYWxJbnNwZWN0aW9uQnlBc3NldCA9IHZhbHVlLnNlbGVjdGVkT2JqZWN0OwogICAgICB0aGlzLmZpbmFsSW5zcGVjdGlvbkJ5QXNzZXRDYXRlZ29yeSA9ICIiOwogICAgICB0aGlzLnNlbGVjdGVkRmluYWxJbnNwZWN0aW9uQnlBc3NldENhdGVnb3J5ID0gIiI7CiAgICAgIHRoaXMuZmluYWxJbnNwZWN0aW9uQnlXb3JrT3JkZXIgPSAiIjsKICAgICAgdGhpcy5zZWxlY3RlZEZpbmFsSW5zcGVjdGlvbkJ5V29ya09yZGVyID0gIiI7CiAgICAgIHRoaXMuZmluYWxJbnNwZWN0aW9uUmVzZXQrKzsKICAgIH0sCgogICAgZmluYWxJbnNwZWN0aW9uQnlBc3NldENhdGVnb3J5U2VsZWN0ZWQodmFsdWUpIHsKICAgICAgdGhpcy5zZWxlY3RlZEZpbmFsSW5zcGVjdGlvbkJ5QXNzZXRDYXRlZ29yeSA9IHZhbHVlLnNlbGVjdGVkT2JqZWN0OwogICAgICB0aGlzLndvcmtPcmRlclN1bW1hcnkuc2VsZWN0ZWRGaW5hbEluc3BlY3Rpb25CeUFzc2V0Q2F0ZWdvcnkgPSB0aGlzLnNlbGVjdGVkRmluYWxJbnNwZWN0aW9uQnlBc3NldENhdGVnb3J5OwogICAgICB0aGlzLmZpbmFsSW5zcGVjdGlvbkJ5QXNzZXQgPSAiIjsKICAgICAgdGhpcy5zZWxlY3RlZEZpbmFsSW5zcGVjdGlvbkJ5QXNzZXQgPSAiIjsKICAgICAgdGhpcy5maW5hbEluc3BlY3Rpb25CeVdvcmtPcmRlciA9ICIiOwogICAgICB0aGlzLnNlbGVjdGVkRmluYWxJbnNwZWN0aW9uQnlXb3JrT3JkZXIgPSAiIjsKICAgICAgdGhpcy5maW5hbEluc3BlY3Rpb25SZXNldCsrOwogICAgfSwKCiAgICBjbGVhclNlbGVjdGVkRmluYWxJbnNwZWN0aW9uQnlBc3NldCgpIHsKICAgICAgdGhpcy5maW5hbEluc3BlY3Rpb25CeUFzc2V0Q2F0ZWdvcnkgPSAiIjsKICAgICAgdGhpcy5maW5hbEluc3BlY3Rpb25SZXNldCsrOwogICAgfSwKCiAgICBmaW5hbEluc3BlY3Rpb25CeVdvcmtPcmRlclNlbGVjdGVkKHZhbHVlKSB7CiAgICAgIHRoaXMuc2VsZWN0ZWRGaW5hbEluc3BlY3Rpb25CeVdvcmtPcmRlciA9IHZhbHVlLnNlbGVjdGVkT2JqZWN0OwogICAgICB0aGlzLmZpbmFsSW5zcGVjdGlvbkJ5QXNzZXQgPSAiIjsKICAgICAgdGhpcy5zZWxlY3RlZEZpbmFsSW5zcGVjdGlvbkJ5QXNzZXQgPSAiIjsKICAgICAgdGhpcy5maW5hbEluc3BlY3Rpb25CeUFzc2V0Q2F0ZWdvcnkgPSAiIjsKICAgICAgdGhpcy5zZWxlY3RlZEZpbmFsSW5zcGVjdGlvbkJ5QXNzZXRDYXRlZ29yeSA9ICIiOwogICAgICB0aGlzLmZpbmFsSW5zcGVjdGlvblJlc2V0Kys7CiAgICB9LAoKICAgIGluaXRpYWxJbnNwZWN0aW9uQnlBc3NldFNlbGVjdGVkKHZhbHVlKSB7CiAgICAgIHRoaXMuc2VsZWN0ZWRJbml0aWFsSW5zcGVjdGlvbkJ5QXNzZXQgPSB2YWx1ZS5zZWxlY3RlZE9iamVjdDsKICAgICAgdGhpcy5pbml0aWFsSW5zcGVjdGlvbkJ5QXNzZXRDYXRlZ29yeSA9ICIiOwogICAgICB0aGlzLnNlbGVjdGVkSW5pdGlhbEluc3BlY3Rpb25CeUFzc2V0Q2F0ZWdvcnkgPSAiIjsKICAgICAgdGhpcy5pbml0aWFsSW5zcGVjdGlvbkJ5V29ya09yZGVyID0gIiI7CiAgICAgIHRoaXMuc2VsZWN0ZWRJbml0aWFsSW5zcGVjdGlvbkJ5V29ya09yZGVyID0gIiI7CiAgICAgIHRoaXMuaW5zcGVjdGlvblJlc2V0Kys7CiAgICB9LAoKICAgIGluaXRpYWxJbnNwZWN0aW9uQnlBc3NldENhdGVnb3J5U2VsZWN0ZWQodmFsdWUpIHsKICAgICAgdGhpcy5pbml0aWFsSW5zcGVjdGlvblRlbXAgPSB2YWx1ZS5zZWxlY3RlZE9iamVjdDsKCiAgICAgIGlmICh0aGlzLnNhbWUgPT09IHRydWUpIHsKICAgICAgICBpZiAodGhpcy5jaGVja0V4aXN0aW5nSW5pdGlhbEluc3BlY3Rpb24gPT09IHRydWUpIHsKICAgICAgICAgIHRoaXMud29ya09yZGVyU3VtbWFyeS5zZWxlY3RlZEZpbmFsSW5zcGVjdGlvbkJ5QXNzZXRDYXRlZ29yeSA9IHZhbHVlLnNlbGVjdGVkT2JqZWN0OwogICAgICAgICAgdGhpcy53b3JrT3JkZXJTdW1tYXJ5SW5kZXgrKzsKICAgICAgICB9CiAgICAgIH0KCiAgICAgIHRoaXMuc2VsZWN0ZWRJbml0aWFsSW5zcGVjdGlvbkJ5QXNzZXRDYXRlZ29yeSA9IHZhbHVlLnNlbGVjdGVkT2JqZWN0OwogICAgICB0aGlzLndvcmtPcmRlclN1bW1hcnkuc2VsZWN0ZWRJbml0aWFsSW5zcGVjdGlvbkJ5QXNzZXRDYXRlZ29yeSA9IHRoaXMuc2VsZWN0ZWRJbml0aWFsSW5zcGVjdGlvbkJ5QXNzZXRDYXRlZ29yeTsKICAgICAgdGhpcy5pbml0aWFsSW5zcGVjdGlvbkJ5QXNzZXQgPSAiIjsKICAgICAgdGhpcy5zZWxlY3RlZEluaXRpYWxJbnNwZWN0aW9uQnlBc3NldCA9ICIiOwogICAgICB0aGlzLmluaXRpYWxJbnNwZWN0aW9uQnlXb3JrT3JkZXIgPSAiIjsKICAgICAgdGhpcy5zZWxlY3RlZEluaXRpYWxJbnNwZWN0aW9uQnlXb3JrT3JkZXIgPSAiIjsKICAgICAgdGhpcy5pbnNwZWN0aW9uUmVzZXQrKzsKICAgIH0sCgogICAgaW5pdGlhbEluc3BlY3Rpb25CeVdvcmtPcmRlclNlbGVjdGVkKHZhbHVlKSB7CiAgICAgIHRoaXMuc2VsZWN0ZWRJbml0aWFsSW5zcGVjdGlvbkJ5V29ya09yZGVyID0gdmFsdWUuc2VsZWN0ZWRPYmplY3Q7CiAgICAgIHRoaXMuaW5pdGlhbEluc3BlY3Rpb25CeUFzc2V0ID0gIiI7CiAgICAgIHRoaXMuc2VsZWN0ZWRJbml0aWFsSW5zcGVjdGlvbkJ5QXNzZXQgPSAiIjsKICAgICAgdGhpcy5pbml0aWFsSW5zcGVjdGlvbkJ5QXNzZXRDYXRlZ29yeSA9ICIiOwogICAgICB0aGlzLnNlbGVjdGVkSW5pdGlhbEluc3BlY3Rpb25CeUFzc2V0Q2F0ZWdvcnkgPSAiIjsKICAgICAgdGhpcy5pbnNwZWN0aW9uUmVzZXQrKzsKICAgIH0sCgogICAgZ2V0SXNzdWVCeVVVSUQoaXNzdWVVVUlEUykgewogICAgICBpc3N1ZVVVSURTLm1hcCgoaXNzdWV1dWlkLCBpbmRleCkgPT4gewogICAgICAgIEluc3BlY3Rpb25TZXJ2aWNlLmdldElzc3VlQnlVVUlEKGlzc3VldXVpZCkudGhlbihyZXNwb25zZSA9PiB7CiAgICAgICAgICBpZiAocmVzcG9uc2Uuc3RhdHVzID09PSAyMDApIHsKICAgICAgICAgICAgbGV0IHBhcnQgPSB7CiAgICAgICAgICAgICAgbmFtZTogIiIsCiAgICAgICAgICAgICAgdXVpZDogdGhpcy5nZW5lcmF0ZVVVSUQoKSwKICAgICAgICAgICAgICBxdWFudGl0eTogMCwKICAgICAgICAgICAgICBjb3N0OiB7CiAgICAgICAgICAgICAgICBjYXRlZ29yeTogInBhcnQtY29zdCIsCiAgICAgICAgICAgICAgICBhbW91bnQ6IDAsCiAgICAgICAgICAgICAgICByZXBvcnRhYmxlOiB0cnVlCiAgICAgICAgICAgICAgfSwKICAgICAgICAgICAgICBleHRyYUNvc3Q6IFt7CiAgICAgICAgICAgICAgICBjYXRlZ29yeTogInRheC1jb3N0IiwKICAgICAgICAgICAgICAgIGFtb3VudDogMCwKICAgICAgICAgICAgICAgIHJlcG9ydGFibGU6IHRydWUKICAgICAgICAgICAgICB9XQogICAgICAgICAgICB9OwogICAgICAgICAgICByZXNwb25zZS5kYXRhLmlzc3VlUmVwb3J0aW5nLmluc3RydWN0aW9uQ2hlY2tsaXN0ID0gSlNPTi5wYXJzZShyZXNwb25zZS5kYXRhLmlzc3VlUmVwb3J0aW5nLmluc3RydWN0aW9uQ2hlY2tsaXN0KTsKCiAgICAgICAgICAgIGlmIChyZXNwb25zZS5kYXRhLmlzc3VlUmVwb3J0aW5nLmluc3RydWN0aW9uQ2hlY2tsaXN0ID09PSBudWxsKSB7CiAgICAgICAgICAgICAgcmVzcG9uc2UuZGF0YS5pc3N1ZVJlcG9ydGluZy5pbnN0cnVjdGlvbkNoZWNrbGlzdCA9IFtdOwogICAgICAgICAgICAgIHJlc3BvbnNlLmRhdGEuaXNzdWVSZXBvcnRpbmcuaW5zdHJ1Y3Rpb25DaGVja2xpc3QucHVzaCh7CiAgICAgICAgICAgICAgICB2YWx1ZTogIiIKICAgICAgICAgICAgICB9KTsKICAgICAgICAgICAgfQoKICAgICAgICAgICAgcmVzcG9uc2UuZGF0YS5pc3N1ZVJlcG9ydGluZy5wYXJ0cyA9IFtdOwogICAgICAgICAgICByZXNwb25zZS5kYXRhLmlzc3VlUmVwb3J0aW5nLnBhcnRzLnB1c2gocGFydCk7CiAgICAgICAgICAgIHJlc3BvbnNlLmRhdGEuaXNzdWVSZXBvcnRpbmcucmVwb3J0ZWRBdCA9IG1vbWVudChyZXNwb25zZS5kYXRhLmlzc3VlUmVwb3J0aW5nLnJlcG9ydGVkQXQpLmZvcm1hdCgiREQgTU1NIFlZWVkiKTsKICAgICAgICAgICAgdGhpcy53b3JrT3JkZXJTdW1tYXJ5Lmlzc3Vlcy5wdXNoKHJlc3BvbnNlLmRhdGEuaXNzdWVSZXBvcnRpbmcpOwoKICAgICAgICAgICAgaWYgKGluZGV4ID09PSAwKSB7CiAgICAgICAgICAgICAgdGhpcy5nZXRBc3NldCh0aGlzLndvcmtPcmRlclN1bW1hcnkuaXNzdWVzW2luZGV4XS5hc3NldFVVSUQpOwogICAgICAgICAgICB9CiAgICAgICAgICB9CiAgICAgICAgfSkuY2F0Y2goZXJyb3IgPT4gewogICAgICAgICAgdGhpcy5zaG93VG9hc3QoZXJyb3IuZGF0YS5yZXNwb25zZSwgImVycm9yIik7CiAgICAgICAgfSk7CiAgICAgIH0pOwogICAgfSwKCiAgICBnZXRBc3NldCh1dWlkKSB7CiAgICAgIEFzc2V0TWFuYWdlbWVudFNlcnZpY2UuZ2V0QXNzZXRXaXRoRGV0YWlscyh1dWlkLCB0cnVlLCB0cnVlKS50aGVuKHJlc3BvbnNlID0+IHsKICAgICAgICB0aGlzLmFzc2V0cyA9IHJlc3BvbnNlLmRhdGEuYXNzZXREZXRhaWw7CiAgICAgICAgdGhpcy5nZXRJbnNwZWN0aW9uVGVtcGxhdGVzKHV1aWQsIHRoaXMuY3VycmVudFVzZXJEZXRhaWxzLnByb2ZpbGUub3JnYW5pemF0aW9uSWQpOwogICAgICAgIHRoaXMuZ2V0SW5zcGVjdGlvblRlbXBsYXRlRnJvbVdvcmtPcmRlcih0aGlzLmN1cnJlbnRVc2VyRGV0YWlscy5wcm9maWxlLm9yZ2FuaXphdGlvbklkKTsKICAgICAgICB0aGlzLmdldEluc3BlY3Rpb25UZW1hcGxhdGVzQnlBc3NldENhdGVnb3J5KHRoaXMuYXNzZXRzLmNhdGVnb3J5LnV1aWQpOwogICAgICB9KTsKICAgIH0sCgogICAgZ2V0VXNlcnNHcm91cCh0ZW5hbnRVVUlEKSB7CiAgICAgIEFzc2V0UGVyc29ubmVsU2VydmljZS5nZXRBbGxVc2VyR3JvdXAodGVuYW50VVVJRCkudGhlbihyZXNwb25zZSA9PiB7CiAgICAgICAgaWYgKHJlc3BvbnNlLnN0YXR1cyA9PT0gMjAwKSB7CiAgICAgICAgICB0aGlzLnVzZXJHcm91cE9wdGlvbnMgPSByZXNwb25zZS5kYXRhLmdyb3VwczsKICAgICAgICAgIHRoaXMudXNlckdyb3VwT3B0aW9ucy5wdXNoKHsKICAgICAgICAgICAgZ3JvdXBVVUlEOiAiQWxsIiwKICAgICAgICAgICAgZ3JvdXBOYW1lOiAiQWxsIgogICAgICAgICAgfSk7CiAgICAgICAgfQogICAgICB9KS5jYXRjaChlcnJvciA9PiB7CiAgICAgICAgaWYgKGVycm9yKSB7CiAgICAgICAgICB0aGlzLnNob3dUb2FzdChlcnJvci5kYXRhLnJlc3BvbnNlLCAiZXJyb3IiKTsKICAgICAgICB9CiAgICAgIH0pOwogICAgfSwKCiAgICBnZXRBbGxVc2Vycyh0ZW5hbnRVVUlEKSB7CiAgICAgIEFzc2V0UGVyc29ubmVsU2VydmljZS5nZXRBbGxVc2Vycyh0ZW5hbnRVVUlEKS50aGVuKHJlc3BvbnNlID0+IHsKICAgICAgICBpZiAocmVzcG9uc2Uuc3RhdHVzID09PSAyMDApIHsKICAgICAgICAgIHRoaXMuYWxsVXNlcnMgPSByZXNwb25zZS5kYXRhLnVzZXJzOwogICAgICAgICAgdGhpcy51c2VyT3B0aW9ucyA9IHJlc3BvbnNlLmRhdGEudXNlcnM7CiAgICAgICAgfQogICAgICB9KS5jYXRjaChlcnJvciA9PiB7CiAgICAgICAgdGhpcy5zaG93VG9hc3QoZXJyb3IuZGF0YS5yZXNwb25zZSwgImVycm9yIik7CiAgICAgIH0pOwogICAgfSwKCiAgICB1c2VyR3JvdXBzSGFuZGxlcihkYXRhKSB7CiAgICAgIHRoaXMuc2VsZWN0ZWRVc2VyR3JvdXAgPSBkYXRhLnNlbGVjdGVkT2JqZWN0OwoKICAgICAgaWYgKGRhdGEuc2VsZWN0ZWRPYmplY3QuZ3JvdXBOYW1lID09PSAiQWxsIikgewogICAgICAgIHRoaXMudXNlck9wdGlvbnMgPSB0aGlzLmFsbFVzZXJzOwogICAgICB9IGVsc2UgewogICAgICAgIHRoaXMudXNlciA9ICIiOwogICAgICAgIEFzc2V0UGVyc29ubmVsU2VydmljZS5nZXRVc2VyR3JvdXBCeVVVSUQoZGF0YS5zZWxlY3RlZE9iamVjdC5ncm91cFVVSUQpLnRoZW4ocmVzcG9uc2UgPT4gewogICAgICAgICAgdGhpcy51c2VyT3B0aW9ucyA9IFtdOwogICAgICAgICAgdGhpcy51c2VyID0gIiI7CiAgICAgICAgICB0aGlzLnVzZXJPcHRpb25zID0gcmVzcG9uc2UuZGF0YS51c2VyR3JvdXAudXNlcnM7CiAgICAgICAgfSk7CiAgICAgIH0KCiAgICAgIHRoaXMudXNlciA9ICIiOwogICAgICB0aGlzLndvcmtPcmRlclN1bW1hcnkudXNlciA9ICIiOwogICAgICB0aGlzLnVzZXJSZXNldCsrOwogICAgfSwKCiAgICBjbGVhclNlbGVjdGVkVXNlckdyb3VwKCkgewogICAgICB0aGlzLndvcmtPcmRlclN1bW1hcnkudXNlckdyb3VwID0gIiI7CiAgICAgIHRoaXMudXNlck9wdGlvbnMgPSB0aGlzLmFsbFVzZXJzOwogICAgICB0aGlzLnVzZXJSZXNldCsrOwogICAgfSwKCiAgICBnZXRJbnNwZWN0aW9uVGVtcGxhdGVzKGFzc2V0VVVJRCwgdGVuYW50VVVJRCkgewogICAgICBJbnNwZWN0aW9uU2VydmljZS5nZXRJbnNwZWN0aW9uVGVtcGxhdGVOYW1lQW5kVVVJRChhc3NldFVVSUQsIHRlbmFudFVVSUQpLnRoZW4ocmVzcG9uc2UgPT4gewogICAgICAgIGlmIChyZXNwb25zZS5zdGF0dXMgPT09IDIwMCkgewogICAgICAgICAgdGhpcy5pbnNwZWN0aW9uQnlBc3NldE9wdGlvbnMgPSByZXNwb25zZS5kYXRhLmluc3BlY3Rpb25zOwogICAgICAgIH0KICAgICAgfSkuY2F0Y2goZXJyb3IgPT4gewogICAgICAgIHRoaXMuc2hvd1RvYXN0KGVycm9yLmRhdGEucmVzcG9uc2UsICJlcnJvciIpOwogICAgICB9KTsKICAgIH0sCgogICAgZ2V0SW5zcGVjdGlvblRlbXBsYXRlRnJvbVdvcmtPcmRlcih0ZW5hbnRVVUlEKSB7CiAgICAgIFdvcmtPcmRlclNlcnZpY2UuZ2V0V29ya09yZGVySW5zcGVjdGlvblRlbXBsYXRlcyh0ZW5hbnRVVUlEKS50aGVuKHJlc3BvbnNlID0+IHsKICAgICAgICBpZiAocmVzcG9uc2Uuc3RhdHVzID09PSAyMDApIHsKICAgICAgICAgIHRoaXMuaW5wc2VjdGlvbkJ5V29ya09yZGVyT3B0aW9ucyA9IHJlc3BvbnNlLmRhdGEuaW5zcGVjdGlvbnM7CgogICAgICAgICAgZm9yIChsZXQgaW5zcGVjdGlvbiBvZiB0aGlzLmlucHNlY3Rpb25CeVdvcmtPcmRlck9wdGlvbnMpIHsKICAgICAgICAgICAgaWYgKGluc3BlY3Rpb24ubmFtZSA9PT0gIiIgfHwgIWluc3BlY3Rpb24ubmFtZSkgewogICAgICAgICAgICAgIGluc3BlY3Rpb24ubmFtZSA9ICItIjsKICAgICAgICAgICAgfQogICAgICAgICAgfQogICAgICAgIH0KICAgICAgfSkuY2F0Y2goZXJyb3IgPT4gewogICAgICAgIHRoaXMuc2hvd1RvYXN0KGVycm9yLmRhdGEucmVzcG9uc2UsICJlcnJvciIpOwogICAgICB9KTsKICAgIH0sCgogICAgZ2V0SW5zcGVjdGlvblRlbWFwbGF0ZXNCeUFzc2V0Q2F0ZWdvcnkoY2F0ZWdvcnlVVUlEKSB7CiAgICAgIEluc3BlY3Rpb25TZXJ2aWNlLmdldEluc3BlY3Rpb25UZW1wbGF0ZU5hbWVBbmRVVUlEQnlDYXRlZ29yeVVVSUQoY2F0ZWdvcnlVVUlEKS50aGVuKHJlc3BvbnNlID0+IHsKICAgICAgICBpZiAocmVzcG9uc2Uuc3RhdHVzID09PSAyMDApIHsKICAgICAgICAgIHRoaXMuaW5wc2VjdGlvbkJ5QXNzZXRDYXRlZ29yeU9wdGlvbnMgPSByZXNwb25zZS5kYXRhLmluc3BlY3Rpb25zOwogICAgICAgIH0KICAgICAgfSkuY2F0Y2goZXJyb3IgPT4gewogICAgICAgIHRoaXMuc2hvd1RvYXN0KGVycm9yLmRhdGEucmVzcG9uc2UsICJlcnJvciIpOwogICAgICB9KTsKICAgIH0sCgogICAgcmVtb3ZlTXVsdGlwbGVDaG9pY2VJbml0aWFsKGluZGV4LCBtKSB7CiAgICAgIHRoaXMucXVlc3Rpb25UeXBlRm9ybUluaXRpYWxbaW5kZXhdLmFuc3dlcnMuc3BsaWNlKG0sIDEpOwogICAgfSwKCiAgICByZW1vdmVNdWx0aXBsZUNob2ljZUZpbmFsKGluZGV4LCBtKSB7CiAgICAgIHRoaXMucXVlc3Rpb25UeXBlRm9ybUZpbmFsW2luZGV4XS5hbnN3ZXJzLnNwbGljZShtLCAxKTsKICAgIH0sCgogICAgYWRkQW5zd2Vyc0FycmF5KHZhbHVlLCBpbmRleCkgewogICAgICB0aGlzLnF1ZXN0aW9uVHlwZUZvcm1Jbml0aWFsW2luZGV4XS50eXBlID0gdmFsdWUuc2VsZWN0ZWRPYmplY3QudmFsdWU7CgogICAgICBpZiAodmFsdWUudmFsdWUgPT09ICJNdWx0aXBsZSBDaG9pY2UiKSB7CiAgICAgICAgdGhpcy5xdWVzdGlvblR5cGVGb3JtSW5pdGlhbFtpbmRleF0uYW5zd2Vycy5wdXNoKCIiLCAiIik7CiAgICAgIH0gZWxzZSB7CiAgICAgICAgdGhpcy5xdWVzdGlvblR5cGVGb3JtSW5pdGlhbFtpbmRleF0uYW5zd2VycyA9IFtdOwogICAgICB9CiAgICB9LAoKICAgIGNsZWFyU2VsZWN0ZWRBbnN3ZXIoaW5kZXgpIHsKICAgICAgdGhpcy5xdWVzdGlvblR5cGVGb3JtSW5pdGlhbFtpbmRleF0udHlwZUxhYmVsID0gIiI7CiAgICAgIHRoaXMudXBkYXRlU2VsZWN0Q29tcCsrOwogICAgfSwKCiAgICBhZGRBbnN3ZXJzQXJyYXlGaW5hbCh2YWx1ZSwgaW5kZXgpIHsKICAgICAgdGhpcy5xdWVzdGlvblR5cGVGb3JtRmluYWxbaW5kZXhdLnR5cGUgPSB2YWx1ZS5zZWxlY3RlZE9iamVjdC52YWx1ZTsKCiAgICAgIGlmICh2YWx1ZS52YWx1ZSA9PT0gIk11bHRpcGxlIENob2ljZSIpIHsKICAgICAgICB0aGlzLnF1ZXN0aW9uVHlwZUZvcm1GaW5hbFtpbmRleF0uYW5zd2Vycy5wdXNoKCIiLCAiIik7CiAgICAgIH0gZWxzZSB7CiAgICAgICAgdGhpcy5xdWVzdGlvblR5cGVGb3JtRmluYWxbaW5kZXhdLmFuc3dlcnMgPSBbXTsKICAgICAgfQogICAgfSwKCiAgICBhZGRNdWx0aXBsZUNob2ljZUluaXRpYWwoaW5kZXgpIHsKICAgICAgdGhpcy5xdWVzdGlvblR5cGVGb3JtSW5pdGlhbFtpbmRleF0uYW5zd2Vycy5wdXNoKCIiKTsKICAgIH0sCgogICAgYWRkTXVsdGlwbGVDaG9pY2VGaW5hbChpbmRleCkgewogICAgICB0aGlzLnF1ZXN0aW9uVHlwZUZvcm1GaW5hbFtpbmRleF0uYW5zd2Vycy5wdXNoKCIiKTsKICAgIH0sCgogICAgcmVtb3ZlSW5wdXRGaWVsZHNJbml0aWFsKGluZGV4KSB7CiAgICAgIHRoaXMucXVlc3Rpb25UeXBlRm9ybUluaXRpYWwuc3BsaWNlKGluZGV4LCAxKTsKICAgIH0sCgogICAgcmVtb3ZlSW5wdXRGaWVsZHNGaW5hbChpbmRleCkgewogICAgICB0aGlzLnF1ZXN0aW9uVHlwZUZvcm1GaW5hbC5zcGxpY2UoaW5kZXgsIDEpOwogICAgfSwKCiAgICBhZGRJbnB1dEZpZWxkc0luaXRpYWwoKSB7CiAgICAgIHRoaXMucXVlc3Rpb25UeXBlRm9ybUluaXRpYWwucHVzaCh7CiAgICAgICAgbmFtZTogIiIsCiAgICAgICAgdHlwZTogIiIsCiAgICAgICAgcXVlc3Rpb246ICIiLAogICAgICAgIGFuc3dlcnM6IFtdLAogICAgICAgIG1hbmRhdG9yeTogdHJ1ZQogICAgICB9KTsKICAgIH0sCgogICAgYWRkSW5wdXRGaWVsZHNGaW5hbCgpIHsKICAgICAgdGhpcy5xdWVzdGlvblR5cGVGb3JtRmluYWwucHVzaCh7CiAgICAgICAgbmFtZTogIiIsCiAgICAgICAgdHlwZTogIiIsCiAgICAgICAgcXVlc3Rpb246ICIiLAogICAgICAgIGFuc3dlcnM6IFtdLAogICAgICAgIG1hbmRhdG9yeTogdHJ1ZQogICAgICB9KTsKICAgIH0sCgogICAgZ2VuZXJhdGVVVUlEKCkgewogICAgICBsZXQgZCA9IG5ldyBEYXRlKCkuZ2V0VGltZSgpOwoKICAgICAgaWYgKERhdGUubm93KCkpIHsKICAgICAgICBkID0gRGF0ZS5ub3coKTsKICAgICAgfQoKICAgICAgbGV0IHV1aWQgPSAieHh4eHh4eHgteHh4eC00eHh4LXl4eHgteHh4eHh4eHh4eHh4Ii5yZXBsYWNlKC9beHldL2csIGMgPT4gewogICAgICAgIGxldCByID0gKGQgKyBNYXRoLnJhbmRvbSgpICogMTYpICUgMTYgfCAwOwogICAgICAgIGQgPSBNYXRoLmZsb29yKGQgLyAxNik7CiAgICAgICAgcmV0dXJuIChjID09PSAieCIgPyByIDogciAmIDB4MyB8IDB4OCkudG9TdHJpbmcoMTYpOwogICAgICB9KTsKICAgICAgcmV0dXJuIHV1aWQ7CiAgICB9LAoKICAgIGFkZFBhcnQoaW5kZXgpIHsKICAgICAgbGV0IGlzc3VlcyA9IHRoaXMud29ya09yZGVyU3VtbWFyeS5pc3N1ZXM7CiAgICAgIGxldCBwYXJ0ID0gewogICAgICAgIG5hbWU6ICIiLAogICAgICAgIHV1aWQ6IHRoaXMuZ2VuZXJhdGVVVUlEKCksCiAgICAgICAgcXVhbnRpdHk6IDAsCiAgICAgICAgY29zdDogewogICAgICAgICAgY2F0ZWdvcnk6ICJwYXJ0LWNvc3QiLAogICAgICAgICAgYW1vdW50OiAwLAogICAgICAgICAgcmVwb3J0YWJsZTogdHJ1ZQogICAgICAgIH0sCiAgICAgICAgZXh0cmFDb3N0OiBbewogICAgICAgICAgY2F0ZWdvcnk6ICJ0YXgtY29zdCIsCiAgICAgICAgICBhbW91bnQ6IDAsCiAgICAgICAgICByZXBvcnRhYmxlOiB0cnVlCiAgICAgICAgfV0KICAgICAgfTsKICAgICAgaXNzdWVzW2luZGV4XS5wYXJ0cy5wdXNoKHBhcnQpOwogICAgICB0aGlzLndvcmtPcmRlclN1bW1hcnkuaXNzdWVzID0gaXNzdWVzOwogICAgfSwKCiAgICByZW1vdmVQYXJ0cyhpbmRleCwgaykgewogICAgICB7CiAgICAgICAgbGV0IHBhcnQgPSB0aGlzLndvcmtPcmRlclN1bW1hcnkuaXNzdWVzW2luZGV4XS5wYXJ0czsKICAgICAgICBwYXJ0LnNwbGljZShrLCAxKTsKICAgICAgfQogICAgfSwKCiAgICBhc3NldERldGFpbHNmcm9tU3RkKHV1aWQpIHsKICAgICAgaWYgKHV1aWQgIT09IHVuZGVmaW5lZCkgewogICAgICAgIEFzc2V0TWFuYWdlbWVudFNlcnZpY2UuZ2V0QXNzZXQodXVpZCkudGhlbihyZXMgPT4gewogICAgICAgICAgdGhpcy53b3JrT3JkZXJTdW1tYXJ5Lm5hbWUgPSByZXMuZGF0YS5hc3NldC5uYW1lOwoKICAgICAgICAgIGlmICh0aGlzLmFzc2V0Q2F0ZWdvcnlPcHRpb25zICE9PSAiIikgewogICAgICAgICAgICBmb3IgKGxldCBhc3NldF9jYXRlZ29yeSBvZiB0aGlzLmFzc2V0Q2F0ZWdvcnlPcHRpb25zKSB7CiAgICAgICAgICAgICAgaWYgKGFzc2V0X2NhdGVnb3J5LmNhdGVnb3J5VVVJRCA9PT0gcmVzLmRhdGEuY2F0ZWdvcnlJZCkgewogICAgICAgICAgICAgICAgdGhpcy53b3JrT3JkZXJTdW1tYXJ5LmNhdGVnb3J5ID0gYXNzZXRfY2F0ZWdvcnkubGFiZWw7CiAgICAgICAgICAgICAgfQogICAgICAgICAgICB9CiAgICAgICAgICB9CgogICAgICAgICAgdGhpcy5nZXRJc3N1ZXNCeUFzc2V0VVVJRChyZXMuZGF0YS5hc3NldC51dWlkKTsKICAgICAgICAgIHRoaXMuYXNzZXRJbmRleCsrOwogICAgICAgICAgdGhpcy5jYXRlZ29yeUluZGV4Kys7CiAgICAgICAgfSk7CiAgICAgIH0KICAgIH0sCgogICAgaW5pdGlhbEluc3BlY3Rpb25WYWxpZGF0aW9uKCkgewogICAgICBsZXQgdmFsaWRhdGlvbnMgPSB7fTsKCiAgICAgIGlmICh0aGlzLmNoZWNrRXhpc3RpbmdJbml0aWFsSW5zcGVjdGlvbikgewogICAgICAgIHZhbGlkYXRpb25zID0gewogICAgICAgICAgaW5pdGlhbEluc3BlY3Rpb25CeUFzc2V0Q2F0ZWdvcnk6IHsKICAgICAgICAgICAgcmVxdWlyZWQKICAgICAgICAgIH0sCiAgICAgICAgICBxdWVzdGlvblR5cGVGb3JtSW5pdGlhbDogewogICAgICAgICAgICAkZWFjaDogewogICAgICAgICAgICAgIG5hbWU6IHt9LAogICAgICAgICAgICAgIHF1ZXN0aW9uOiB7fSwKICAgICAgICAgICAgICB0eXBlTGFiZWw6IHt9CiAgICAgICAgICAgIH0KICAgICAgICAgIH0KICAgICAgICB9OwogICAgICB9IGVsc2UgewogICAgICAgIHZhbGlkYXRpb25zID0gewogICAgICAgICAgaW5pdGlhbEluc3BlY3Rpb25CeUFzc2V0Q2F0ZWdvcnk6IHt9LAogICAgICAgICAgcXVlc3Rpb25UeXBlRm9ybUluaXRpYWw6IHsKICAgICAgICAgICAgJGVhY2g6IHsKICAgICAgICAgICAgICBuYW1lOiB7CiAgICAgICAgICAgICAgICByZXF1aXJlZCwKICAgICAgICAgICAgICAgIG1heExlbmd0aDogbWF4TGVuZ3RoKDE5MCkKICAgICAgICAgICAgICB9LAogICAgICAgICAgICAgIHF1ZXN0aW9uOiB7CiAgICAgICAgICAgICAgICByZXF1aXJlZCwKICAgICAgICAgICAgICAgIG1heExlbmd0aDogbWF4TGVuZ3RoKDE5MCkKICAgICAgICAgICAgICB9LAogICAgICAgICAgICAgIHR5cGVMYWJlbDogewogICAgICAgICAgICAgICAgcmVxdWlyZWQKICAgICAgICAgICAgICB9CiAgICAgICAgICAgIH0KICAgICAgICAgIH0KICAgICAgICB9OwogICAgICB9CgogICAgICByZXR1cm4gdmFsaWRhdGlvbnM7CiAgICB9LAoKICAgIHdvcmtPcmRlclZhbGlkYXRpb24oKSB7CiAgICAgIGxldCB2YWxpZGF0aW9ucyA9IHt9OwoKICAgICAgaWYgKCF0aGlzLmNoZWNrRXhpc3RpbmdJbml0aWFsSW5zcGVjdGlvbiAmJiB0aGlzLmZpbmFsSW5zcGVjdGlvblNlbGVjdGlvbiA9PSAiQ3JlYXRlIE5ldyBJbnNwZWN0aW9uIFRlbXBsYXRlIikgewogICAgICAgIHZhbGlkYXRpb25zID0gewogICAgICAgICAgd29ya09yZGVyU3VtbWFyeTogewogICAgICAgICAgICBwcmlvcml0eTogewogICAgICAgICAgICAgIHJlcXVpcmVkCiAgICAgICAgICAgIH0sCiAgICAgICAgICAgIHNoaWZ0OiB7CiAgICAgICAgICAgICAgcmVxdWlyZWQKICAgICAgICAgICAgfSwKICAgICAgICAgICAgc2hlZHVsZTogewogICAgICAgICAgICAgIHJlcXVpcmVkCiAgICAgICAgICAgIH0sCiAgICAgICAgICAgIHVzZXI6IHsKICAgICAgICAgICAgICByZXF1aXJlZAogICAgICAgICAgICB9LAogICAgICAgICAgICBjYXRlZ29yeTogewogICAgICAgICAgICAgIHJlcXVpcmVkCiAgICAgICAgICAgIH0sCiAgICAgICAgICAgIG5hbWU6IHsKICAgICAgICAgICAgICByZXF1aXJlZAogICAgICAgICAgICB9LAogICAgICAgICAgICBpbml0aWFsSW5zcGVjdGlvblRpdGxlOiB7CiAgICAgICAgICAgICAgcmVxdWlyZWQsCiAgICAgICAgICAgICAgbWF4TGVuZ3RoOiBtYXhMZW5ndGgoMTkwKQogICAgICAgICAgICB9LAogICAgICAgICAgICBmaW5hbEluc3BlY3Rpb25UaXRsZTogewogICAgICAgICAgICAgIHJlcXVpcmVkLAogICAgICAgICAgICAgIG1heExlbmd0aDogbWF4TGVuZ3RoKDE5MCkKICAgICAgICAgICAgfQogICAgICAgICAgfQogICAgICAgIH07CiAgICAgIH0gZWxzZSBpZiAodGhpcy5jaGVja0V4aXN0aW5nSW5pdGlhbEluc3BlY3Rpb24gJiYgdGhpcy5maW5hbEluc3BlY3Rpb25TZWxlY3Rpb24gPT0gIkNyZWF0ZSBOZXcgSW5zcGVjdGlvbiBUZW1wbGF0ZSIpIHsKICAgICAgICB2YWxpZGF0aW9ucyA9IHsKICAgICAgICAgIHdvcmtPcmRlclN1bW1hcnk6IHsKICAgICAgICAgICAgcHJpb3JpdHk6IHsKICAgICAgICAgICAgICByZXF1aXJlZAogICAgICAgICAgICB9LAogICAgICAgICAgICBzaGlmdDogewogICAgICAgICAgICAgIHJlcXVpcmVkCiAgICAgICAgICAgIH0sCiAgICAgICAgICAgIHNoZWR1bGU6IHsKICAgICAgICAgICAgICByZXF1aXJlZAogICAgICAgICAgICB9LAogICAgICAgICAgICB1c2VyOiB7CiAgICAgICAgICAgICAgcmVxdWlyZWQKICAgICAgICAgICAgfSwKICAgICAgICAgICAgY2F0ZWdvcnk6IHsKICAgICAgICAgICAgICByZXF1aXJlZAogICAgICAgICAgICB9LAogICAgICAgICAgICBuYW1lOiB7CiAgICAgICAgICAgICAgcmVxdWlyZWQKICAgICAgICAgICAgfSwKICAgICAgICAgICAgaW5pdGlhbEluc3BlY3Rpb25UaXRsZToge30sCiAgICAgICAgICAgIGZpbmFsSW5zcGVjdGlvblRpdGxlOiB7CiAgICAgICAgICAgICAgcmVxdWlyZWQKICAgICAgICAgICAgfQogICAgICAgICAgfQogICAgICAgIH07CiAgICAgIH0gZWxzZSBpZiAoIXRoaXMuY2hlY2tFeGlzdGluZ0luaXRpYWxJbnNwZWN0aW9uICYmIHRoaXMuZmluYWxJbnNwZWN0aW9uU2VsZWN0aW9uICE9PSAiQ3JlYXRlIE5ldyBJbnNwZWN0aW9uIFRlbXBsYXRlIikgewogICAgICAgIHZhbGlkYXRpb25zID0gewogICAgICAgICAgd29ya09yZGVyU3VtbWFyeTogewogICAgICAgICAgICBwcmlvcml0eTogewogICAgICAgICAgICAgIHJlcXVpcmVkCiAgICAgICAgICAgIH0sCiAgICAgICAgICAgIHNoaWZ0OiB7CiAgICAgICAgICAgICAgcmVxdWlyZWQKICAgICAgICAgICAgfSwKICAgICAgICAgICAgc2hlZHVsZTogewogICAgICAgICAgICAgIHJlcXVpcmVkCiAgICAgICAgICAgIH0sCiAgICAgICAgICAgIHVzZXI6IHsKICAgICAgICAgICAgICByZXF1aXJlZAogICAgICAgICAgICB9LAogICAgICAgICAgICBjYXRlZ29yeTogewogICAgICAgICAgICAgIHJlcXVpcmVkCiAgICAgICAgICAgIH0sCiAgICAgICAgICAgIG5hbWU6IHsKICAgICAgICAgICAgICByZXF1aXJlZAogICAgICAgICAgICB9LAogICAgICAgICAgICBpbml0aWFsSW5zcGVjdGlvblRpdGxlOiB7CiAgICAgICAgICAgICAgcmVxdWlyZWQKICAgICAgICAgICAgfSwKICAgICAgICAgICAgZmluYWxJbnNwZWN0aW9uVGl0bGU6IHt9CiAgICAgICAgICB9CiAgICAgICAgfTsKICAgICAgfSBlbHNlIHsKICAgICAgICB2YWxpZGF0aW9ucyA9IHsKICAgICAgICAgIHdvcmtPcmRlclN1bW1hcnk6IHsKICAgICAgICAgICAgcHJpb3JpdHk6IHsKICAgICAgICAgICAgICByZXF1aXJlZAogICAgICAgICAgICB9LAogICAgICAgICAgICBzaGlmdDogewogICAgICAgICAgICAgIHJlcXVpcmVkCiAgICAgICAgICAgIH0sCiAgICAgICAgICAgIHNoZWR1bGU6IHsKICAgICAgICAgICAgICByZXF1aXJlZAogICAgICAgICAgICB9LAogICAgICAgICAgICB1c2VyOiB7CiAgICAgICAgICAgICAgcmVxdWlyZWQKICAgICAgICAgICAgfSwKICAgICAgICAgICAgY2F0ZWdvcnk6IHsKICAgICAgICAgICAgICByZXF1aXJlZAogICAgICAgICAgICB9LAogICAgICAgICAgICBuYW1lOiB7CiAgICAgICAgICAgICAgcmVxdWlyZWQKICAgICAgICAgICAgfSwKICAgICAgICAgICAgaW5pdGlhbEluc3BlY3Rpb25UaXRsZToge30sCiAgICAgICAgICAgIGZpbmFsSW5zcGVjdGlvblRpdGxlOiB7fQogICAgICAgICAgfQogICAgICAgIH07CiAgICAgIH0KCiAgICAgIHJldHVybiB2YWxpZGF0aW9uczsKICAgIH0sCgogICAgZmluYWxJbnNwZWN0aW9uVmFsaWRhdGlvbigpIHsKICAgICAgbGV0IHZhbGRpYXRpb25zID0ge307CgogICAgICBpZiAodGhpcy5maW5hbEluc3BlY3Rpb25TZWxlY3Rpb24gPT0gIkNyZWF0ZSBOZXcgSW5zcGVjdGlvbiBUZW1wbGF0ZSIpIHsKICAgICAgICB2YWxkaWF0aW9ucyA9IHsKICAgICAgICAgIHF1ZXN0aW9uVHlwZUZvcm1GaW5hbDogewogICAgICAgICAgICAkZWFjaDogewogICAgICAgICAgICAgIG5hbWU6IHsKICAgICAgICAgICAgICAgIHJlcXVpcmVkLAogICAgICAgICAgICAgICAgbWF4TGVuZ3RoOiBtYXhMZW5ndGgoMTkwKQogICAgICAgICAgICAgIH0sCiAgICAgICAgICAgICAgcXVlc3Rpb246IHsKICAgICAgICAgICAgICAgIHJlcXVpcmVkLAogICAgICAgICAgICAgICAgbWF4TGVuZ3RoOiBtYXhMZW5ndGgoMTkwKQogICAgICAgICAgICAgIH0sCiAgICAgICAgICAgICAgdHlwZUxhYmVsOiB7CiAgICAgICAgICAgICAgICByZXF1aXJlZAogICAgICAgICAgICAgIH0KICAgICAgICAgICAgfQogICAgICAgICAgfQogICAgICAgIH07CiAgICAgIH0gZWxzZSB7CiAgICAgICAgdmFsZGlhdGlvbnMgPSB7CiAgICAgICAgICBxdWVzdGlvblR5cGVGb3JtRmluYWw6IHsKICAgICAgICAgICAgJGVhY2g6IHsKICAgICAgICAgICAgICBuYW1lOiB7fSwKICAgICAgICAgICAgICBxdWVzdGlvbjoge30sCiAgICAgICAgICAgICAgdHlwZUxhYmVsOiB7fQogICAgICAgICAgICB9CiAgICAgICAgICB9CiAgICAgICAgfTsKICAgICAgfQoKICAgICAgaWYgKHRoaXMuZmluYWxJbnNwZWN0aW9uU2VsZWN0aW9uID09PSAiU2VsZWN0IEV4aXN0aW5nIikgewogICAgICAgIHZhbGRpYXRpb25zLmZpbmFsSW5zcGVjdGlvbkJ5QXNzZXRDYXRlZ29yeSA9IHsKICAgICAgICAgIHJlcXVpcmVkCiAgICAgICAgfTsKICAgICAgfSBlbHNlIHsKICAgICAgICB2YWxkaWF0aW9ucy5maW5hbEluc3BlY3Rpb25CeUFzc2V0Q2F0ZWdvcnkgPSB7fTsKICAgICAgfQoKICAgICAgcmV0dXJuIHZhbGRpYXRpb25zOwogICAgfSwKCiAgICBzaG93VG9hc3QobWVzc2FnZSwgdHlwZSkgewogICAgICB0aGlzLnRvYXN0TWVzc2FnZSA9IG1lc3NhZ2U7CiAgICAgIHRoaXMudG9hc3RUeXBlID0gdHlwZTsKICAgICAgdGhpcy50b2FzdEZsYWcrKzsKICAgIH0KCiAgfSwKICB3YXRjaDogewogICAgcXVhbnRpdHlWYWw6IGZ1bmN0aW9uICgpIHsKICAgICAgaWYgKHRoaXMucXVhbnRpdHlWYWwgPT0gdHJ1ZSkgey8vIGRlY3JlbWVudCBiYWNrZ3JvdW5kLWUxZTFlMQogICAgICB9CiAgICB9CiAgfSwKCiAgY3JlYXRlZCgpIHsKICAgIHRoaXMuY3VycmVudFVzZXJEZXRhaWxzID0gSlNPTi5wYXJzZShsb2NhbFN0b3JhZ2UuZ2V0SXRlbSgiY3VycmVudFVzZXJEZXRhaWxzIikpOwogICAgdGhpcy5nZXRDdXJyZW5jeSgpOwogICAgdGhpcy5nZXRBbGxDYXRlZ29yaWVzKHRoaXMuY3VycmVudFVzZXJEZXRhaWxzKTsKICAgIHRoaXMuZ2V0VXNlcnNHcm91cCh0aGlzLmN1cnJlbnRVc2VyRGV0YWlscy5wcm9maWxlLm9yZ2FuaXphdGlvbklkKTsKICAgIHRoaXMuZ2V0QWxsVXNlcnModGhpcy5jdXJyZW50VXNlckRldGFpbHMucHJvZmlsZS5vcmdhbml6YXRpb25JZCk7CgogICAgaWYgKHRoaXMuJHJvdXRlLnBhcmFtcy5jcmVhdGVXb3JrT3JkZXIpIHsKICAgICAgdGhpcy5kaXNiYWJsZWZpZWxkID0gdHJ1ZTsKICAgICAgdGhpcy5pc3N1ZXNTZWxlY3RlZCA9IHRoaXMuJHJvdXRlLnBhcmFtcy5pc3N1ZXV1aWQ7CiAgICAgIHRoaXMuZ2V0SXNzdWVCeVVVSUQodGhpcy4kcm91dGUucGFyYW1zLmlzc3VldXVpZCk7CiAgICB9CgogICAgaWYgKHRoaXMuJHJvdXRlLnBhcmFtcy5hc3NldCkgewogICAgICB0aGlzLndvcmtPcmRlclN1bW1hcnkubmFtZSA9IHRoaXMuJHJvdXRlLnBhcmFtcy5hc3NldC5uYW1lOwogICAgICB0aGlzLndvcmtPcmRlclN1bW1hcnkuY2F0ZWdvcnkgPSB0aGlzLiRyb3V0ZS5wYXJhbXMuYXNzZXQuY2F0ZWdvcnk7CiAgICB9CgogICAgdGhpcy5hZGRJbnB1dEZpZWxkc0luaXRpYWwoKTsKICAgIHRoaXMuYWRkSW5wdXRGaWVsZHNGaW5hbCgpOwogIH0sCgogIHZhbGlkYXRpb25zOiBmdW5jdGlvbiAoKSB7CiAgICByZXR1cm4geyAuLi50aGlzLndvcmtPcmRlclZhbGlkYXRpb24oKSwKICAgICAgLi4udGhpcy5pbml0aWFsSW5zcGVjdGlvblZhbGlkYXRpb24oKSwKICAgICAgLi4udGhpcy5maW5hbEluc3BlY3Rpb25WYWxpZGF0aW9uKCksCiAgICAgIGZpbmFsSW5zcGVjdGlvblNlbGVjdGlvbjogewogICAgICAgIHJlcXVpcmVkCiAgICAgIH0sCiAgICAgIGlzc3Vlc1NlbGVjdGVkOiB7CiAgICAgICAgcmVxdWlyZWQKICAgICAgfSwKICAgICAgcGFydDogewogICAgICAgIHF1YW50aXR5OiB7CiAgICAgICAgICBudW1lcmljCiAgICAgICAgfQogICAgICB9CiAgICAgIC8qIGlzc3Vlczp7CiAgICAgICRlYWNoOnsKICAgICAgaXNzdWVOYW1lOntyZXF1aXJlZH0sCiAgICAgIH0sCiAgICAgIH0sKi8KCiAgICB9OwogIH0KfTs="},null]}