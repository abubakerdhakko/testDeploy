{"remainingRequest":"/home/alsharqi/Desktop/Deploy Fe-ui/fe-erohal-ui/node_modules/babel-loader/lib/index.js!/home/alsharqi/Desktop/Deploy Fe-ui/fe-erohal-ui/node_modules/cache-loader/dist/cjs.js??ref--1-0!/home/alsharqi/Desktop/Deploy Fe-ui/fe-erohal-ui/node_modules/vue-loader/lib/index.js??vue-loader-options!/home/alsharqi/Desktop/Deploy Fe-ui/fe-erohal-ui/src/views/issues/IssuesDetail.vue?vue&type=script&lang=js&","dependencies":[{"path":"/home/alsharqi/Desktop/Deploy Fe-ui/fe-erohal-ui/src/views/issues/IssuesDetail.vue","mtime":1661968702436},{"path":"/home/alsharqi/Desktop/Deploy Fe-ui/fe-erohal-ui/babel.config.js","mtime":1661968702388},{"path":"/home/alsharqi/Desktop/Deploy Fe-ui/fe-erohal-ui/node_modules/cache-loader/dist/cjs.js","mtime":1662622637759},{"path":"/home/alsharqi/Desktop/Deploy Fe-ui/fe-erohal-ui/node_modules/babel-loader/lib/index.js","mtime":1662622637719},{"path":"/home/alsharqi/Desktop/Deploy Fe-ui/fe-erohal-ui/node_modules/cache-loader/dist/cjs.js","mtime":1662622637759},{"path":"/home/alsharqi/Desktop/Deploy Fe-ui/fe-erohal-ui/node_modules/vue-loader/lib/index.js","mtime":1662622639723}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:aW1wb3J0IEFzc2V0TWFuYWdlbWVudFNlcnZpY2UgZnJvbSAiLi4vLi4vc2VydmljZXMvQXNzZXRNYW5hZ2VtZW50U2VydmljZSI7CmltcG9ydCBBc3NldFBlcnNvbm5lbFNlcnZpY2UgZnJvbSAiLi4vLi4vc2VydmljZXMvQXNzZXRQZXJzb25uZWxTZXJ2aWNlIjsKaW1wb3J0IFdvcmtPcmRlclNlcnZpY2UgZnJvbSAiLi4vLi4vc2VydmljZXMvV29ya09yZGVyU2VydmljZSI7CmltcG9ydCBtb21lbnQgZnJvbSAibW9tZW50IjsKaW1wb3J0IEFkZFBhcnQgZnJvbSAiLi4vaXNzdWVzL2NvbXBvbmVudHMvQWRkUGFydCI7CmltcG9ydCBBZGRDb3N0IGZyb20gIi4uL2lzc3Vlcy9jb21wb25lbnRzL0FkZENvc3QiOwppbXBvcnQgSW5zcGVjdGlvblNlcnZpY2UgZnJvbSAiLi4vLi4vc2VydmljZXMvSW5zcGVjdGlvblNlcnZpY2UiOwppbXBvcnQgU2lkZUJhciBmcm9tICIuLi9pc3N1ZXMvY29tcG9uZW50cy9TaWRlQmFyIjsKaW1wb3J0IHsgRnVuY3Rpb25zIH0gZnJvbSAiQC9zaGFyZWQvRnVuY3Rpb25zIjsKaW1wb3J0IHsgcmVxdWlyZWQsIG1heExlbmd0aCB9IGZyb20gInZ1ZWxpZGF0ZS9saWIvdmFsaWRhdG9ycyI7CmltcG9ydCBhcmNoaXZlRGlhbG9nIGZyb20gIi4uLy4uL2NvbXBvbmVudHMvQXJjaGl2ZURpYWxvZy52dWUiOwppbXBvcnQgbG9hZGVyIGZyb20gIkAvY29tcG9uZW50cy9Mb2FkZXIudnVlIjsKZXhwb3J0IGRlZmF1bHQgewogIG5hbWU6ICJJc3N1ZURldGFpbCIsCiAgY29tcG9uZW50czogewogICAgU2lkZUJhciwKICAgIEFkZFBhcnQsCiAgICBhcmNoaXZlRGlhbG9nLAogICAgQWRkQ29zdCwKICAgIGxvYWRlcgogIH0sCiAgcHJvcHM6IHsKICAgIGlzc3VlVVVJRDoge30sCiAgICB3b3JrT3JkZXI6IHt9LAogICAgd29ya09yZGVyaW5kZXg6IHt9CiAgfSwKCiAgZGF0YSgpIHsKICAgIHJldHVybiB7CiAgICAgIGxvYWRlckZsYWc6IGZhbHNlLAogICAgICB0b2FzdEZsYWc6IDAsCiAgICAgIHRvYXN0TWVzc2FnZTogIiIsCiAgICAgIHRvYXN0VHlwZTogIiIsCiAgICAgIHRvYXN0VGltZU91dDogMzAwMCwKICAgICAgcG9wdXBJbWFnZTogIiIsCiAgICAgIGN1cnJlbnRQYWdlT2ZBc3NldFJlbGF0ZWRJc3N1ZXM6IDEsCiAgICAgIG51bWJlck9mcGFnZU9mQXNzZXRSZWxhdGVkSXNzdWVzOiAiIiwKICAgICAgcm93c1BlclBhZ2VPZkFzc2V0UmVsdGVkSXNzdWU6IDUsCiAgICAgIGN1cnJlbnRQYWdlT2ZJc3N1ZUNhdGVnb3J5UmVsYXRlZElzc3VlczogMSwKICAgICAgbnVtYmVyT2ZwYWdlT2ZJc3N1ZUNhdGVnb3J5UmVsYXRlZElzc3VlczogIiIsCiAgICAgIHJvd3NQZXJQYWdlT2ZJc3N1ZUNhdGVnb3J5UmVsdGVkSXNzdWU6IDUsCiAgICAgIG9wZW5GbGFnOiB0cnVlLAogICAgICBpbWFnZURpYWxvZzogZmFsc2UsCiAgICAgIHVwZGF0ZVNpZGU6IDAsCiAgICAgIGN1cnJlbnRVc2VyRGV0YWlsczogIiIsCiAgICAgIGZpbGVSZWNvcmQ6IG51bGwsCiAgICAgIGluc3BlY3Rpb25JRDogIiIsCiAgICAgIGFyY2hpdmVJbnNwZWN0aW9uRGlhbG9nOiBmYWxzZSwKICAgICAgc2VsZWN0ZWRUYWI6ICJwYXJ0cyIsCiAgICAgIGNvc3RzOiBbXSwKICAgICAgY29zdDogIiIsCiAgICAgIGlzc3VlczogewogICAgICAgIGlzc3VlTmFtZTogIiIsCiAgICAgICAgcHJpb3JpdHk6ICIiLAogICAgICAgIGlzc3VlQ2F0ZWdvcnk6ICIiLAogICAgICAgIGlzc3VlVHlwZTogIiIsCiAgICAgICAgYXNzZXRDYXRlZ29yeTogIiIsCiAgICAgICAgYXNzZXROYW1lOiAiIiwKICAgICAgICBhc3NldFVVSUQ6ICIiLAogICAgICAgIHN1Ym1pdHRlZEJ5VXNlck5hbWU6ICIiLAogICAgICAgIHJlcG9ydGVkQXQ6ICIiLAogICAgICAgIGlzc3VlRGVzY3JpcHRpb246ICIiLAogICAgICAgIGRlc2NyaXB0aW9uOiAiIiwKICAgICAgICBpZ25vcmVDb21tZW50czogIiIsCiAgICAgICAgc3RhdHVzOiAiIgogICAgICB9LAogICAgICBzdWJtaXR0ZWRieVVzZXJVVUlEOiAiIiwKICAgICAgcGFydHM6IFtdLAogICAgICBzZXJ2aWNlUmVxdWVzdDogIiIsCiAgICAgIGluc3BlY3Rpb25SZXBvcnQ6ICIiLAogICAgICBpc3N1ZUluZGV4OiAwLAogICAgICBzZXJ2aWNlSW5kZXg6IDAsCiAgICAgIGluc3BlY3Rpb25JbmRleDogMCwKICAgICAgcGFydFRhYmxlOiAwLAogICAgICBwcmlvcml0eU9wdGlvbnM6IFt7CiAgICAgICAgbGFiZWw6ICJsb3ciCiAgICAgIH0sIHsKICAgICAgICBsYWJlbDogIk1lZGl1bSIKICAgICAgfSwgewogICAgICAgIGxhYmVsOiAiSGlnaCIKICAgICAgfV0sCiAgICAgIHN0YXR1c09wdGlvbnM6IFt7CiAgICAgICAgbGFiZWw6ICJSZXBvcnRlZCIsCiAgICAgICAgdmFsdWU6ICJyZXBvcnRlZCIKICAgICAgfSwgewogICAgICAgIGxhYmVsOiAiSW5wcm9ncmVzcyIsCiAgICAgICAgdmFsdWU6ICJpbnByb2dyZXNzIgogICAgICB9LCB7CiAgICAgICAgbGFiZWw6ICJSZXNvbHZlZCIsCiAgICAgICAgdmFsdWU6ICJSZXNvbHZlZCIKICAgICAgfSwgewogICAgICAgIGxhYmVsOiAiSWdub3JlIiwKICAgICAgICB2YWx1ZTogImlnbm9yZWQiCiAgICAgIH1dLAogICAgICBhZGRQYXJ0c0RpYWxvZzogZmFsc2UsCiAgICAgIGFkZENvc3RzRGlhbG9nOiBmYWxzZSwKICAgICAgY29zdFRvdGFsOiAwLAogICAgICBjb3N0VGFibGU6IDAsCiAgICAgIGNvc3RUeXBlOiBmYWxzZSwKICAgICAgdG90YWxXb3JrT3JkZXJDb3N0czogMCwKICAgICAgdmFsdWU6ICIiLAogICAgICBjYXRlZ29yeU9wdGlvbnM6IFtdLAogICAgICB0eXBlT3B0aW9uczogW10sCiAgICAgIGFzc2V0TmFtZTogIiIsCiAgICAgIGFzc2V0Q2F0ZWdvcnlPcHRpb25zOiBbXSwKICAgICAgYWxsQXNzZXREYXRhOiBbXSwKICAgICAgYXNzZXROYW1lczogW10sCiAgICAgIGNhdGVnb3J5SW5kZXg6IDAsCiAgICAgIGFzc2V0SW5kZXg6IDAsCiAgICAgIHBhcnRUeXBlOiBmYWxzZSwKICAgICAgcGFydDogIiIsCiAgICAgIGN1cnJlbmN5OiAiIiwKICAgICAgYXNzZXRJc3N1ZXM6ICIiLAogICAgICBJc3N1ZUNhdGdvcnlSZWxhdGVkSXNzdWVzOiAiIiwKICAgICAgaXNzdWVXb3JrT3JkZXI6ICIiLAogICAgICBpbnNwZWN0aW9uSXNzdWU6ICIiLAogICAgICBpbWFnZVZvaWNlczogW10sCiAgICAgIGZpZWxkc0Rpc2FibGU6ICIiLAogICAgICBhc3NldFJlbGF0ZWRJc3N1ZXM6ICIiLAogICAgICBpc3N1ZUNhdGVnb3J5OiAiIiwKICAgICAgaXNzdWVzT2JqOiBbXSwKICAgICAgaXNzdWVTdGF0dXM6ICIiLAogICAgICBhc3NldEZpZWxkc0Rpc2FibGU6ICIiLAogICAgICBtYW51ZmFjdHVyZTogIiIsCiAgICAgIG9iakFzc2V0TmFtZTogIiIsCiAgICAgIG9iakFzc2V0VVVJRDogIiIsCiAgICAgIHV1aWQ6ICIiLAogICAgICB1cGRhdGVDb3N0SW5kZXg6IDAsCiAgICAgIGZpbGVVcGxvYWQ6IFtdLAogICAgICBpc3N1ZUNhdGVnb3J5SW5kZXg6IDAsCiAgICAgIGFzc2V0SW5mbzoge30sCiAgICAgIGNhdGVnb3J5TGlzdDogIiIsCiAgICAgIGNhdGVPcHRpb25zOiBbXQogICAgfTsKICB9LAoKICBtZXRob2RzOiB7CiAgICBjbGVhclNlbGVjdGVkUHJpb3JpdHkoKSB7CiAgICAgIHRoaXMuaXNzdWVzLnByaW9yaXR5ID0gIiI7CiAgICAgIHRoaXMuaXNzdWVDYXRlZ29yeUluZGV4Kys7CiAgICB9LAoKICAgIGNsZWFyU2VsZWN0ZWRDYXRlZ29yeSgpIHsKICAgICAgdGhpcy5pc3N1ZXMuaXNzdWVDYXRlZ29yeSA9ICIiOwogICAgICB0aGlzLmlzc3Vlcy5pc3N1ZVR5cGUgPSAiIjsKICAgICAgdGhpcy50eXBlT3B0aW9ucyA9IFtdOwogICAgICB0aGlzLmlzc3VlQ2F0ZWdvcnlJbmRleCsrOwogICAgfSwKCiAgICBjbGVhclNlbGVjdGVkQ2F0ZWdvcnRUeXBlKCkgewogICAgICB0aGlzLmlzc3Vlcy5pc3N1ZVR5cGUgPSAiIjsKICAgICAgdGhpcy5pc3N1ZUNhdGVnb3J5SW5kZXgrKzsKICAgIH0sCgogICAgdGVzdENvc3QodmFsdWUpIHsKICAgICAgdGhpcy50b3RhbFdvcmtPcmRlckNvc3RzID0gdmFsdWU7CiAgICAgIHRoaXMudXBkYXRlQ29zdEluZGV4Kys7CiAgICB9LAoKICAgIGdldFBhcnRzQnlVVUlkKHV1aWQpIHsKICAgICAgV29ya09yZGVyU2VydmljZS5nZXRQYXJ0c0J5SXNzdWVVVUlEKHV1aWQpLnRoZW4ocmVzcG9uc2UgPT4gewogICAgICAgIGlmIChyZXNwb25zZS5zdGF0dXMgPT09IDIwMCkgewogICAgICAgICAgZm9yIChsZXQgaW5kZXggPSAwOyBpbmRleCA8IHJlc3BvbnNlLmRhdGEucGFydFVzZWQubGVuZ3RoOyBpbmRleCsrKSB7CiAgICAgICAgICAgIHRoaXMudG90YWxXb3JrT3JkZXJDb3N0cyArPSByZXNwb25zZS5kYXRhLnBhcnRVc2VkW2luZGV4XS5xdWFudGl0eSAqIHJlc3BvbnNlLmRhdGEucGFydFVzZWRbaW5kZXhdLmNvc3QuYW1vdW50ICsgcmVzcG9uc2UuZGF0YS5wYXJ0VXNlZFtpbmRleF0uY29zdC50YXhBbW91bnQ7CiAgICAgICAgICB9CgogICAgICAgICAgdGhpcy51cGRhdGVTaWRlKys7CiAgICAgICAgfQogICAgICB9KS5jYXRjaChlcnJvciA9PiB7fSk7CiAgICB9LAoKICAgIHJlY2VpdmVEb2N1bWVudChmaWxlKSB7CiAgICAgIHRoaXMubG9hZGVyRmxhZyA9IHRydWU7CiAgICAgIEFzc2V0TWFuYWdlbWVudFNlcnZpY2UudXBsb2FkRmlsZVRvczModGhpcy5maWxlUmVjb3JkKS50aGVuKHJlcyA9PiB7CiAgICAgICAgaWYgKHJlcy5kYXRhLnJlc3BvbnNlSWRlbnRpZmllciA9PT0gIlN1Y2Nlc3MiKSB7CiAgICAgICAgICBsZXQgaW1hZ2VWb2ljZSA9IHsKICAgICAgICAgICAgY29udGVudFVybDogcmVzLmRhdGEuZmlsZVVybAogICAgICAgICAgfTsKICAgICAgICAgIHRoaXMuZmlsZVVwbG9hZCA9IFtdOwogICAgICAgICAgdGhpcy5maWxlVXBsb2FkLnB1c2goaW1hZ2VWb2ljZSk7CiAgICAgICAgICB0aGlzLmxvYWRlckZsYWcgPSBmYWxzZTsKICAgICAgICAgIHRoaXMuc2hvd1RvYXN0KCJJbWFnZSBhZGRlZCBTdWNjdXNzZnVsbHkuIiwgInN1Y2Nlc3MiKTsKICAgICAgICB9CiAgICAgIH0pLmNhdGNoKGUgPT4gewogICAgICAgIHRoaXMubG9hZGVyRmxhZyA9IGZhbHNlOwogICAgICAgIHRoaXMuc2hvd1RvYXN0KCJQbGVhc2UgdXBsb2FkIGltYWdlIGFnYWluLiIsICJlcnJvciIpOwogICAgICB9KTsKICAgIH0sCgogICAgZ2V0Q29zdEJ5VVVJRCh1dWlkKSB7CiAgICAgIFdvcmtPcmRlclNlcnZpY2UuZ2V0Q29zdHNCeUlzc3VlVVVJRCh1dWlkKS50aGVuKHJlc3BvbnNlID0+IHsKICAgICAgICBpZiAocmVzcG9uc2Uuc3RhdHVzID09PSAyMDApIHsKICAgICAgICAgIGZvciAobGV0IGluZGV4ID0gMDsgaW5kZXggPCByZXNwb25zZS5kYXRhLmNvc3QubGVuZ3RoOyBpbmRleCsrKSB7CiAgICAgICAgICAgIHRoaXMudG90YWxXb3JrT3JkZXJDb3N0cyArPSByZXNwb25zZS5kYXRhLmNvc3RbaW5kZXhdLmNvc3RRdWFudGl0eSAqIHJlc3BvbnNlLmRhdGEuY29zdFtpbmRleF0uYW1vdW50ICsgcmVzcG9uc2UuZGF0YS5jb3N0W2luZGV4XS50YXhBbW91bnQ7CiAgICAgICAgICB9CgogICAgICAgICAgdGhpcy51cGRhdGVTaWRlKys7CiAgICAgICAgfQogICAgICB9KS5jYXRjaChlcnJvciA9PiB7fSk7CiAgICB9LAoKICAgIHVwZGF0ZUNvc3QoKSB7CiAgICAgIHRoaXMuYWRkQ29zdHNEaWFsb2cgPSBmYWxzZTsKICAgICAgdGhpcy5jb3N0VHlwZSA9IGZhbHNlOwogICAgICB0aGlzLmdldENvc3RzKHRoaXMudXVpZCk7CiAgICAgIHRoaXMuJGVtaXQoInNpZGVCYXJJbmRleCIpOwogICAgfSwKCiAgICBjcmVhdGVDb3N0KCkgewogICAgICB0aGlzLmFkZENvc3RzRGlhbG9nID0gZmFsc2U7CiAgICAgIHRoaXMuZ2V0Q29zdHModGhpcy51dWlkKTsKICAgICAgdGhpcy4kZW1pdCgic2lkZUJhckluZGV4Iik7CiAgICB9LAoKICAgIGVkaXRDb3N0KGNvc3QpIHsKICAgICAgdGhpcy5jb3N0ID0gY29zdDsKICAgICAgdGhpcy5jb3N0VHlwZSA9IHRydWU7CiAgICAgIHRoaXMuYWRkQ29zdHNEaWFsb2cgPSB0cnVlOwogICAgfSwKCiAgICBkZWxldGVDb3N0KGNvc3QpIHsKICAgICAgV29ya09yZGVyU2VydmljZS5kZWxldGVDb3N0KGNvc3QudXVpZCkudGhlbihyZXNwb25zZSA9PiB7CiAgICAgICAgaWYgKHJlc3BvbnNlLnN0YXR1cyA9PT0gMjAwKSB7CiAgICAgICAgICB0aGlzLnNob3dUb2FzdCgiQ29zdCBEZWxldGUgU3VjY2Vzc2Z1bGx5IiwgInN1Y2Nlc3MiKTsKICAgICAgICAgIHRoaXMuY29zdFRhYmxlKys7CiAgICAgICAgICB0aGlzLnVwZGF0ZVNpZGUrKzsKICAgICAgICAgIHRoaXMuZ2V0Q29zdHModGhpcy51dWlkKTsKICAgICAgICB9CiAgICAgIH0pLmNhdGNoKGVycm9yID0+IHt9KTsKICAgIH0sCgogICAgZ2V0Q29zdHModXVpZCkgewogICAgICBXb3JrT3JkZXJTZXJ2aWNlLmdldENvc3RzQnlJc3N1ZVVVSUQodXVpZCkudGhlbihyZXMgPT4gewogICAgICAgIHRoaXMuY29zdHMgPSByZXMuZGF0YS5jb3N0OwoKICAgICAgICBmb3IgKGxldCBpbmRleCA9IDA7IGluZGV4IDwgdGhpcy5jb3N0cy5sZW5ndGg7IGluZGV4KyspIHsKICAgICAgICAgIHRoaXMuY29zdFRvdGFsID0gdGhpcy5jb3N0c1tpbmRleF0uYW1vdW50ICogdGhpcy5jb3N0c1tpbmRleF0uY29zdFF1YW50aXR5ICsgdGhpcy5jb3N0c1tpbmRleF0udGF4QW1vdW50OwogICAgICAgIH0KCiAgICAgICAgdGhpcy50b3RhbFdvcmtPcmRlckNvc3QgKz0gdGhpcy5jb3N0VG90YWw7CiAgICAgICAgdGhpcy50b3RhbEluZGV4Kys7CiAgICAgICAgdGhpcy51cGRhdGVTaWRlKys7CiAgICAgIH0pLmNhdGNoKGVyciA9PiB7CiAgICAgICAgY29uc29sZS5sb2coZXJyKTsKICAgICAgfSk7CiAgICB9LAoKICAgIGdldEluc3BlY3Rpb25ieUlzc3VlVVVJRCh1dWlkKSB7CiAgICAgIEluc3BlY3Rpb25TZXJ2aWNlLmdldEluc3BlY3Rpb25ieUlzc3VlVVVJRCh1dWlkKS50aGVuKHJlcyA9PiB7CiAgICAgICAgdGhpcy5pbnNwZWN0aW9uSXNzdWUgPSByZXMuZGF0YS5pbnNwZWN0aW9uUmVwb3J0czsKICAgICAgICB0aGlzLnBhcnRUYWJsZSsrOwogICAgICB9KS5jYXRjaChlID0+IHsKICAgICAgICB0aGlzLnNob3dUb2FzdCgiRXJyb3IiLCAiZXJyb3IiKTsKICAgICAgfSk7CiAgICB9LAoKICAgIGdldFdvcmtPcmRlckJ5aXNzdWVVVUlEKHV1aWQpIHsKICAgICAgV29ya09yZGVyU2VydmljZS5nZXRXb3JrT3JkZXJCeWlzc3VlVVVJRCh1dWlkKS50aGVuKHJlcyA9PiB7CiAgICAgICAgdGhpcy5pc3N1ZVdvcmtPcmRlciA9IHJlcy5kYXRhLndvcmtPcmRlcjsKICAgICAgICB0aGlzLnBhcnRUYWJsZSsrOwogICAgICB9KS5jYXRjaChlID0+IHsKICAgICAgICB0aGlzLnNob3dUb2FzdCgiRXJyb3IiLCAiZXJyb3IiKTsKICAgICAgfSk7CiAgICB9LAoKICAgIGdldEN1cnJlbmN5KCkgewogICAgICBBc3NldFBlcnNvbm5lbFNlcnZpY2UuZ2V0Q29tcGFueUN1cnJlbmN5KHRoaXMuY3VycmVudFVzZXJEZXRhaWxzLnByb2ZpbGUub3JnYW5pemF0aW9uSWQpLnRoZW4ocmVzcG9uc2UgPT4gewogICAgICAgIHRoaXMuY3VycmVuY3kgPSByZXNwb25zZS5kYXRhLmN1cnJlbmN5OwogICAgICB9KTsKICAgIH0sCgogICAgZ2V0UGFydHModXVpZCkgewogICAgICBXb3JrT3JkZXJTZXJ2aWNlLmdldFBhcnRzQnlJc3N1ZVVVSUQodXVpZCkudGhlbihyZXMgPT4gewogICAgICAgIHRoaXMucGFydHMgPSByZXMuZGF0YS5wYXJ0VXNlZDsKCiAgICAgICAgZm9yIChsZXQgaW5kZXggPSAwOyBpbmRleCA8IHRoaXMucGFydHMubGVuZ3RoOyBpbmRleCsrKSB7CiAgICAgICAgICB0aGlzLnBhcnRzVG90YWwgPSB0aGlzLnBhcnRzW2luZGV4XS5xdWFudGl0eSAqIHRoaXMucGFydHNbaW5kZXhdLmNvc3QuYW1vdW50ICsgdGhpcy5wYXJ0c1tpbmRleF0uY29zdC50YXhBbW91bnQ7CiAgICAgICAgfQoKICAgICAgICB0aGlzLnRvdGFsV29ya09yZGVyQ29zdCArPSB0aGlzLnBhcnRzVG90YWw7CiAgICAgICAgdGhpcy50b3RhbEluZGV4Kys7CiAgICAgICAgdGhpcy51cGRhdGVTaWRlKys7CiAgICAgIH0pLmNhdGNoKGVyciA9PiB7CiAgICAgICAgY29uc29sZS5sb2coZXJyKTsKICAgICAgfSk7CiAgICB9LAoKICAgIGFkZEZ1bmN0aW9uKCkgewogICAgICBpZiAodGhpcy5zZWxlY3RlZFRhYiA9PT0gInBhcnRzIikgewogICAgICAgIHRoaXMuYWRkUGFydHNEaWFsb2cgPSB0cnVlOwogICAgICB9IGVsc2UgaWYgKHRoaXMuc2VsZWN0ZWRUYWIgPT09ICJjb3N0cyIpIHsKICAgICAgICB0aGlzLmFkZENvc3RzRGlhbG9nID0gdHJ1ZTsKICAgICAgfQogICAgfSwKCiAgICBlZGl0UGFydChwYXJ0KSB7CiAgICAgIHRoaXMucGFydCA9IHBhcnQ7CiAgICAgIHRoaXMucGFydFR5cGUgPSB0cnVlOwogICAgICB0aGlzLmFkZFBhcnRzRGlhbG9nID0gdHJ1ZTsKICAgIH0sCgogICAgVXBkYXRlUGFydCgpIHsKICAgICAgdGhpcy5hZGRQYXJ0c0RpYWxvZyA9IGZhbHNlOwogICAgICB0aGlzLnBhcnRUeXBlID0gZmFsc2U7CiAgICAgIHRoaXMuZ2V0UGFydHModGhpcy51dWlkKTsKICAgIH0sCgogICAgY3JlYXRlUGFydCgpIHsKICAgICAgdGhpcy5hZGRQYXJ0c0RpYWxvZyA9IGZhbHNlOwogICAgICB0aGlzLmdldFBhcnRzKHRoaXMudXVpZCk7CiAgICAgIHRoaXMudXBkYXRlU2lkZSsrOwogICAgfSwKCiAgICBmdWxsc2NyZWVuSW1hZ2UodmFsdWUpIHsKICAgICAgdGhpcy5wb3B1cEltYWdlID0gdmFsdWU7CiAgICAgIHRoaXMuaW1hZ2VEaWFsb2cgPSB0cnVlOwogICAgfSwKCiAgICBjbG9zZSgpIHsKICAgICAgdGhpcy5pbWFnZURpYWxvZyA9IGZhbHNlOwogICAgfSwKCiAgICBjbG9zZURpYWxvZygpIHsKICAgICAgdGhpcy5hZGRQYXJ0c0RpYWxvZyA9IGZhbHNlOwogICAgICB0aGlzLnBhcnRUeXBlID0gZmFsc2U7CiAgICAgIHRoaXMuYXJjaGl2ZUluc3BlY3Rpb25EaWFsb2cgPSBmYWxzZTsKICAgICAgdGhpcy5hZGRDb3N0c0RpYWxvZyA9IGZhbHNlOwogICAgICB0aGlzLmNvc3RUeXBlID0gZmFsc2U7CiAgICB9LAoKICAgIGFyY2hpdmVEaWFsb2coKSB7CiAgICAgIEluc3BlY3Rpb25TZXJ2aWNlLmRlbGV0ZUluc3BlY3Rpb25CeVVVSUQodGhpcy5pbnNwZWN0aW9uSUQsICJhcmNoaXZlIikudGhlbihyZXNwb25zZSA9PiB7CiAgICAgICAgaWYgKHJlc3BvbnNlLnN0YXR1cyA9PT0gMjAwKSB7CiAgICAgICAgICB0aGlzLnJlc2V0VGFibGUrKzsKICAgICAgICAgIHRoaXMuc2hvd1RvYXN0KCJJbnNwZWN0aW9uIEFyY2hpdmVkIFN1Y2Nlc3NmdWxseSIsICJzdWNjZXNzIik7CiAgICAgICAgICB0aGlzLmFyY2hpdmVJbnNwZWN0aW9uRGlhbG9nID0gZmFsc2U7CiAgICAgICAgfQogICAgICB9KS5jYXRjaChlcnJvciA9PiB7fSk7CiAgICB9LAoKICAgIGRlbGV0ZVBhcnQocGFydCkgewogICAgICBXb3JrT3JkZXJTZXJ2aWNlLmRlbGV0ZVBhcnQocGFydC51dWlkKS50aGVuKHJlc3BvbnNlID0+IHsKICAgICAgICBpZiAocmVzcG9uc2Uuc3RhdHVzID09PSAyMDApIHsKICAgICAgICAgIHRoaXMuc2hvd1RvYXN0KCJQYXJ0IERlbGV0ZSBTdWNjZXNzZnVsbHkiLCAic3VjY2VzcyIpOwogICAgICAgICAgdGhpcy5wYXJ0VGFibGUrKzsKICAgICAgICAgIHRoaXMudXBkYXRlU2lkZSsrOwogICAgICAgICAgdGhpcy5nZXRQYXJ0cyh0aGlzLnV1aWQpOwogICAgICAgIH0KICAgICAgfSkuY2F0Y2goZXJyb3IgPT4ge30pOwogICAgfSwKCiAgICBzZWxlY3RNYW5hZ2VtZW50VHlwZShvYmopIHsKICAgICAgdGhpcy5tYW5hZ2VPcHRpb24gPSBvYmoudmFsdWU7CiAgICB9LAoKICAgIG9uU2VsZWN0ZWRBc3NldE5hbWUodmFsdWUpIHsKICAgICAgdGhpcy5hc3NldFV1aWQgPSB2YWx1ZS5zZWxlY3RlZE9iamVjdC51dWlkOwogICAgICB0aGlzLm9iakFzc2V0TmFtZSA9IHZhbHVlLnNlbGVjdGVkT2JqZWN0LmxhYmVsOwogICAgICB0aGlzLm9iakFzc2V0VVVJRCA9IHZhbHVlLnNlbGVjdGVkT2JqZWN0LnV1aWQ7CiAgICAgIHRoaXMuY3VycmVudFBhZ2VPZkFzc2V0UmVsYXRlZElzc3VlcyA9IDE7CiAgICAgIHRoaXMuYXNzZXRJbmZvID0gdmFsdWUuc2VsZWN0ZWRPYmplY3Q7CiAgICAgIHRoaXMuZ2V0UGFnaW5hdGVkQXNzZXRSZWxhdGVkSXNzdWVzKHRoaXMuY3VycmVudFBhZ2VPZkFzc2V0UmVsYXRlZElzc3VlcywgdGhpcy5hc3NldFV1aWQpOwogICAgfSwKCiAgICBwYWdpbmF0aW9uT2ZBc3NldFJlbGF0ZWRJc3N1ZSh2YWwpIHsKICAgICAgdGhpcy5nZXRQYWdpbmF0ZWRBc3NldFJlbGF0ZWRJc3N1ZXModmFsLCB0aGlzLmlzc3Vlcy5hc3NldFVVSUQpOwogICAgfSwKCiAgICBnZXRQYWdpbmF0ZWRBc3NldFJlbGF0ZWRJc3N1ZXModmFsLCBhc3NldFVVSUQpIHsKICAgICAgbGV0IHJlcXVlc3QgPSB7CiAgICAgICAgb2Zmc2V0OiB2YWwgLSAxLAogICAgICAgIGxpbWl0OiB0aGlzLnJvd3NQZXJQYWdlT2ZBc3NldFJlbHRlZElzc3VlLAogICAgICAgIGFzc2V0VVVJRDogYXNzZXRVVUlELAogICAgICAgIHN0YXR1czogInJlcG9ydGVkIiwKICAgICAgICB0ZW5hbnRVVUlEOiB0aGlzLmN1cnJlbnRVc2VyRGV0YWlscy5wcm9maWxlLm9yZ2FuaXphdGlvbklkLAogICAgICAgIGlzc3VlVVVJRDogdGhpcy4kcm91dGUucGFyYW1zLmlzc3VlSUQKICAgICAgfTsKICAgICAgSW5zcGVjdGlvblNlcnZpY2UuZ2V0UGFnaW5hdGVkQXNzZXRSZWxhdGVkSXNzdWVzKHJlcXVlc3QpLnRoZW4ocmVzcG9uc2UgPT4gewogICAgICAgIGlmIChyZXNwb25zZS5zdGF0dXMgPT09IDIwMCkgewogICAgICAgICAgdGhpcy5udW1iZXJPZnBhZ2VPZkFzc2V0UmVsYXRlZElzc3VlcyA9IHJlc3BvbnNlLmRhdGEuaXNzdWVSZXBvcnRpbmdzLnRvdGFsUGFnZXM7CiAgICAgICAgICB0aGlzLmFzc2V0SXNzdWVzID0gcmVzcG9uc2UuZGF0YS5pc3N1ZVJlcG9ydGluZ3MuY29udGVudDsKICAgICAgICAgIHRoaXMuYXNzZXRJc3N1ZXMubWFwKGlzc3VlID0+IHsKICAgICAgICAgICAgaXNzdWUucmVwb3J0ZWRBdCA9IG1vbWVudChpc3N1ZS5yZXBvcnRlZEF0KS5mb3JtYXQoIkREIE1NTSBZWVlZIGhoOm1tIGEiKTsKICAgICAgICAgIH0pOwogICAgICAgIH0KICAgICAgfSkuY2F0Y2goZXJyb3IgPT4gewogICAgICAgIGNvbnNvbGUubG9nKGVycm9yKTsgLy8gbm8gc25hY2thYmFyIGNvbXBvbmVudCBzbyBjb25zb2xlIHRoZSBlcnJvcgogICAgICB9KTsKICAgIH0sCgogICAgb25TZWxlY3RlZEFzc2V0Q2F0ZWdvcnkodmFsdWUpIHsKICAgICAgLy8gY29uc29sZS5sb2coJ3ZhbHVlJyx2YWx1ZSkKICAgICAgdGhpcy5hc3NldE5hbWVzID0gW107CiAgICAgIHRoaXMuaXNzdWVzLmFzc2V0TmFtZSA9ICIiOwogICAgICB0aGlzLmFzc2V0TmFtZSA9ICIiOwoKICAgICAgZm9yIChsZXQgaW5kZXggPSAwOyBpbmRleCA8IHRoaXMuYWxsQXNzZXREYXRhLmxlbmd0aDsgaW5kZXgrKykgewogICAgICAgIGlmICh0aGlzLmFsbEFzc2V0RGF0YVtpbmRleF0uY2F0ZWdvcnlVVUlEID09PSB2YWx1ZS5zZWxlY3RlZE9iamVjdC5jYXRlZ29yeVVVSUQpIHsKICAgICAgICAgIHRoaXMuYXNzZXROYW1lcy5wdXNoKHRoaXMuYWxsQXNzZXREYXRhW2luZGV4XSk7CiAgICAgICAgfQogICAgICB9CgogICAgICBmb3IgKGxldCBpbmRleCA9IDA7IGluZGV4IDwgdGhpcy5jYXRlZ29yeUxpc3QubGVuZ3RoOyBpbmRleCsrKSB7CiAgICAgICAgaWYgKHRoaXMuY2F0ZWdvcnlMaXN0W2luZGV4XS5uYW1lID09PSB2YWx1ZS52YWx1ZSkgewogICAgICAgICAgZm9yIChsZXQgaW5kZXgxID0gMDsgaW5kZXgxIDwgdGhpcy5jYXRlZ29yeUxpc3RbaW5kZXhdLmlzc3Vlc0NhdGVnb3J5LmZpZWxkcy5sZW5ndGg7IGluZGV4MSsrKSB7CiAgICAgICAgICAgIGxldCBvYmogPSB7CiAgICAgICAgICAgICAgbGFiZWw6IHRoaXMuY2F0ZWdvcnlMaXN0W2luZGV4XS5pc3N1ZXNDYXRlZ29yeS5maWVsZHNbaW5kZXgxXS5sYWJlbCwKICAgICAgICAgICAgICB2YWx1ZTogdGhpcy5jYXRlZ29yeUxpc3RbaW5kZXhdLmlzc3Vlc0NhdGVnb3J5LmZpZWxkc1tpbmRleDFdLmxhYmVsCiAgICAgICAgICAgIH07CiAgICAgICAgICAgIHRoaXMuY2F0ZU9wdGlvbnMucHVzaCh0aGlzLmNhdGVnb3J5TGlzdFtpbmRleF0uaXNzdWVzQ2F0ZWdvcnkuZmllbGRzW2luZGV4MV0pOwogICAgICAgICAgICB0aGlzLmNhdGVnb3J5T3B0aW9ucy5wdXNoKG9iaik7CiAgICAgICAgICB9CiAgICAgICAgfQogICAgICB9CgogICAgICB0aGlzLmlzc3Vlcy5hc3NldE5hbWUgPSAiIjsKICAgICAgdGhpcy5jYXRlZ29yeUluZGV4Kys7CiAgICAgIHRoaXMuYXNzZXRJbmRleCsrOwogICAgICB0aGlzLnVwZGF0ZVNpZGUrKzsgLy8gdGhpcy5nZXRJbnNwZWN0aW9uVGVtYXBsYXRlc0J5QXNzZXRDYXRlZ29yeSgKICAgICAgLy8gICB2YWx1ZS5zZWxlY3RlZE9iamVjdC5jYXRlZ29yeVVVSUQKICAgICAgLy8gKTsKICAgICAgLy8gdGhpcy53b3JrT3JkZXJTdW1hcnkubmFtZSA9ICIiOwogICAgICAvLwl0aGlzLmFzc2V0SW5kZXgrKzsKICAgIH0sCgogICAgb25DbGVhckFzc2V0Q2F0ZSgpIHsvLyB0aGlzLmlzc3Vlcy5hc3NldENhdGVnb3J5ID0gIiI7CiAgICAgIC8vIHRoaXMuaXNzdWVzLmFzc2V0TmFtZSA9ICIiOwogICAgICAvLyB0aGlzLmFzc2V0TmFtZSA9ICIiOwogICAgICAvLyB0aGlzLmlzc3Vlcy5pc3N1ZUNhdGVnb3J5ID0gIiI7CiAgICAgIC8vIHRoaXMuaXNzdWVzLmlzc3VlVHlwZSA9ICIiOwogICAgICAvLyBjb25zb2xlLmxvZygndGhpcy5pc3N1ZXMuYXNzZXROYW1lJyx0aGlzLmlzc3Vlcy5hc3NldE5hbWUsdGhpcy5hc3NldE5hbWUpCiAgICB9LAoKICAgIG9uQ2xlYXJBc3NldCgpIHsKICAgICAgdGhpcy5pc3N1ZXMuYXNzZXROYW1lID0gIiI7CiAgICAgIHRoaXMuaXNzdWVzLmlzc3VlQ2F0ZWdvcnkgPSAiIjsKICAgICAgdGhpcy5pc3N1ZXMuaXNzdWVUeXBlID0gIiI7CiAgICB9LAoKICAgIGlzc3VlRGV0YWlsc0FjY29yZGlvbkZ1bmN0aW9uKHZhbHVlKSB7CiAgICAgIGlmICh0aGlzLiRyZWZzLmlzc3VlRGV0YWlsc0FjY29yZGlvbi5vcGVuRmxhZyA9PT0gdHJ1ZSkgewogICAgICAgIHRoaXMuJHJlZnMuYXNzZXREZXRhaWxzQWNjb3JkaW9uLm9wZW5GbGFnID0gZmFsc2U7CgogICAgICAgIGlmICh0aGlzLmlzc3Vlcy5zdGF0dXMgPT0gInJlcG9ydGVkIiAmJiB0aGlzLmlzc3Vlcy5pbnBlY3Rpb25JdGVtc1VVSUQgIT09IG51bGwpIHsKICAgICAgICAgIHRoaXMuJHJlZnMuaW5zcGVjdGlvbkRldGFpbHNBY2NvcmRpb24ub3BlbkZsYWcgPSBmYWxzZTsKICAgICAgICB9CgogICAgICAgIGlmICh0aGlzLmlzc3Vlcy5zdGF0dXMgPT0gIlJlc29sdmVkIikgewogICAgICAgICAgdGhpcy4kcmVmcy5wYXJ0c0RldGFpbHNBY2NvcmRpb24ub3BlbkZsYWcgPSBmYWxzZTsKICAgICAgICB9CgogICAgICAgIHRoaXMuJHJlZnMuYXR0YWNobWVudHNEZXRhaWxzQWNjb3JkaW9uLm9wZW5GbGFnID0gZmFsc2U7CgogICAgICAgIGlmICh0aGlzLmlzc3VlV29ya09yZGVyLndvcmtPcmRlck51bWJlciAhPT0gbnVsbCAmJiB0aGlzLmlzc3VlV29ya09yZGVyLnN0YXR1cyAhPT0gImlnbm9yZWQiKSB7CiAgICAgICAgICB0aGlzLiRyZWZzLnJlbGF0ZWRXb3JrT3JkZXJEZXRhaWxzQWNjb3JkaW9uLm9wZW5GbGFnID0gZmFsc2U7CiAgICAgICAgfQoKICAgICAgICB0aGlzLiRyZWZzLnJlbGF0ZWRJc3N1ZURldGFpbHNBY2NvcmRpb24ub3BlbkZsYWcgPSBmYWxzZTsKICAgICAgfQogICAgfSwKCiAgICBhc3NldERldGFpbEFjY29yZGlvbkZ1bmN0aW9uKHZhbHVlKSB7CiAgICAgIGlmICh0aGlzLiRyZWZzLmFzc2V0RGV0YWlsc0FjY29yZGlvbi5vcGVuRmxhZyA9PT0gdHJ1ZSkgewogICAgICAgIHRoaXMuJHJlZnMuaXNzdWVEZXRhaWxzQWNjb3JkaW9uLm9wZW5GbGFnID0gZmFsc2U7CgogICAgICAgIGlmICh0aGlzLmlzc3Vlcy5zdGF0dXMgPT0gInJlcG9ydGVkIiAmJiB0aGlzLmlzc3Vlcy5pbnBlY3Rpb25JdGVtc1VVSUQgIT09IG51bGwpIHsKICAgICAgICAgIHRoaXMuJHJlZnMuaW5zcGVjdGlvbkRldGFpbHNBY2NvcmRpb24ub3BlbkZsYWcgPSBmYWxzZTsKICAgICAgICB9CgogICAgICAgIGlmICh0aGlzLmlzc3Vlcy5zdGF0dXMgPT0gIlJlc29sdmVkIikgewogICAgICAgICAgdGhpcy4kcmVmcy5wYXJ0c0RldGFpbHNBY2NvcmRpb24ub3BlbkZsYWcgPSBmYWxzZTsKICAgICAgICB9CgogICAgICAgIHRoaXMuJHJlZnMuYXR0YWNobWVudHNEZXRhaWxzQWNjb3JkaW9uLm9wZW5GbGFnID0gZmFsc2U7CgogICAgICAgIGlmICh0aGlzLmlzc3VlV29ya09yZGVyLndvcmtPcmRlck51bWJlciAhPT0gbnVsbCAmJiB0aGlzLmlzc3VlV29ya09yZGVyLnN0YXR1cyAhPT0gImlnbm9yZWQiKSB7CiAgICAgICAgICB0aGlzLiRyZWZzLnJlbGF0ZWRXb3JrT3JkZXJEZXRhaWxzQWNjb3JkaW9uLm9wZW5GbGFnID0gZmFsc2U7CiAgICAgICAgfQoKICAgICAgICB0aGlzLiRyZWZzLnJlbGF0ZWRJc3N1ZURldGFpbHNBY2NvcmRpb24ub3BlbkZsYWcgPSBmYWxzZTsKICAgICAgfQogICAgfSwKCiAgICBwYXJ0c0RldGFpbHNBY2NvcmRpb25GdW5jdGlvbih2YWx1ZSkgewogICAgICBpZiAodGhpcy4kcmVmcy5wYXJ0c0RldGFpbHNBY2NvcmRpb24ub3BlbkZsYWcgPT09IHRydWUpIHsKICAgICAgICB0aGlzLiRyZWZzLmFzc2V0RGV0YWlsc0FjY29yZGlvbi5vcGVuRmxhZyA9IGZhbHNlOwoKICAgICAgICBpZiAodGhpcy5pc3N1ZXMuc3RhdHVzID09ICJyZXBvcnRlZCIgJiYgdGhpcy5pc3N1ZXMuaW5wZWN0aW9uSXRlbXNVVUlEICE9PSBudWxsKSB7CiAgICAgICAgICB0aGlzLiRyZWZzLmluc3BlY3Rpb25EZXRhaWxzQWNjb3JkaW9uLm9wZW5GbGFnID0gZmFsc2U7CiAgICAgICAgfQoKICAgICAgICB0aGlzLiRyZWZzLmlzc3VlRGV0YWlsc0FjY29yZGlvbi5vcGVuRmxhZyA9IGZhbHNlOwogICAgICAgIHRoaXMuJHJlZnMuYXR0YWNobWVudHNEZXRhaWxzQWNjb3JkaW9uLm9wZW5GbGFnID0gZmFsc2U7CgogICAgICAgIGlmICh0aGlzLmlzc3VlV29ya09yZGVyLndvcmtPcmRlck51bWJlciAhPT0gbnVsbCAmJiB0aGlzLmlzc3VlV29ya09yZGVyLnN0YXR1cyAhPT0gImlnbm9yZWQiKSB7CiAgICAgICAgICB0aGlzLiRyZWZzLnJlbGF0ZWRXb3JrT3JkZXJEZXRhaWxzQWNjb3JkaW9uLm9wZW5GbGFnID0gZmFsc2U7CiAgICAgICAgfQoKICAgICAgICB0aGlzLiRyZWZzLnJlbGF0ZWRJc3N1ZURldGFpbHNBY2NvcmRpb24ub3BlbkZsYWcgPSBmYWxzZTsKICAgICAgfQogICAgfSwKCiAgICBpbnNwZWN0aW9uRGV0YWlsc0FjY29yZGlvbkZ1bmN0aW9uKHZhbHVlKSB7CiAgICAgIGlmICh0aGlzLiRyZWZzLmluc3BlY3Rpb25EZXRhaWxzQWNjb3JkaW9uLm9wZW5GbGFnID09PSB0cnVlKSB7CiAgICAgICAgdGhpcy4kcmVmcy5hc3NldERldGFpbHNBY2NvcmRpb24ub3BlbkZsYWcgPSBmYWxzZTsKICAgICAgICB0aGlzLiRyZWZzLmlzc3VlRGV0YWlsc0FjY29yZGlvbi5vcGVuRmxhZyA9IGZhbHNlOwoKICAgICAgICBpZiAodGhpcy5pc3N1ZXMuc3RhdHVzID09ICJSZXNvbHZlZCIpIHsKICAgICAgICAgIHRoaXMuJHJlZnMucGFydHNEZXRhaWxzQWNjb3JkaW9uLm9wZW5GbGFnID0gZmFsc2U7CiAgICAgICAgfQoKICAgICAgICB0aGlzLiRyZWZzLmF0dGFjaG1lbnRzRGV0YWlsc0FjY29yZGlvbi5vcGVuRmxhZyA9IGZhbHNlOwoKICAgICAgICBpZiAodGhpcy5pc3N1ZVdvcmtPcmRlci53b3JrT3JkZXJOdW1iZXIgIT09IG51bGwgJiYgdGhpcy5pc3N1ZVdvcmtPcmRlci5zdGF0dXMgIT09ICJpZ25vcmVkIikgewogICAgICAgICAgdGhpcy4kcmVmcy5yZWxhdGVkV29ya09yZGVyRGV0YWlsc0FjY29yZGlvbi5vcGVuRmxhZyA9IGZhbHNlOwogICAgICAgIH0KCiAgICAgICAgdGhpcy4kcmVmcy5yZWxhdGVkSXNzdWVEZXRhaWxzQWNjb3JkaW9uLm9wZW5GbGFnID0gZmFsc2U7CiAgICAgIH0KICAgIH0sCgogICAgYXR0YWNobWVudHNEZXRhaWxzQWNjb3JkaW9uRnVuY3Rpb24odmFsdWUpIHsKICAgICAgaWYgKHRoaXMuJHJlZnMuYXR0YWNobWVudHNEZXRhaWxzQWNjb3JkaW9uLm9wZW5GbGFnID09PSB0cnVlKSB7CiAgICAgICAgdGhpcy4kcmVmcy5hc3NldERldGFpbHNBY2NvcmRpb24ub3BlbkZsYWcgPSBmYWxzZTsKCiAgICAgICAgaWYgKHRoaXMuaXNzdWVzLnN0YXR1cyA9PSAicmVwb3J0ZWQiICYmIHRoaXMuaXNzdWVzLmlucGVjdGlvbkl0ZW1zVVVJRCAhPT0gbnVsbCkgewogICAgICAgICAgdGhpcy4kcmVmcy5pbnNwZWN0aW9uRGV0YWlsc0FjY29yZGlvbi5vcGVuRmxhZyA9IGZhbHNlOwogICAgICAgIH0KCiAgICAgICAgaWYgKHRoaXMuaXNzdWVzLnN0YXR1cyA9PSAiUmVzb2x2ZWQiKSB7CiAgICAgICAgICB0aGlzLiRyZWZzLnBhcnRzRGV0YWlsc0FjY29yZGlvbi5vcGVuRmxhZyA9IGZhbHNlOwogICAgICAgIH0KCiAgICAgICAgdGhpcy4kcmVmcy5pc3N1ZURldGFpbHNBY2NvcmRpb24ub3BlbkZsYWcgPSBmYWxzZTsKCiAgICAgICAgaWYgKHRoaXMuaXNzdWVXb3JrT3JkZXIud29ya09yZGVyTnVtYmVyICE9PSBudWxsICYmIHRoaXMuaXNzdWVXb3JrT3JkZXIuc3RhdHVzICE9PSAiaWdub3JlZCIpIHsKICAgICAgICAgIHRoaXMuJHJlZnMucmVsYXRlZFdvcmtPcmRlckRldGFpbHNBY2NvcmRpb24ub3BlbkZsYWcgPSBmYWxzZTsKICAgICAgICB9CgogICAgICAgIHRoaXMuJHJlZnMucmVsYXRlZElzc3VlRGV0YWlsc0FjY29yZGlvbi5vcGVuRmxhZyA9IGZhbHNlOwogICAgICB9CiAgICB9LAoKICAgIHJlbGF0ZWRXb3JrT3JkZXJEZXRhaWxzQWNjb3JkaW9uRnVuY3Rpb24odmFsdWUpIHsKICAgICAgaWYgKHRoaXMuJHJlZnMucmVsYXRlZFdvcmtPcmRlckRldGFpbHNBY2NvcmRpb24ub3BlbkZsYWcgPT09IHRydWUpIHsKICAgICAgICB0aGlzLiRyZWZzLmFzc2V0RGV0YWlsc0FjY29yZGlvbi5vcGVuRmxhZyA9IGZhbHNlOwoKICAgICAgICBpZiAodGhpcy5pc3N1ZXMuc3RhdHVzID09ICJyZXBvcnRlZCIgJiYgdGhpcy5pc3N1ZXMuaW5wZWN0aW9uSXRlbXNVVUlEICE9PSBudWxsKSB7CiAgICAgICAgICB0aGlzLiRyZWZzLmluc3BlY3Rpb25EZXRhaWxzQWNjb3JkaW9uLm9wZW5GbGFnID0gZmFsc2U7CiAgICAgICAgfQoKICAgICAgICBpZiAodGhpcy5pc3N1ZXMuc3RhdHVzID09ICJSZXNvbHZlZCIpIHsKICAgICAgICAgIHRoaXMuJHJlZnMucGFydHNEZXRhaWxzQWNjb3JkaW9uLm9wZW5GbGFnID0gZmFsc2U7CiAgICAgICAgfQoKICAgICAgICB0aGlzLiRyZWZzLmF0dGFjaG1lbnRzRGV0YWlsc0FjY29yZGlvbi5vcGVuRmxhZyA9IGZhbHNlOwogICAgICAgIHRoaXMuJHJlZnMuaXNzdWVEZXRhaWxzQWNjb3JkaW9uLm9wZW5GbGFnID0gZmFsc2U7CiAgICAgICAgdGhpcy4kcmVmcy5yZWxhdGVkSXNzdWVEZXRhaWxzQWNjb3JkaW9uLm9wZW5GbGFnID0gZmFsc2U7CiAgICAgIH0KICAgIH0sCgogICAgcmVsYXRlZElzc3VlRGV0YWlsc0FjY29yZGlvbkZ1bmN0aW9uKHZhbHVlKSB7CiAgICAgIGlmICh0aGlzLiRyZWZzLnJlbGF0ZWRJc3N1ZURldGFpbHNBY2NvcmRpb24ub3BlbkZsYWcgPT09IHRydWUpIHsKICAgICAgICB0aGlzLiRyZWZzLmFzc2V0RGV0YWlsc0FjY29yZGlvbi5vcGVuRmxhZyA9IGZhbHNlOwoKICAgICAgICBpZiAodGhpcy5pc3N1ZXMuc3RhdHVzID09ICJyZXBvcnRlZCIgJiYgdGhpcy5pc3N1ZXMuaW5wZWN0aW9uSXRlbXNVVUlEICE9PSBudWxsKSB7CiAgICAgICAgICB0aGlzLiRyZWZzLmluc3BlY3Rpb25EZXRhaWxzQWNjb3JkaW9uLm9wZW5GbGFnID0gZmFsc2U7CiAgICAgICAgfQoKICAgICAgICBpZiAodGhpcy5pc3N1ZXMuc3RhdHVzID09ICJSZXNvbHZlZCIpIHsKICAgICAgICAgIHRoaXMuJHJlZnMucGFydHNEZXRhaWxzQWNjb3JkaW9uLm9wZW5GbGFnID0gZmFsc2U7CiAgICAgICAgfQoKICAgICAgICB0aGlzLiRyZWZzLmF0dGFjaG1lbnRzRGV0YWlsc0FjY29yZGlvbi5vcGVuRmxhZyA9IGZhbHNlOwoKICAgICAgICBpZiAodGhpcy5pc3N1ZVdvcmtPcmRlci53b3JrT3JkZXJOdW1iZXIgIT09IG51bGwgJiYgdGhpcy5pc3N1ZVdvcmtPcmRlci5zdGF0dXMgIT09ICJpZ25vcmVkIikgewogICAgICAgICAgdGhpcy4kcmVmcy5yZWxhdGVkV29ya09yZGVyRGV0YWlsc0FjY29yZGlvbi5vcGVuRmxhZyA9IGZhbHNlOwogICAgICAgIH0KCiAgICAgICAgdGhpcy4kcmVmcy5pc3N1ZURldGFpbHNBY2NvcmRpb24ub3BlbkZsYWcgPSBmYWxzZTsKICAgICAgfQogICAgfSwKCiAgICBnZXRGb3JtRXJyb3JNZXNzYWdlKGZpZWxkVmFsaWRhdGlvbikgewogICAgICBpZiAoZmllbGRWYWxpZGF0aW9uLiRkaXJ0eSkgewogICAgICAgIHJldHVybiBGdW5jdGlvbnMuZ2V0Rm9ybUZpZWxkRXJyb3JNZXNzYWdlKGZpZWxkVmFsaWRhdGlvbik7CiAgICAgIH0KICAgIH0sCgogICAgZ2V0VXNlck5hbWUodXNlclVVSUQpIHsKICAgICAgQXNzZXRQZXJzb25uZWxTZXJ2aWNlLmdldE5hbWVPZlVzZXJzQnlVVUlEUyh7CiAgICAgICAgdXVpZHM6IHVzZXJVVUlECiAgICAgIH0pLnRoZW4ocmVzcG9uc2UgPT4gewogICAgICAgIGlmIChyZXNwb25zZS5zdGF0dXMgPT09IDIwMCkgewogICAgICAgICAgdGhpcy5pc3N1ZXMuc3VibWl0dGVkQnlVc2VyTmFtZSA9IHJlc3BvbnNlLmRhdGEudXNlcnNbdGhpcy5pc3N1ZXMuc3VibWl0dGVkQnlVc2VyVVVJRF0ubmFtZTsKICAgICAgICAgIHRoaXMuaXNzdWVJbmRleCsrOwogICAgICAgIH0KICAgICAgfSkuY2F0Y2goZXJyb3IgPT4ge30pOwogICAgfSwKCiAgICBWaWV3SXNzdWUodXVpZCkgewogICAgICB0aGlzLiRyb3V0ZXIucmVwbGFjZSh7CiAgICAgICAgbmFtZTogImlzc3VlLWRldGFpbCIsCiAgICAgICAgcGFyYW1zOiB7CiAgICAgICAgICBpc3N1ZUlEOiB1dWlkCiAgICAgICAgfQogICAgICB9KTsKICAgICAgd2luZG93LmxvY2F0aW9uLnJlbG9hZCgpOwogICAgfSwKCiAgICB2aWV3V29ya09yZGVyKHV1aWQpIHsKICAgICAgdGhpcy4kcm91dGVyLnB1c2goewogICAgICAgIG5hbWU6ICJ3b3JrLW9yZGVyLWRldGFpbHMiLAogICAgICAgIHBhcmFtczogewogICAgICAgICAgd29ya3V1aWQ6IHV1aWQKICAgICAgICB9CiAgICAgIH0pOwogICAgfSwKCiAgICBWaWV3SW5zcGVjdGlvbih1dWlkKSB7CiAgICAgIHRoaXMuJHJvdXRlci5nbyh7CiAgICAgICAgbmFtZTogImluc3BlY3Rpb24tZGV0YWlscyIsCiAgICAgICAgcGFyYW1zOiB7CiAgICAgICAgICBpbnNwZWN0aW9uVVVJRDogdXVpZAogICAgICAgIH0KICAgICAgfSk7CiAgICB9LAoKICAgIGFyY2hpdmVJbnNwZWN0aW9uKHV1aWQpIHsKICAgICAgdGhpcy5pbnNwZWN0aW9uSUQgPSB1dWlkOwogICAgICB0aGlzLmFyY2hpdmVJbnNwZWN0aW9uRGlhbG9nID0gdHJ1ZTsKICAgIH0sCgogICAgZ2V0QXNzZXQoYXNzZXRVVUlEKSB7CiAgICAgIEFzc2V0TWFuYWdlbWVudFNlcnZpY2UuZ2V0QXNzZXRXaXRoRGV0YWlscyhhc3NldFVVSUQsIGZhbHNlLCB0cnVlKS50aGVuKHJlc3BvbnNlID0+IHsKICAgICAgICBpZiAocmVzcG9uc2Uuc3RhdHVzID09IDIwMCkgewogICAgICAgICAgdGhpcy5sb2FkZXJGbGFnID0gZmFsc2U7CiAgICAgICAgICB0aGlzLmlzc3Vlcy5hc3NldE5hbWUgPSByZXNwb25zZS5kYXRhLmFzc2V0RGV0YWlsLmFzc2V0RGV0YWlsLm5hbWU7CiAgICAgICAgICB0aGlzLmFzc2V0TmFtZSA9IHJlc3BvbnNlLmRhdGEuYXNzZXREZXRhaWwuYXNzZXREZXRhaWwubmFtZTsKICAgICAgICAgIHRoaXMubWFudWZhY3R1cmUgPSByZXNwb25zZS5kYXRhLmFzc2V0RGV0YWlsLmFzc2V0RGV0YWlsLm1hbnVmYWN0dXJlOwogICAgICAgICAgdGhpcy5jYXRlZ29yeUluZGV4Kys7CiAgICAgICAgICB0aGlzLnVwZGF0ZVNpZGUrKzsKICAgICAgICAgIHRoaXMuaXNzdWVzLmFzc2V0Q2F0ZWdvcnkgPSByZXNwb25zZS5kYXRhLmFzc2V0RGV0YWlsLmNhdGVnb3J5Lm5hbWU7CiAgICAgICAgICB0aGlzLmlzc3Vlcy5pc3N1ZUluZGV4ID0gdGhpcy5pc3N1ZUluZGV4Kys7IC8vIHRoaXMuZ2V0SXNzdWVzQnlBc3NldFVVSUQocmVzcG9uc2UuZGF0YS5hc3NldC5hc3NldERldGFpbC51dWlkKTsKCiAgICAgICAgICB0aGlzLmdldFBhZ2luYXRlZEFzc2V0UmVsYXRlZElzc3Vlcyh0aGlzLmN1cnJlbnRQYWdlT2ZBc3NldFJlbGF0ZWRJc3N1ZXMsIGFzc2V0VVVJRCk7CiAgICAgICAgICB0aGlzLmNhdGVnb3J5SW5kZXgrKzsKICAgICAgICAgIHRoaXMudXBkYXRlU2lkZSsrOwogICAgICAgICAgdGhpcy5vcGVuRmxhZyA9IHRydWU7IC8vCXRoaXMuaXNzdWVJbmRleCsrOwogICAgICAgIH0KICAgICAgfSkuY2F0Y2goZXJyb3IgPT4ge30pOwogICAgfSwKCiAgICBzZWxlY3RDYXRlKHZhbHVlKSB7CiAgICAgIC8vIHRoaXMudHlwZU9wdGlvbnMgPSBbXTsKICAgICAgLy8gdGhpcy5pc3N1ZVR5cGUgPSAiIjsKICAgICAgLy8gZm9yICgKICAgICAgLy8gICBsZXQgaW5kZXggPSAwOwogICAgICAvLyAgIGluZGV4IDwgdGhpcy5kcm9wRG93bkNvbmZpZ3MuaXNzdWVDYXRlZ29yaWVzLmxlbmd0aDsKICAgICAgLy8gICBpbmRleCsrCiAgICAgIC8vICkgewogICAgICAvLyAgIGlmICh2YWx1ZS52YWx1ZSA9PT0gdGhpcy5kcm9wRG93bkNvbmZpZ3MuaXNzdWVDYXRlZ29yaWVzW2luZGV4XS52YWx1ZSkgewogICAgICAvLyAgICAgZm9yICgKICAgICAgLy8gICAgICAgbGV0IGluZGV4MSA9IDA7CiAgICAgIC8vICAgICAgIGluZGV4MSA8IHRoaXMuZHJvcERvd25Db25maWdzLmlzc3VlQ2F0ZWdvcmllc1tpbmRleF0udHlwZXMubGVuZ3RoOwogICAgICAvLyAgICAgICBpbmRleDErKwogICAgICAvLyAgICAgKSB7CiAgICAgIC8vICAgICAgIGxldCBvYmogPSB7CiAgICAgIC8vICAgICAgICAgbGFiZWw6IHRoaXMuZHJvcERvd25Db25maWdzLmlzc3VlQ2F0ZWdvcmllc1tpbmRleF0udHlwZXNbaW5kZXgxXQogICAgICAvLyAgICAgICAgICAgLmxhYmVsLAogICAgICAvLyAgICAgICAgIHZhbHVlOiB0aGlzLmRyb3BEb3duQ29uZmlncy5pc3N1ZUNhdGVnb3JpZXNbaW5kZXhdLnR5cGVzW2luZGV4MV0KICAgICAgLy8gICAgICAgICAgIC52YWx1ZSwKICAgICAgLy8gICAgICAgfTsKICAgICAgLy8gICAgICAgdGhpcy50eXBlT3B0aW9ucy5wdXNoKG9iaik7CiAgICAgIC8vICAgICB9CiAgICAgIC8vICAgfQogICAgICAvLyB9CiAgICAgIHRoaXMudHlwZU9wdGlvbnMgPSBbXTsKICAgICAgdGhpcy5pc3N1ZVR5cGUgPSAiIjsKCiAgICAgIGZvciAobGV0IHggaW4gdGhpcy5jYXRlT3B0aW9ucykgewogICAgICAgIGlmICh2YWx1ZS52YWx1ZSA9PT0gdGhpcy5jYXRlT3B0aW9uc1t4XS5sYWJlbCAmJiB0aGlzLmNhdGVPcHRpb25zW3hdLm9wdGlvbnMgIT09ICIiKSB7CiAgICAgICAgICB2YXIgc3BsaXRWYWxzID0gdGhpcy5jYXRlT3B0aW9uc1t4XS5vcHRpb25zLnNwbGl0KCIsIik7CgogICAgICAgICAgZm9yIChsZXQgeSBpbiBzcGxpdFZhbHMpIHsKICAgICAgICAgICAgbGV0IG9iaiA9IHsKICAgICAgICAgICAgICBsYWJlbDogc3BsaXRWYWxzW3ldLAogICAgICAgICAgICAgIHZhbHVlOiBzcGxpdFZhbHNbeV0KICAgICAgICAgICAgfTsKICAgICAgICAgICAgdGhpcy50eXBlT3B0aW9ucy5wdXNoKG9iaik7CiAgICAgICAgICB9CiAgICAgICAgfQogICAgICB9CiAgICB9LAoKICAgIGdldFNlcnZpY2VSZXF1ZXN0KHNlcnZpY2VVVUlEKSB7CiAgICAgIEluc3BlY3Rpb25TZXJ2aWNlLmdldFNlcnZpY2VSZXF1ZXN0QnlVVUlEKHNlcnZpY2VVVUlEKS50aGVuKHJlc3BvbnNlID0+IHsKICAgICAgICBpZiAocmVzcG9uc2Uuc3RhdHVzID09PSAyMDApIHsKICAgICAgICAgIHRoaXMuc2VydmljZVJlcXVlc3QgPSByZXNwb25zZS5kYXRhLnNlcnZpY2VSZXF1ZXN0OwogICAgICAgICAgdGhpcy5zZXJ2aWNlSW5kZXgrKzsKICAgICAgICB9CiAgICAgIH0pLmNhdGNoKGVycm9yID0+IHt9KTsKICAgIH0sCgogICAgZ2V0SW5zcGVjdGlvbihpbnNwZWN0aW9uVVVJRCkgewogICAgICBJbnNwZWN0aW9uU2VydmljZS5nZXRJbnNwZWN0aW9uUmVwb3J0QnlVVUlEKGluc3BlY3Rpb25VVUlEKS50aGVuKHJlc3BvbnNlID0+IHsKICAgICAgICBpZiAocmVzcG9uc2Uuc3RhdHVzID09PSAyMDApIHsKICAgICAgICAgIHRoaXMuaW5zcGVjdGlvblJlcG9ydCA9IHJlc3BvbnNlLmRhdGEuaW5zcGVjdGlvblJlcG9ydDsKICAgICAgICAgIHRoaXMuaW5zcGVjdGlvbkluZGV4Kys7CiAgICAgICAgfQogICAgICB9KS5jYXRjaChlcnJvciA9PiB7fSk7CiAgICB9LAoKICAgIGdldEFsbENhdGVnb3JpZXMoY3VycmVudFVzZXJEZXRhaWxzKSB7CiAgICAgIEFzc2V0TWFuYWdlbWVudFNlcnZpY2UuZ2V0QWxsQXNzZXRDYXRlZ29yaWVzKGN1cnJlbnRVc2VyRGV0YWlscy5wcm9maWxlLm9yZ2FuaXphdGlvbklkKS50aGVuKHJlcyA9PiB7CiAgICAgICAgdGhpcy5jYXRlZ29yeUxpc3QgPSByZXMuZGF0YS5jYXRlZ29yaWVzOwoKICAgICAgICBmb3IgKGxldCBpbmRleCA9IDA7IGluZGV4IDwgcmVzLmRhdGEuY2F0ZWdvcmllcy5sZW5ndGg7IGluZGV4KyspIHsKICAgICAgICAgIGxldCBvYmogPSB7CiAgICAgICAgICAgIGlkOiByZXMuZGF0YS5jYXRlZ29yaWVzW2luZGV4XS5pZCwKICAgICAgICAgICAgY2F0ZWdvcnlVVUlEOiByZXMuZGF0YS5jYXRlZ29yaWVzW2luZGV4XS51dWlkLAogICAgICAgICAgICBsYWJlbDogcmVzLmRhdGEuY2F0ZWdvcmllc1tpbmRleF0ubmFtZQogICAgICAgICAgfTsKICAgICAgICAgIHRoaXMuYXNzZXRDYXRlZ29yeU9wdGlvbnMucHVzaChvYmopOwogICAgICAgIH0KCiAgICAgICAgdGhpcy5nZXRBbGxBc3NldChjdXJyZW50VXNlckRldGFpbHMpOwogICAgICB9KS5jYXRjaChlcnIgPT4gewogICAgICAgIGNvbnNvbGUubG9nKGVycik7CiAgICAgIH0pOwogICAgfSwKCiAgICBnZXRBbGxBc3NldChjdXJyZW50VXNlckRldGFpbHMpIHsKICAgICAgbGV0IGNhdGVnb3J5VVVJRCA9ICIiOwogICAgICBBc3NldE1hbmFnZW1lbnRTZXJ2aWNlLmdldEFsbEFzc2V0cyhjdXJyZW50VXNlckRldGFpbHMucHJvZmlsZS5vcmdhbml6YXRpb25JZCkudGhlbihyZXMgPT4gewogICAgICAgIGZvciAobGV0IGluZGV4ID0gMDsgaW5kZXggPCByZXMuZGF0YS5hc3NldHMubGVuZ3RoOyBpbmRleCsrKSB7CiAgICAgICAgICBsZXQgb2JqID0gewogICAgICAgICAgICB1dWlkOiByZXMuZGF0YS5hc3NldHNbaW5kZXhdLnV1aWQsCiAgICAgICAgICAgIGNhdGVnb3J5VVVJRDogcmVzLmRhdGEuYXNzZXRzW2luZGV4XS5jYXRlZ29yeVVVSUQsCiAgICAgICAgICAgIGxhYmVsOiByZXMuZGF0YS5hc3NldHNbaW5kZXhdLm5hbWUsCiAgICAgICAgICAgIHR5cGU6IHJlcy5kYXRhLmFzc2V0c1tpbmRleF0udHlwZSwKICAgICAgICAgICAgYXNzZXROdW1iZXI6IHJlcy5kYXRhLmFzc2V0c1tpbmRleF0uYXNzZXROdW1iZXIKICAgICAgICAgIH07CiAgICAgICAgICB0aGlzLmFsbEFzc2V0RGF0YS5wdXNoKG9iaik7CiAgICAgICAgfQoKICAgICAgICBpZiAodGhpcy4kcm91dGUucGFyYW1zLmNyZWF0ZVdvcmtPcmRlciA9PT0gdHJ1ZSkgewogICAgICAgICAgZm9yIChsZXQgaW5kZXggPSAwOyBpbmRleCA8IHRoaXMuYWxsQXNzZXREYXRhLmxlbmd0aDsgaW5kZXgrKykgewogICAgICAgICAgICBpZiAodGhpcy4kcm91dGUucGFyYW1zLmFzc2V0VVVJRCA9PT0gdGhpcy5hbGxBc3NldERhdGFbaW5kZXhdLnV1aWQpIHsKICAgICAgICAgICAgICBjYXRlZ29yeVVVSUQgPSB0aGlzLmFsbEFzc2V0RGF0YVtpbmRleF0uY2F0ZWdvcnlVVUlEOwogICAgICAgICAgICB9CiAgICAgICAgICB9CgogICAgICAgICAgZm9yIChsZXQgaW5keCA9IDA7IGluZHggPCB0aGlzLmFzc2V0Q2F0ZWdvcnlPcHRpb25zLmxlbmd0aDsgaW5keCsrKSB7CiAgICAgICAgICAgIGlmICh0aGlzLmFzc2V0Q2F0ZWdvcnlPcHRpb25zW2luZHhdLmNhdGVnb3J5VVVJRCA9PT0gY2F0ZWdvcnlVVUlEKSB7CiAgICAgICAgICAgICAgdGhpcy53b3JrT3JkZXJTdW1hcnkuY2F0ZWdvcnkgPSB0aGlzLmFzc2V0Q2F0ZWdvcnlPcHRpb25zW2luZHhdLmxhYmVsOwogICAgICAgICAgICB9CiAgICAgICAgICB9CgogICAgICAgICAgZm9yIChsZXQgaiA9IDA7IGogPCB0aGlzLmFsbEFzc2V0RGF0YS5sZW5ndGg7IGorKykgewogICAgICAgICAgICBpZiAodGhpcy5hbGxBc3NldERhdGFbal0uY2F0ZWdvcnlVVUlEID09PSBjYXRlZ29yeVVVSUQpIHsKICAgICAgICAgICAgICB0aGlzLndvcmtPcmRlclN1bWFyeS5uYW1lID0gdGhpcy5hbGxBc3NldERhdGFbal0ubGFiZWw7CiAgICAgICAgICAgICAgdGhpcy5hc3NldE5hbWVzLnB1c2godGhpcy5hbGxBc3NldERhdGFbal0pOwogICAgICAgICAgICB9CiAgICAgICAgICB9CgogICAgICAgICAgdGhpcy5jYXRlZ29yeUluZGV4Kys7CiAgICAgICAgICB0aGlzLmFzc2V0SW5kZXgrKzsKICAgICAgICB9CiAgICAgIH0pLmNhdGNoKGVyciA9PiB7CiAgICAgICAgY29uc29sZS5sb2coZXJyKTsKICAgICAgfSk7CiAgICB9LAoKICAgIGRlbGV0ZUlzc3VlSW1hZ2UodXVpZCkgewogICAgICBJbnNwZWN0aW9uU2VydmljZS5kZWxldGVJc3N1ZUltYWdlKHV1aWQpLnRoZW4ocmVzID0+IHsKICAgICAgICBpZiAocmVzLnN0YXR1cyA9PT0gMjAwKSB7CiAgICAgICAgICB0aGlzLnNob3dUb2FzdCgiSW1hZ2UgcmVtb3ZlZCBzdWNjZXNzZnVsbHkiLCAic3VjY2VzcyIpOwogICAgICAgICAgdGhpcy5nZXRJc3N1ZURldGFpbHMoKTsKICAgICAgICB9CiAgICAgIH0pLmNhdGNoKGUgPT4ge30pOwogICAgfSwKCiAgICB1cGRhdGVJc3N1ZSgpIHsKICAgICAgdGhpcy4kdi4kdG91Y2goKTsKCiAgICAgIGlmICh0aGlzLiR2LiRpbnZhbGlkKSB7CiAgICAgICAgdGhpcy5zaG93VG9hc3QoIlBsZWFzZSBmaWxsIGFsbCByZXF1aXJlZCBmaWVsZHMiLCAid2FybmluZyIpOwogICAgICAgIHJldHVybjsKICAgICAgfQoKICAgICAgdGhpcy5sb2FkZXJGbGFnID0gdHJ1ZTsKICAgICAgdGhpcy5pc3N1ZXMucmVwb3J0ZWRBdCA9IG1vbWVudCh0aGlzLmlzc3Vlcy5yZXBvcnRlZEF0KS50b0lTT1N0cmluZygpOwogICAgICB0aGlzLmlzc3Vlcy5hc3NldENhdGVnb3J5ID0gdGhpcy5hc3NldEluZm8udHlwZTsKICAgICAgdGhpcy5pc3N1ZXMuYXNzZXROdW1iZXIgPSB0aGlzLmFzc2V0SW5mby5hc3NldE51bWJlcjsKICAgICAgdGhpcy5pc3N1ZXMuYXNzZXROYW1lID0gdGhpcy5hc3NldEluZm8ubGFiZWw7CiAgICAgIHRoaXMuaXNzdWVzLmFzc2V0VVVJRCA9IHRoaXMub2JqQXNzZXRVVUlEOwogICAgICBsZXQgdXBkYXRlSXNzdWVSZXF1ZXN0ID0gewogICAgICAgIGlzc3VlUmVwb3J0aW5nOiB0aGlzLmlzc3VlcywKICAgICAgICBpbWFnZVZvaWNlczogW10KICAgICAgfTsKCiAgICAgIGlmICh0aGlzLmZpbGVSZWNvcmQgIT09IG51bGwpIHsKICAgICAgICAvL21lYW5zIGZpbGUgaXMgYXR0YWNoZWQgdG8gaXQKICAgICAgICB1cGRhdGVJc3N1ZVJlcXVlc3QuaW1hZ2VWb2ljZXMgPSB0aGlzLmZpbGVVcGxvYWQ7CiAgICAgICAgSW5zcGVjdGlvblNlcnZpY2UudXBkYXRlSXNzdWUodXBkYXRlSXNzdWVSZXF1ZXN0KS50aGVuKHJlc3BvbnNlID0+IHsKICAgICAgICAgIGlmIChyZXNwb25zZS5zdGF0dXMgPT09IDIwMCkgewogICAgICAgICAgICB0aGlzLmxvYWRlckZsYWcgPSBmYWxzZTsKICAgICAgICAgICAgdGhpcy4kcm91dGVyLnB1c2goewogICAgICAgICAgICAgIG5hbWU6ICJpc3N1ZXMiLAogICAgICAgICAgICAgIHBhcmFtczogewogICAgICAgICAgICAgICAgdG9hc3RGbGFnOiB0cnVlLAogICAgICAgICAgICAgICAgdG9hc3N0TWVzc2FnZTogIklzc3VlIFVwZGF0ZWQgU3VjY2Vzc2Z1bGx5IiwKICAgICAgICAgICAgICAgIHRvYXN0VHlwZTogInN1Y2Nlc3MiCiAgICAgICAgICAgICAgfQogICAgICAgICAgICB9KTsKICAgICAgICAgIH0KICAgICAgICB9KS5jYXRjaChlcnJvciA9PiB7CiAgICAgICAgICB0aGlzLnNob3dUb2FzdChlcnJvci5kYXRhLnJlc3BvbnNlLCAiZXJyb3IiKTsKICAgICAgICB9KTsKICAgICAgfSBlbHNlIGlmICh0aGlzLmZpbGVSZWNvcmQgPT0gbnVsbCkgewogICAgICAgIEluc3BlY3Rpb25TZXJ2aWNlLnVwZGF0ZUlzc3VlKHVwZGF0ZUlzc3VlUmVxdWVzdCkudGhlbihyZXNwb25zZSA9PiB7CiAgICAgICAgICBpZiAocmVzcG9uc2Uuc3RhdHVzID09PSAyMDApIHsKICAgICAgICAgICAgdGhpcy5sb2FkZXJGbGFnID0gZmFsc2U7CiAgICAgICAgICAgIHRoaXMuJHJvdXRlci5wdXNoKHsKICAgICAgICAgICAgICBuYW1lOiAiaXNzdWVzIiwKICAgICAgICAgICAgICBwYXJhbXM6IHsKICAgICAgICAgICAgICAgIHRvYXN0RmxhZzogdHJ1ZSwKICAgICAgICAgICAgICAgIHRvYXNzdE1lc3NhZ2U6ICJJc3N1ZSBVcGRhdGVkIFN1Y2Nlc3NmdWxseSIsCiAgICAgICAgICAgICAgICB0b2FzdFR5cGU6ICJzdWNjZXNzIgogICAgICAgICAgICAgIH0KICAgICAgICAgICAgfSk7CiAgICAgICAgICB9CiAgICAgICAgfSkuY2F0Y2goZXJyb3IgPT4gewogICAgICAgICAgdGhpcy5zaG93VG9hc3QoZXJyb3IuZGF0YS5yZXNwb25zZSwgImVycm9yIik7CiAgICAgICAgfSk7CiAgICAgIH0KICAgIH0sCgogICAgcGFnaW5hdGlvbk9mSXNzdWVDYXRlZ29yeVJlbGF0ZWRJc3N1ZSh2YWwpIHsKICAgICAgdGhpcy5nZXRQYWdpbmF0ZWRJc3N1ZUNhdGVnb3J5UmVsYXRlZElzc3Vlcyh2YWwsIHRoaXMuaXNzdWVDYXRlZ29yeSk7CiAgICB9LAoKICAgIGdldFBhZ2luYXRlZElzc3VlQ2F0ZWdvcnlSZWxhdGVkSXNzdWVzKHZhbCwgaXNzdWVDYXRlZ29yeSkgewogICAgICBsZXQgcmVxdWVzdCA9IHsKICAgICAgICBpc3N1ZUNhdGVnb3J5OiBpc3N1ZUNhdGVnb3J5LAogICAgICAgIG9mZnNldDogdmFsIC0gMSwKICAgICAgICBsaW1pdDogdGhpcy5yb3dzUGVyUGFnZU9mSXNzdWVDYXRlZ29yeVJlbHRlZElzc3VlLAogICAgICAgIHRlbmFudFVVSUQ6IHRoaXMuY3VycmVudFVzZXJEZXRhaWxzLnByb2ZpbGUub3JnYW5pemF0aW9uSWQsCiAgICAgICAgaXNzdWVVVUlEOiB0aGlzLiRyb3V0ZS5wYXJhbXMuaXNzdWVJRAogICAgICB9OwogICAgICBJbnNwZWN0aW9uU2VydmljZS5nZXRQYWdpbmF0ZWRJc3N1ZUNhdGVnb3J5UmVsYXRlZElzc3VlcyhyZXF1ZXN0KS50aGVuKHJlc3BvbnNlID0+IHsKICAgICAgICBpZiAocmVzcG9uc2Uuc3RhdHVzID09PSAyMDApIHsKICAgICAgICAgIHRoaXMubnVtYmVyT2ZwYWdlT2ZJc3N1ZUNhdGVnb3J5UmVsYXRlZElzc3VlcyA9IHJlc3BvbnNlLmRhdGEuaXNzdWVSZXBvcnRpbmdzLnRvdGFsUGFnZXM7CiAgICAgICAgICB0aGlzLmlzc3Vlc09iaiA9IHJlc3BvbnNlLmRhdGEuaXNzdWVSZXBvcnRpbmdzLmNvbnRlbnQ7CiAgICAgICAgICB0aGlzLmlzc3Vlc09iai5tYXAob2JqID0+IHsKICAgICAgICAgICAgb2JqLnJlcG9ydGVkQXQgPSBtb21lbnQob2JqLnJlcG9ydGVkQXQpLmZvcm1hdCgiREQgTU1NIFlZWVkgIGhoOm1tIGEiKTsKICAgICAgICAgIH0pOwogICAgICAgIH0KICAgICAgfSkuY2F0Y2goZXJyb3IgPT4gewogICAgICAgIGNvbnNvbGUubG9nKGVycm9yKTsgLy8gYXMgbm8gc25hY2sgYmFyIGNvbXBvbmVudCBpcyBtYWRlIHNvIHVzaW5nIGNvbnNvbGUgZm9yIHRoaXMuCiAgICAgIH0pOwogICAgfSwKCiAgICBnZXRJc3N1ZURldGFpbHMoKSB7CiAgICAgIHRoaXMubG9hZGVyRmxhZyA9IHRydWU7CiAgICAgIEluc3BlY3Rpb25TZXJ2aWNlLmdldElzc3VlQnlVVUlEKHRoaXMuJHJvdXRlLnBhcmFtcy5pc3N1ZUlEKS50aGVuKHJlc3BvbnNlID0+IHsKICAgICAgICB0aGlzLmltYWdlVm9pY2VzID0gcmVzcG9uc2UuZGF0YS5pbWFnZVZvaWNlczsKCiAgICAgICAgaWYgKHJlc3BvbnNlLnN0YXR1cyA9PT0gMjAwKSB7CiAgICAgICAgICAvLyBjb25zb2xlLmxvZygncmVzcG9uc2UnLHJlc3BvbnNlKQogICAgICAgICAgdGhpcy5pc3N1ZXMgPSByZXNwb25zZS5kYXRhLmlzc3VlUmVwb3J0aW5nOwogICAgICAgICAgdGhpcy5zdWJtaXR0ZWRieVVzZXJVVUlEID0gdGhpcy5pc3N1ZXMuc3VibWl0dGVkQnlVc2VyVVVJRDsKICAgICAgICAgIHRoaXMuaXNzdWVDYXRlZ29yeSA9IHRoaXMuaXNzdWVzLmlzc3VlQ2F0ZWdvcnk7CiAgICAgICAgICB0aGlzLmlzc3VlU3RhdHVzID0gdGhpcy5pc3N1ZXMuc3RhdHVzOwoKICAgICAgICAgIGlmICh0aGlzLmlzc3VlU3RhdHVzID09ICJyZXBvcnRlZCIpIHsKICAgICAgICAgICAgdGhpcy5hc3NldEZpZWxkc0Rpc2FibGUgPSBmYWxzZTsKICAgICAgICAgIH0KCiAgICAgICAgICB0aGlzLmdldFVzZXJOYW1lKFt0aGlzLmlzc3Vlcy5zdWJtaXR0ZWRCeVVzZXJVVUlEXSk7CiAgICAgICAgICB0aGlzLmdldEFzc2V0KHRoaXMuaXNzdWVzLmFzc2V0VVVJRCk7CiAgICAgICAgICB0aGlzLmlzc3Vlcy5yZXBvcnRlZEF0ID0gbW9tZW50KHRoaXMuaXNzdWVzLnJlcG9ydGVkQXQpLmZvcm1hdCgiREQgTU1NIFlZWVkiKTsKICAgICAgICAgIGRvY3VtZW50LnRpdGxlID0gdGhpcy5pc3N1ZXMuaXNzdWVOdW1iZXIgKyAiIHwgIiArICJFcm9oYWwiOwogICAgICAgICAgdGhpcy5nZXRQYWdpbmF0ZWRJc3N1ZUNhdGVnb3J5UmVsYXRlZElzc3Vlcyh0aGlzLmN1cnJlbnRQYWdlT2ZJc3N1ZUNhdGVnb3J5UmVsYXRlZElzc3VlcywgdGhpcy5pc3N1ZUNhdGVnb3J5KTsKCiAgICAgICAgICBpZiAodGhpcy5pc3N1ZVN0YXR1cy50b0xvd2VyQ2FzZSgpID09PSAiaW5wcm9ncmVzcyIgfHwgdGhpcy5pc3N1ZVN0YXR1cy50b0xvd2VyQ2FzZSgpID09PSAicmVzb2x2ZWQiKSB7CiAgICAgICAgICAgIHRoaXMuZmllbGRzRGlzYWJsZSA9IHRydWU7CiAgICAgICAgICB9IC8vIEluc3BlY3Rpb25TZXJ2aWNlLmdldFBhZ2luYXRlZElzc3VlcygKICAgICAgICAgIC8vIAlbXSwKICAgICAgICAgIC8vIAkicmVwb3J0ZWRBdCIsCiAgICAgICAgICAvLyAJImRlc2MiLAogICAgICAgICAgLy8gCTAsCiAgICAgICAgICAvLyAJMTAwMDAsCiAgICAgICAgICAvLyAJdGhpcy5jdXJyZW50VXNlckRldGFpbHMucHJvZmlsZS5vcmdhbml6YXRpb25JZAogICAgICAgICAgLy8gKS50aGVuKChyZXMpID0+IHsKICAgICAgICAgIC8vIAlmb3IgKAogICAgICAgICAgLy8gCQlsZXQgaW5kZXggPSAwOwogICAgICAgICAgLy8gCQlpbmRleCA8IHJlcy5kYXRhLmlzc3VlUmVwb3J0aW5ncy5jb250ZW50Lmxlbmd0aDsKICAgICAgICAgIC8vIAkJaW5kZXgrKwogICAgICAgICAgLy8gCSkgewogICAgICAgICAgLy8gCQlpZiAoCiAgICAgICAgICAvLyAJCQl0aGlzLmlzc3VlQ2F0ZWdvcnkgPT09CiAgICAgICAgICAvLyAJCQlyZXMuZGF0YS5pc3N1ZVJlcG9ydGluZ3MuY29udGVudFtpbmRleF0uaXNzdWVDYXRlZ29yeQogICAgICAgICAgLy8gCQkpIHsKICAgICAgICAgIC8vIAkJCXJlcy5kYXRhLmlzc3VlUmVwb3J0aW5ncy5jb250ZW50W2luZGV4XS5yZXBvcnRlZEF0ID0gbW9tZW50KAogICAgICAgICAgLy8gCQkJCXJlcy5kYXRhLmlzc3VlUmVwb3J0aW5ncy5jb250ZW50W2luZGV4XS5yZXBvcnRlZEF0CiAgICAgICAgICAvLyAJCQkpLmZvcm1hdCgiREQgTU1NIFlZWVkgIGhoOm1tIGEiKTsKICAgICAgICAgIC8vIAkJCXRoaXMuaXNzdWVzT2JqLnB1c2gocmVzLmRhdGEuaXNzdWVSZXBvcnRpbmdzLmNvbnRlbnRbaW5kZXhdKTsKICAgICAgICAgIC8vIAkJfQogICAgICAgICAgLy8gCX0KICAgICAgICAgIC8vIH0pOwogICAgICAgICAgLy8JY29uc29sZS5sb2coInNlcnZpY2UgcmVxdWVzdCIsIHRoaXMuaXNzdWVzLnNlcnZpY2VVVUlEKTsKCgogICAgICAgICAgaWYgKHRoaXMuaXNzdWVzLnNlcnZpY2VVVUlEICE9PSBudWxsKSB7CiAgICAgICAgICAgIHRoaXMuZ2V0U2VydmljZVJlcXVlc3QodGhpcy5pc3N1ZXMuc2VydmljZVVVSUQpOwogICAgICAgICAgfQoKICAgICAgICAgIGlmICh0aGlzLmlzc3Vlcy5pbnNwZWN0aW9uVVVJRCAhPT0gbnVsbCkgewogICAgICAgICAgICB0aGlzLmdldEluc3BlY3Rpb24odGhpcy5pc3N1ZXMuaW5zcGVjdGlvblVVSUQpOwogICAgICAgICAgfQogICAgICAgIH0KICAgICAgfSkuY2F0Y2goZXJyb3IgPT4ge30pOwogICAgfSwKCiAgICBvcGVuQ3JlYXRlSW5zcGVjdGlvblRlbXBsYXRlKCkgewogICAgICB0aGlzLiRyb3V0ZXIucHVzaCh7CiAgICAgICAgbmFtZTogImNyZWF0ZS1pbnNwZWN0aW9uLXRlbXBsYXRlIgogICAgICB9KTsKICAgIH0sCgogICAgc2hvd1RvYXN0KG1lc3NhZ2UsIHR5cGUpIHsKICAgICAgdGhpcy50b2FzdE1lc3NhZ2UgPSBtZXNzYWdlOwogICAgICB0aGlzLnRvYXN0VHlwZSA9IHR5cGU7CiAgICAgIHRoaXMudG9hc3RGbGFnKys7CiAgICB9CgogIH0sCiAgd2F0Y2g6IHt9LAoKICBjcmVhdGVkKCkgewogICAgdGhpcy5nZXRJc3N1ZURldGFpbHMoKTsKICAgIHRoaXMudXVpZCA9IHRoaXMuJHJvdXRlLnBhcmFtcy5pc3N1ZUlEOwogICAgdGhpcy5maWVsZHNEaXNhYmxlID0gdGhpcy4kcm91dGUucGFyYW1zLmZsYWc7CiAgICB0aGlzLmN1cnJlbnRVc2VyRGV0YWlscyA9IEpTT04ucGFyc2UobG9jYWxTdG9yYWdlLmdldEl0ZW0oImN1cnJlbnRVc2VyRGV0YWlscyIpKTsKICAgIHRoaXMuZ2V0QWxsQ2F0ZWdvcmllcyh0aGlzLmN1cnJlbnRVc2VyRGV0YWlscyk7IC8vIHRoaXMuZ2V0QWxsQXNzZXQodGhpcy5jdXJyZW50VXNlckRldGFpbHMpOwoKICAgIHRoaXMuZ2V0Q3VycmVuY3koKTsKICAgIHRoaXMuZ2V0UGFydHNCeVVVSWQodGhpcy4kcm91dGUucGFyYW1zLmlzc3VlSUQpOwogICAgdGhpcy5nZXRDb3N0QnlVVUlEKHRoaXMuJHJvdXRlLnBhcmFtcy5pc3N1ZUlEKTsKICAgIHRoaXMuZ2V0SW5zcGVjdGlvbmJ5SXNzdWVVVUlEKHRoaXMuJHJvdXRlLnBhcmFtcy5pc3N1ZUlEKTsKICAgIHRoaXMuZ2V0V29ya09yZGVyQnlpc3N1ZVVVSUQodGhpcy4kcm91dGUucGFyYW1zLmlzc3VlSUQpOyAvLyB0aGlzLmRyb3BEb3duQ29uZmlncyA9IEpTT04ucGFyc2UobG9jYWxTdG9yYWdlLmdldEl0ZW0oImRyb3BEb3duQ29uZmlncyIpKTsKICAgIC8vIGZvciAoCiAgICAvLyAgIGxldCBpbmRleCA9IDA7CiAgICAvLyAgIGluZGV4IDwgdGhpcy5kcm9wRG93bkNvbmZpZ3MuaXNzdWVDYXRlZ29yaWVzLmxlbmd0aDsKICAgIC8vICAgaW5kZXgrKwogICAgLy8gKSB7CiAgICAvLyAgIGxldCBvYmogPSB7CiAgICAvLyAgICAgbGFiZWw6IHRoaXMuZHJvcERvd25Db25maWdzLmlzc3VlQ2F0ZWdvcmllc1tpbmRleF0ubGFiZWwsCiAgICAvLyAgICAgdmFsdWU6IHRoaXMuZHJvcERvd25Db25maWdzLmlzc3VlQ2F0ZWdvcmllc1tpbmRleF0udmFsdWUsCiAgICAvLyAgIH07CiAgICAvLyAgIHRoaXMuY2F0ZWdvcnlPcHRpb25zLnB1c2gob2JqKTsKICAgIC8vIH0KCiAgICB0aGlzLmdldFBhcnRzKHRoaXMuJHJvdXRlLnBhcmFtcy5pc3N1ZUlEKTsKICAgIHRoaXMuZ2V0Q29zdHModGhpcy4kcm91dGUucGFyYW1zLmlzc3VlSUQpOyAvLwl0aGlzLiRyZWZzLmlzc3VlRGV0YWlsc0FjY29yZGlvbi5vcGVuRmxhZyA9PT0gdHJ1ZTsKICB9LAoKICB2YWxpZGF0aW9uczogZnVuY3Rpb24gKCkgewogICAgcmV0dXJuIHsKICAgICAgaXNzdWVzOiB7CiAgICAgICAgaXNzdWVOYW1lOiB7CiAgICAgICAgICByZXF1aXJlZCwKICAgICAgICAgIG1heExlbmd0aDogbWF4TGVuZ3RoKDE5MCkKICAgICAgICB9LAogICAgICAgIGlzc3VlVHlwZTogewogICAgICAgICAgcmVxdWlyZWQKICAgICAgICB9LAogICAgICAgIGlzc3VlQ2F0ZWdvcnk6IHsKICAgICAgICAgIHJlcXVpcmVkCiAgICAgICAgfSwKICAgICAgICBwcmlvcml0eTogewogICAgICAgICAgcmVxdWlyZWQKICAgICAgICB9LAogICAgICAgIGlzc3VlRGVzY3JpcHRpb246IHsKICAgICAgICAgIG1heExlbmd0aDogbWF4TGVuZ3RoKDUwMCkKICAgICAgICB9LAogICAgICAgIGlnbm9yZUNvbW1lbnRzOiB7CiAgICAgICAgICBtYXhMZW5ndGg6IG1heExlbmd0aCg1MDApCiAgICAgICAgfQogICAgICB9CiAgICB9OwogIH0KfTs="},null]}