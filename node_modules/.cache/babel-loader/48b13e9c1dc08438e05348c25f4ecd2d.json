{"remainingRequest":"/home/alsharqi/Desktop/Deploy Fe-ui/fe-erohal-ui/node_modules/babel-loader/lib/index.js!/home/alsharqi/Desktop/Deploy Fe-ui/fe-erohal-ui/node_modules/cache-loader/dist/cjs.js??ref--1-0!/home/alsharqi/Desktop/Deploy Fe-ui/fe-erohal-ui/node_modules/vue-loader/lib/index.js??vue-loader-options!/home/alsharqi/Desktop/Deploy Fe-ui/fe-erohal-ui/src/views/calendar/components/WorkOrderAssignment.vue?vue&type=script&lang=js&","dependencies":[{"path":"/home/alsharqi/Desktop/Deploy Fe-ui/fe-erohal-ui/src/views/calendar/components/WorkOrderAssignment.vue","mtime":1661968702432},{"path":"/home/alsharqi/Desktop/Deploy Fe-ui/fe-erohal-ui/babel.config.js","mtime":1661968702388},{"path":"/home/alsharqi/Desktop/Deploy Fe-ui/fe-erohal-ui/node_modules/cache-loader/dist/cjs.js","mtime":499162500000},{"path":"/home/alsharqi/Desktop/Deploy Fe-ui/fe-erohal-ui/node_modules/babel-loader/lib/index.js","mtime":315532800000},{"path":"/home/alsharqi/Desktop/Deploy Fe-ui/fe-erohal-ui/node_modules/cache-loader/dist/cjs.js","mtime":499162500000},{"path":"/home/alsharqi/Desktop/Deploy Fe-ui/fe-erohal-ui/node_modules/vue-loader/lib/index.js","mtime":1655715099000}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:Ly9pbXBvcnQgV29ya09yZGVyU2lkZWJhciBmcm9tICIuLi93b3JrLW9yZGVycy9jb21wb25lbnRzL1dvcmtPcmRlclNpZGViYXIiOwppbXBvcnQgQXNzZXRQZXJzb25uZWxTZXJ2aWNlIGZyb20gIi4uLy4uLy4uL3NlcnZpY2VzL0Fzc2V0UGVyc29ubmVsU2VydmljZSI7CmltcG9ydCBJbnNwZWN0aW9uU2VydmljZSBmcm9tICIuLi8uLi8uLi9zZXJ2aWNlcy9JbnNwZWN0aW9uU2VydmljZSI7CmltcG9ydCBBc3NldE1hbmFnZW1lbnRTZXJ2aWNlIGZyb20gIi4uLy4uLy4uL3NlcnZpY2VzL0Fzc2V0TWFuYWdlbWVudFNlcnZpY2UiOwppbXBvcnQgV29ya09yZGVyU2VydmljZSBmcm9tICIuLi8uLi8uLi9zZXJ2aWNlcy9Xb3JrT3JkZXJTZXJ2aWNlIjsKaW1wb3J0IG1vbWVudCBmcm9tICJtb21lbnQiOwppbXBvcnQgeyBGdW5jdGlvbnMgfSBmcm9tICJAL3NoYXJlZC9GdW5jdGlvbnMiOwppbXBvcnQgeyByZXF1aXJlZCB9IGZyb20gInZ1ZWxpZGF0ZS9saWIvdmFsaWRhdG9ycyI7CmltcG9ydCBsb2FkZXIgZnJvbSAiQC9jb21wb25lbnRzL0xvYWRlci52dWUiOwpleHBvcnQgZGVmYXVsdCB7CiAgbmFtZTogIkNyZWF0ZVdvcmtPcmRlciIsCiAgY29tcG9uZW50czogewogICAgLy8gV29ya09yZGVyU2lkZWJhciwKICAgIGxvYWRlcgogIH0sCgogIGRhdGEoKSB7CiAgICByZXR1cm4gewogICAgICBsb2FkZXJGbGFnOiBmYWxzZSwKCiAgICAgIC8qIFRvYXN0IFByb3BlcnRpZXMgKi8KICAgICAgdG9hc3RUaW1lT3V0OiAzMDAwLAogICAgICB0b2FzdE1lc3NhZ2U6ICIiLAogICAgICB0b2FzdFR5cGU6ICIiLAogICAgICB0b2FzdEZsYWc6IDAsCgogICAgICAvKiBUb2FzdCBQcm9wZXJ0aWVzICovCiAgICAgIHVwZGF0ZVNlbGVjdENvbXA6IDAsCiAgICAgIHRvdGFsQ29zdDogMCwKICAgICAgc2FtZTogdHJ1ZSwKICAgICAgd29ya09yZGVyU3VtbWFyeUluZGV4OiAwLAogICAgICBpbml0aWFsQXNzZXRJbmRleDogMCwKICAgICAgaW5zcGVjdGlvblJlc2V0OiAwLAogICAgICBmaW5hbEluc3BlY3Rpb25SZXNldDogMCwKICAgICAgdXNlclJlc2V0OiAwLAogICAgICBjYXRlZ29yeUluZGV4OiAwLAogICAgICBhc3NldEluZGV4OiAwLAogICAgICBpc3N1ZUluZGV4OiAwLAogICAgICBjdXJyZW50VXNlckRldGFpbHM6IG51bGwsCiAgICAgIGRpc2JhYmxlZmllbGQ6IGZhbHNlLAogICAgICBwcmlvcml0eU9wdGlvbnM6IFt7CiAgICAgICAgbGFiZWw6ICJMb3ciCiAgICAgIH0sIHsKICAgICAgICBsYWJlbDogIk1lZGl1bSIKICAgICAgfSwgewogICAgICAgIGxhYmVsOiAiSGlnaCIKICAgICAgfV0sCiAgICAgIHNoaWZ0T3B0aW9uczogW3sKICAgICAgICBsYWJlbDogIk1vcm5pbmciCiAgICAgIH0sIHsKICAgICAgICBsYWJlbDogIkFmdGVybm9vbiIKICAgICAgfSwgewogICAgICAgIGxhYmVsOiAiRXZlbmluZyIKICAgICAgfV0sCiAgICAgIHNlbGVjdGVkVXNlckdyb3VwOiAiIiwKICAgICAgdXNlckdyb3VwT3B0aW9uczogW10sCiAgICAgIHNlbGVjdGVkVXNlcjogIiIsCiAgICAgIHVzZXJPcHRpb25zOiBbXSwKICAgICAgYWxsVXNlcnM6IFtdLAogICAgICBhc3NldHM6IG51bGwsCiAgICAgIHdvcmtPcmRlclN1bW1hcnk6IHsKICAgICAgICBwcmlvcml0eTogIiIsCiAgICAgICAgc2hpZnQ6ICIiLAogICAgICAgIHNoZWR1bGU6ICIiLAogICAgICAgIHVzZXJHcm91cDogIiIsCiAgICAgICAgdXNlcjogIiIsCiAgICAgICAgaXNzdWVzOiBbXSwKICAgICAgICBpbml0aWFsSW5zcGVjdGlvblRpdGxlOiAiIiwKICAgICAgICBmaW5hbEluc3BlY3Rpb25UaXRsZTogIiIsCiAgICAgICAgY2F0ZWdvcnk6ICIiLAogICAgICAgIG5hbWU6ICIiLAogICAgICAgIHNlbGVjdGVkSW5pdGlhbEluc3BlY3Rpb25CeUFzc2V0Q2F0ZWdvcnk6ICIiLAogICAgICAgIHNlbGVjdGVkRmluYWxJbnNwZWN0aW9uQnlBc3NldENhdGVnb3J5OiAiIgogICAgICB9LAogICAgICBjaGVja0V4aXN0aW5nSW5pdGlhbEluc3BlY3Rpb246IGZhbHNlLAogICAgICBjaGVja0V4aXN0aW5nRmluYWxJbnNwZWN0aW9uOiBmYWxzZSwKICAgICAgc2FtZUFzSW5pdGlhbEluc3BlY3Rpb246IHRydWUsCiAgICAgIGluaXRpYWxJbnNwZWN0aW9uQnlBc3NldDogIiIsCiAgICAgIGluaXRpYWxJbnNwZWN0aW9uQnlBc3NldENhdGVnb3J5OiAiIiwKICAgICAgaW5pdGlhbEluc3BlY3Rpb25CeVdvcmtPcmRlcjogIiIsCiAgICAgIGZpbmFsSW5zcGVjdGlvbkJ5QXNzZXQ6ICIiLAogICAgICBmaW5hbEluc3BlY3Rpb25CeUFzc2V0Q2F0ZWdvcnk6ICIiLAogICAgICBmaW5hbEluc3BlY3Rpb25CeVdvcmtPcmRlcjogIiIsCiAgICAgIHNlbGVjdGVkSW5pdGlhbEluc3BlY3Rpb25CeUFzc2V0OiAiIiwKICAgICAgc2VsZWN0ZWRJbml0aWFsSW5zcGVjdGlvbkJ5QXNzZXRDYXRlZ29yeTogIiIsCiAgICAgIHNlbGVjdGVkSW5pdGlhbEluc3BlY3Rpb25CeVdvcmtPcmRlcjogIiIsCiAgICAgIHNlbGVjdGVkRmluYWxJbnNwZWN0aW9uQnlBc3NldDogIiIsCiAgICAgIHNlbGVjdGVkRmluYWxJbnNwZWN0aW9uQnlBc3NldENhdGVnb3J5OiAiIiwKICAgICAgc2VsZWN0ZWRGaW5hbEluc3BlY3Rpb25CeVdvcmtPcmRlcjogIiIsCiAgICAgIGluc3BlY3Rpb25CeUFzc2V0T3B0aW9uczogW10sCiAgICAgIGlucHNlY3Rpb25CeUFzc2V0Q2F0ZWdvcnlPcHRpb25zOiBbXSwKICAgICAgaW5wc2VjdGlvbkJ5V29ya09yZGVyT3B0aW9uczogW10sCiAgICAgIGluaXRpYWxJbnNwZWN0aW9uVGVtcDogIiIsCiAgICAgIGZpbmFsSW5zcGVjdGlvblRpdGxlOiAiIiwKICAgICAgYW5zd2VyVHlwZU9wdGlvbnM6IFt7CiAgICAgICAgbGFiZWw6ICJUZXh0L0ltYWdlL0F1ZGlvIiwKICAgICAgICB2YWx1ZTogImlucHV0IgogICAgICB9LCB7CiAgICAgICAgbGFiZWw6ICJZZXMvTm8iLAogICAgICAgIHZhbHVlOiAiYm9vbGVhbiIKICAgICAgfSwgewogICAgICAgIGxhYmVsOiAiTXVsdGlwbGUgQ2hvaWNlIiwKICAgICAgICB2YWx1ZTogIm11bHRpcGxlIgogICAgICB9XSwKICAgICAgcXVlc3Rpb25UeXBlRm9ybUluaXRpYWw6IFtdLAogICAgICBxdWVzdGlvblR5cGVGb3JtRmluYWw6IFtdLAogICAgICBvcmRlckluc3RydWN0aW9uczogW3sKICAgICAgICB2YWx1ZTogIiIKICAgICAgfV0sCiAgICAgIGFzc2V0Q2F0ZWdvcnlPcHRpb25zOiBbXSwKICAgICAgYWxsQXNzZXREYXRhOiBbXSwKICAgICAgYXNzZXROYW1lczogW10sCiAgICAgIGFzc2V0VVVJRDogIiIsCiAgICAgIGlzc3Vlc0FycmF5TGlzdDogW10sCiAgICAgIGlzc3Vlc1NlbGVjdGVkOiBbXSwKICAgICAgZmluYWxJbnNwZWN0aW9uT3B0aW9uczogW3sKICAgICAgICBsYWJlbDogIlNhbWUgQXMgSW5pdGlhbCIsCiAgICAgICAgdmFsdWU6ICJzYW1lIgogICAgICB9LCB7CiAgICAgICAgbGFiZWw6ICJTZWxlY3QgRXhpc3RpbmciLAogICAgICAgIHZhbHVlOiAiZXhpc3RpbmciCiAgICAgIH0sIHsKICAgICAgICBsYWJlbDogIkNyZWF0ZSBOZXcgSW5zcGVjdGlvbiBUZW1wbGF0ZSIsCiAgICAgICAgdmFsdWU6ICJjcmVhdGVOZXciCiAgICAgIH1dLAogICAgICBmaW5hbEluc3BlY3Rpb25TZWxlY3Rpb246ICJTYW1lIEFzIEluaXRpYWwiCiAgICB9OwogIH0sCgogIG1ldGhvZHM6IHsKICAgIC8vIHZhbGRpYXRlRGF0ZSgpIHsKICAgIC8vICAgbGV0IGN1cnJlbnREYXRlID0gYCR7bmV3IERhdGUoKS5nZXRGdWxsWWVhcigpfS0kewogICAgLy8gICAgIG5ldyBEYXRlKCkuZ2V0TW9udGgoKSArIDEKICAgIC8vICAgfS0ke25ldyBEYXRlKCkuZ2V0RGF0ZSgpfWA7CiAgICAvLyAgIGlmICghbW9tZW50KHRoaXMud29ya09yZGVyU3VtbWFyeS5zaGVkdWxlKS5pc1NhbWVPckFmdGVyKGN1cnJlbnREYXRlKSkgewogICAgLy8gICAgIHRoaXMuc2hvd1RvYXN0KCJQbGVhc2Ugc2VsZWN0IGN1cnJlbnQgb3IgZnV0dXJlIGRhdGUiLCAiZXJyb3IiKTsKICAgIC8vICAgICByZXR1cm4gZmFsc2U7CiAgICAvLyAgIH0KICAgIC8vIH0sCiAgICB3b3JrT3JkZXJBc3NpZ25tZW50KCkge30sCgogICAgaW5pdGlhbEluc3BlY3Rpb25GdW5jKHZhbHVlKSB7CiAgICAgIGlmICh0aGlzLnNhbWUgPT09IHRydWUpIHsKICAgICAgICBpZiAodGhpcy5jaGVja0V4aXN0aW5nSW5pdGlhbEluc3BlY3Rpb24gPT09IGZhbHNlKSB7CiAgICAgICAgICB0aGlzLndvcmtPcmRlclN1bW1hcnkuZmluYWxJbnNwZWN0aW9uVGl0bGUgPSB2YWx1ZTsKICAgICAgICB9CiAgICAgIH0KCiAgICAgIHRoaXMud29ya09yZGVyU3VtbWFyeUluZGV4Kys7CiAgICB9LAoKICAgIGV4aXN0aW5nRnVuY3Rpb24odmFsdWUpIHsKICAgICAgdGhpcy53b3JrT3JkZXJTdW1tYXJ5LmluaXRpYWxJbnNwZWN0aW9uVGl0bGUgPSAiIjsKICAgICAgdGhpcy53b3JrT3JkZXJTdW1tYXJ5LnNlbGVjdGVkSW5pdGlhbEluc3BlY3Rpb25CeUFzc2V0Q2F0ZWdvcnkgPSAiIjsKCiAgICAgIGlmICh0aGlzLnNhbWUgPT09IHRydWUpIHsKICAgICAgICB0aGlzLndvcmtPcmRlclN1bW1hcnkuZmluYWxJbnNwZWN0aW9uVGl0bGUgPSAiIjsKICAgICAgICB0aGlzLndvcmtPcmRlclN1bW1hcnkuc2VsZWN0ZWRGaW5hbEluc3BlY3Rpb25CeUFzc2V0Q2F0ZWdvcnkgPSAiIjsKICAgICAgfQoKICAgICAgaWYgKHZhbHVlID09PSB0cnVlKSB7CiAgICAgICAgdGhpcy5xdWVzdGlvblR5cGVGb3JtSW5pdGlhbCA9IFtdOwogICAgICAgIHRoaXMuYWRkSW5wdXRGaWVsZHNJbml0aWFsKCk7CiAgICAgIH0gZWxzZSB7CiAgICAgICAgdGhpcy5pbml0aWFsSW5zcGVjdGlvbkJ5QXNzZXRDYXRlZ29yeSA9ICIiOwogICAgICAgIHRoaXMuc2VsZWN0ZWRJbml0aWFsSW5zcGVjdGlvbkJ5QXNzZXRDYXRlZ29yeSA9ICIiOwogICAgICAgIHRoaXMuaW5pdGlhbEFzc2V0SW5kZXgrKzsKICAgICAgfQoKICAgICAgdGhpcy53b3JrT3JkZXJTdW1tYXJ5SW5kZXgrKzsKICAgIH0sCgogICAgZ2V0Q3VycmVuY3koKSB7CiAgICAgIEFzc2V0UGVyc29ubmVsU2VydmljZS5nZXRDb21wYW55Q3VycmVuY3kodGhpcy5jdXJyZW50VXNlckRldGFpbHMucHJvZmlsZS5vcmdhbml6YXRpb25JZCkudGhlbihyZXNwb25zZSA9PiB7CiAgICAgICAgdGhpcy5jdXJyZW5jeSA9IHJlc3BvbnNlLmRhdGEuY3VycmVuY3k7CiAgICAgIH0pOwogICAgfSwKCiAgICBmaW5hbEluc3BlY3Rpb25PcHRpb25TZWxlY3RlZCh2YWx1ZSkgewogICAgICB0aGlzLndvcmtPcmRlclN1bW1hcnkuZmluYWxJbnNwZWN0aW9uVGl0bGUgPSAiIjsKICAgICAgdGhpcy53b3JrT3JkZXJTdW1tYXJ5LnNlbGVjdGVkRmluYWxJbnNwZWN0aW9uQnlBc3NldENhdGVnb3J5ID0gIiI7CiAgICAgIHRoaXMucXVlc3Rpb25UeXBlRm9ybUZpbmFsID0gW107CiAgICAgIHRoaXMuYWRkSW5wdXRGaWVsZHNGaW5hbCgpOwogICAgICB0aGlzLmZpbmFsSW5zcGVjdGlvbkJ5QXNzZXRDYXRlZ29yeSA9IFtdOwogICAgICB0aGlzLnNlbGVjdGVkRmluYWxJbnNwZWN0aW9uQnlBc3NldENhdGVnb3J5ID0gIiI7CgogICAgICBpZiAodmFsdWUudmFsdWUgPT09ICJTYW1lIEFzIEluaXRpYWwiKSB7CiAgICAgICAgdGhpcy5zYW1lID0gdHJ1ZTsKCiAgICAgICAgaWYgKHRoaXMuY2hlY2tFeGlzdGluZ0luaXRpYWxJbnNwZWN0aW9uKSB7CiAgICAgICAgICB0aGlzLndvcmtPcmRlclN1bW1hcnkuc2VsZWN0ZWRGaW5hbEluc3BlY3Rpb25CeUFzc2V0Q2F0ZWdvcnkgPSB0aGlzLndvcmtPcmRlclN1bW1hcnkuc2VsZWN0ZWRJbml0aWFsSW5zcGVjdGlvbkJ5QXNzZXRDYXRlZ29yeTsKICAgICAgICB9IGVsc2UgewogICAgICAgICAgdGhpcy53b3JrT3JkZXJTdW1tYXJ5LmZpbmFsSW5zcGVjdGlvblRpdGxlID0gdGhpcy53b3JrT3JkZXJTdW1tYXJ5LmluaXRpYWxJbnNwZWN0aW9uVGl0bGU7CiAgICAgICAgfQogICAgICB9IGVsc2UgewogICAgICAgIHRoaXMuc2FtZSA9IGZhbHNlOwogICAgICB9CgogICAgICB0aGlzLndvcmtPcmRlclN1bW1hcnlJbmRleCsrOwogICAgfSwKCiAgICBjbGVhclNlbGVjdGVkRmluYWxJbnNwZWN0aW9uT3B0aW9uKCkgewogICAgICB0aGlzLmZpbmFsSW5zcGVjdGlvblNlbGVjdGlvbiA9ICIiOwogICAgICB0aGlzLmZpbmFsSW5zcGVjdGlvblJlc2V0Kys7CiAgICB9LAoKICAgIG9uSXNzdWVOdW1iZXJTZWxlY3QodmFsdWUpIHsKICAgICAgdGhpcy53b3JrT3JkZXJTdW1tYXJ5Lmlzc3VlcyA9IFtdOwoKICAgICAgaWYgKHZhbHVlLmxlbmd0aCA+IDApIHsKICAgICAgICB0aGlzLndvcmtPcmRlclN1bW1hcnkuaXNzdWVzID0gdmFsdWU7CiAgICAgIH0KICAgIH0sCgogICAgZ2V0SXNzdWVzQnlBc3NldFVVSUQoQXNzZXRVVUlEKSB7CiAgICAgIHRoaXMuaXNzdWVzQXJyYXlMaXN0ID0gW107CiAgICAgIEluc3BlY3Rpb25TZXJ2aWNlLmZpbHRlcklzc3Vlc0J5QXNzZXRVVUlEKEFzc2V0VVVJRCwgInJlcG9ydGVkIikudGhlbihyZXNwb25zZSA9PiB7CiAgICAgICAgaWYgKHJlc3BvbnNlLnN0YXR1cyA9PT0gMjAwKSB7CiAgICAgICAgICBmb3IgKGxldCBpbmRleCA9IDA7IGluZGV4IDwgcmVzcG9uc2UuZGF0YS5pc3N1ZXMubGVuZ3RoOyBpbmRleCsrKSB7CiAgICAgICAgICAgIGxldCBwYXJ0ID0gewogICAgICAgICAgICAgIG5hbWU6ICIiLAogICAgICAgICAgICAgIHV1aWQ6IHRoaXMuZ2VuZXJhdGVVVUlEKCksCiAgICAgICAgICAgICAgcXVhbnRpdHk6ICIiLAogICAgICAgICAgICAgIGNvc3Q6IHsKICAgICAgICAgICAgICAgIGNhdGVnb3J5OiAicGFydC1jb3N0IiwKICAgICAgICAgICAgICAgIGFtb3VudDogIiIsCiAgICAgICAgICAgICAgICByZXBvcnRhYmxlOiB0cnVlCiAgICAgICAgICAgICAgfSwKICAgICAgICAgICAgICBleHRyYUNvc3Q6IFt7CiAgICAgICAgICAgICAgICBjYXRlZ29yeTogInRheC1jb3N0IiwKICAgICAgICAgICAgICAgIGFtb3VudDogIiIsCiAgICAgICAgICAgICAgICByZXBvcnRhYmxlOiB0cnVlCiAgICAgICAgICAgICAgfV0KICAgICAgICAgICAgfTsKICAgICAgICAgICAgcmVzcG9uc2UuZGF0YS5pc3N1ZXNbaW5kZXhdLmluc3RydWN0aW9uQ2hlY2tsaXN0ID0gSlNPTi5wYXJzZShyZXNwb25zZS5kYXRhLmlzc3Vlc1tpbmRleF0uaW5zdHJ1Y3Rpb25DaGVja2xpc3QpOwoKICAgICAgICAgICAgaWYgKHJlc3BvbnNlLmRhdGEuaXNzdWVzW2luZGV4XS5pbnN0cnVjdGlvbkNoZWNrbGlzdCA9PT0gbnVsbCkgewogICAgICAgICAgICAgIHJlc3BvbnNlLmRhdGEuaXNzdWVzW2luZGV4XS5pbnN0cnVjdGlvbkNoZWNrbGlzdCA9IFtdOwogICAgICAgICAgICAgIHJlc3BvbnNlLmRhdGEuaXNzdWVzW2luZGV4XS5pbnN0cnVjdGlvbkNoZWNrbGlzdC5wdXNoKHsKICAgICAgICAgICAgICAgIHZhbHVlOiAiIgogICAgICAgICAgICAgIH0pOwogICAgICAgICAgICB9CgogICAgICAgICAgICByZXNwb25zZS5kYXRhLmlzc3Vlc1tpbmRleF0ucGFydHMgPSBbXTsKICAgICAgICAgICAgcmVzcG9uc2UuZGF0YS5pc3N1ZXNbaW5kZXhdLnBhcnRzLnB1c2gocGFydCk7CiAgICAgICAgICAgIHJlc3BvbnNlLmRhdGEuaXNzdWVzW2luZGV4XS5yZXBvcnRlZEF0ID0gbW9tZW50KHJlc3BvbnNlLmRhdGEuaXNzdWVzW2luZGV4XS5yZXBvcnRlZEF0KS5mb3JtYXQoIkREIE1NTSBZWVlZIik7CiAgICAgICAgICAgIHJlc3BvbnNlLmRhdGEuaXNzdWVzW2luZGV4XS5uYW1lID0gcmVzcG9uc2UuZGF0YS5pc3N1ZXNbaW5kZXhdLmlzc3VlTmFtZSArICIgLSAiICsgcmVzcG9uc2UuZGF0YS5pc3N1ZXNbaW5kZXhdLmlzc3VlTnVtYmVyOwogICAgICAgICAgICB0aGlzLmlzc3Vlc0FycmF5TGlzdC5wdXNoKHJlc3BvbnNlLmRhdGEuaXNzdWVzW2luZGV4XSk7CiAgICAgICAgICB9CiAgICAgICAgfQogICAgICB9KS5jYXRjaChlcnJvciA9PiB7CiAgICAgICAgdGhpcy5zaG93VG9hc3QoZXJyb3IuZGF0YS5yZXNwb25zZSwgImVycm9yIik7CiAgICAgIH0pOwogICAgfSwKCiAgICBvblNlbGVjdGVkQXNzZXRDYXRlZ29yeSh2YWx1ZSkgewogICAgICB0aGlzLmFzc2V0TmFtZXMgPSBbXTsKCiAgICAgIGZvciAobGV0IGluZGV4ID0gMDsgaW5kZXggPCB0aGlzLmFsbEFzc2V0RGF0YS5sZW5ndGg7IGluZGV4KyspIHsKICAgICAgICBpZiAodGhpcy5hbGxBc3NldERhdGFbaW5kZXhdLmNhdGVnb3J5VVVJRCA9PT0gdmFsdWUuc2VsZWN0ZWRPYmplY3QuY2F0ZWdvcnlVVUlEKSB7CiAgICAgICAgICB0aGlzLmFzc2V0TmFtZXMucHVzaCh0aGlzLmFsbEFzc2V0RGF0YVtpbmRleF0pOwogICAgICAgIH0KICAgICAgfQoKICAgICAgdGhpcy5nZXRJbnNwZWN0aW9uVGVtYXBsYXRlc0J5QXNzZXRDYXRlZ29yeSh2YWx1ZS5zZWxlY3RlZE9iamVjdC5jYXRlZ29yeVVVSUQpOwogICAgICB0aGlzLndvcmtPcmRlclN1bW1hcnkubmFtZSA9ICIiOwogICAgICB0aGlzLmFzc2V0SW5kZXgrKzsKICAgIH0sCgogICAgY2xlYXJTZWxlY3RlZEFzc2V0Q2F0ZWdvcnkoKSB7CiAgICAgIHRoaXMuYXNzZXROYW1lcyA9IFtdOwogICAgICB0aGlzLndvcmtPcmRlclN1bW1hcnkuY2F0ZWdvcnkgPSAiIjsKICAgICAgdGhpcy53b3JrT3JkZXJTdW1tYXJ5Lm5hbWUgPSAiIjsKICAgICAgdGhpcy5jYXRlZ29yeUluZGV4Kys7CiAgICAgIHRoaXMuYXNzZXRJbmRleCsrOwogICAgfSwKCiAgICBvblNlbGVjdGVkQXNzZXROYW1lKHZhbHVlKSB7CiAgICAgIHRoaXMuYXNzZXRVVUlEID0gdmFsdWUuc2VsZWN0ZWRPYmplY3QudXVpZDsKICAgICAgdGhpcy5nZXRJc3N1ZXNCeUFzc2V0VVVJRCh0aGlzLmFzc2V0VVVJRCk7CiAgICB9LAoKICAgIGNsZWFyU2VsZWN0ZWRBc3NldE5hbWUoKSB7CiAgICAgIHRoaXMuYXNzZXRVVUlEID0gIiI7CiAgICAgIHRoaXMud29ya09yZGVyU3VtbWFyeS5uYW1lID0gIiI7CiAgICAgIHRoaXMuZ2V0SXNzdWVzQnlBc3NldFVVSUQodGhpcy5hc3NldFVVSUQpOwogICAgICB0aGlzLmFzc2V0SW5kZXgrKzsKICAgIH0sCgogICAgY2xlYXJTZWxlY3RlZFByaW9yaXR5KCkgewogICAgICB0aGlzLndvcmtPcmRlclN1bW1hcnkucHJpb3JpdHkgPSAiIjsKICAgICAgdGhpcy5hc3NldEluZGV4Kys7CiAgICB9LAoKICAgIGNsZWFyU2VsZWN0ZWRTaGlmdCgpIHsKICAgICAgdGhpcy53b3JrT3JkZXJTdW1tYXJ5LnNoaWZ0ID0gIiI7CiAgICAgIHRoaXMuYXNzZXRJbmRleCsrOwogICAgfSwKCiAgICBnZXRBbGxDYXRlZ29yaWVzKGN1cnJlbnRVc2VyRGV0YWlscykgewogICAgICBBc3NldE1hbmFnZW1lbnRTZXJ2aWNlLmdldEFsbEFzc2V0Q2F0ZWdvcmllcyhjdXJyZW50VXNlckRldGFpbHMucHJvZmlsZS5vcmdhbml6YXRpb25JZCkudGhlbihyZXMgPT4gewogICAgICAgIGZvciAobGV0IGluZGV4ID0gMDsgaW5kZXggPCByZXMuZGF0YS5jYXRlZ29yaWVzLmxlbmd0aDsgaW5kZXgrKykgewogICAgICAgICAgbGV0IG9iaiA9IHsKICAgICAgICAgICAgaWQ6IHJlcy5kYXRhLmNhdGVnb3JpZXNbaW5kZXhdLmlkLAogICAgICAgICAgICBjYXRlZ29yeVVVSUQ6IHJlcy5kYXRhLmNhdGVnb3JpZXNbaW5kZXhdLnV1aWQsCiAgICAgICAgICAgIGxhYmVsOiByZXMuZGF0YS5jYXRlZ29yaWVzW2luZGV4XS5uYW1lCiAgICAgICAgICB9OwogICAgICAgICAgdGhpcy5hc3NldENhdGVnb3J5T3B0aW9ucy5wdXNoKG9iaik7CiAgICAgICAgfQoKICAgICAgICB0aGlzLmdldEFsbEFzc2V0KGN1cnJlbnRVc2VyRGV0YWlscyk7CiAgICAgIH0pLmNhdGNoKGVyciA9PiB7CiAgICAgICAgdGhpcy5zaG93VG9hc3QoZXJyLmRhdGEucmVzcG9uc2UsICJlcnJvciIpOwogICAgICB9KTsKICAgIH0sCgogICAgZ2V0QWxsQXNzZXQoY3VycmVudFVzZXJEZXRhaWxzKSB7CiAgICAgIGxldCBjYXRlZ29yeVVVSUQgPSAiIjsKICAgICAgQXNzZXRNYW5hZ2VtZW50U2VydmljZS5nZXRBbGxBc3NldHMoY3VycmVudFVzZXJEZXRhaWxzLnByb2ZpbGUub3JnYW5pemF0aW9uSWQpLnRoZW4ocmVzID0+IHsKICAgICAgICBmb3IgKGxldCBpbmRleCA9IDA7IGluZGV4IDwgcmVzLmRhdGEuYXNzZXRzLmxlbmd0aDsgaW5kZXgrKykgewogICAgICAgICAgbGV0IG9iaiA9IHsKICAgICAgICAgICAgdXVpZDogcmVzLmRhdGEuYXNzZXRzW2luZGV4XS51dWlkLAogICAgICAgICAgICBjYXRlZ29yeVVVSUQ6IHJlcy5kYXRhLmFzc2V0c1tpbmRleF0uY2F0ZWdvcnlVVUlELAogICAgICAgICAgICBsYWJlbDogcmVzLmRhdGEuYXNzZXRzW2luZGV4XS5uYW1lLAogICAgICAgICAgICB0eXBlOiByZXMuZGF0YS5hc3NldHNbaW5kZXhdLnR5cGUKICAgICAgICAgIH07CiAgICAgICAgICB0aGlzLmFsbEFzc2V0RGF0YS5wdXNoKG9iaik7CiAgICAgICAgfQoKICAgICAgICBpZiAodGhpcy4kcm91dGUucGFyYW1zLmNyZWF0ZVdvcmtPcmRlciA9PT0gdHJ1ZSkgewogICAgICAgICAgZm9yIChsZXQgaW5kZXggPSAwOyBpbmRleCA8IHRoaXMuYWxsQXNzZXREYXRhLmxlbmd0aDsgaW5kZXgrKykgewogICAgICAgICAgICBpZiAodGhpcy4kcm91dGUucGFyYW1zLmFzc2V0VVVJRCA9PT0gdGhpcy5hbGxBc3NldERhdGFbaW5kZXhdLnV1aWQpIHsKICAgICAgICAgICAgICBjYXRlZ29yeVVVSUQgPSB0aGlzLmFsbEFzc2V0RGF0YVtpbmRleF0uY2F0ZWdvcnlVVUlEOwogICAgICAgICAgICB9CiAgICAgICAgICB9CgogICAgICAgICAgZm9yIChsZXQgaW5keCA9IDA7IGluZHggPCB0aGlzLmFzc2V0Q2F0ZWdvcnlPcHRpb25zLmxlbmd0aDsgaW5keCsrKSB7CiAgICAgICAgICAgIGlmICh0aGlzLmFzc2V0Q2F0ZWdvcnlPcHRpb25zW2luZHhdLmNhdGVnb3J5VVVJRCA9PT0gY2F0ZWdvcnlVVUlEKSB7CiAgICAgICAgICAgICAgdGhpcy53b3JrT3JkZXJTdW1tYXJ5LmNhdGVnb3J5ID0gdGhpcy5hc3NldENhdGVnb3J5T3B0aW9uc1tpbmR4XS5sYWJlbDsKICAgICAgICAgICAgfQogICAgICAgICAgfQoKICAgICAgICAgIGZvciAobGV0IGogPSAwOyBqIDwgdGhpcy5hbGxBc3NldERhdGEubGVuZ3RoOyBqKyspIHsKICAgICAgICAgICAgaWYgKHRoaXMuYWxsQXNzZXREYXRhW2pdLmNhdGVnb3J5VVVJRCA9PT0gY2F0ZWdvcnlVVUlEKSB7CiAgICAgICAgICAgICAgdGhpcy5hc3NldE5hbWVzLnB1c2godGhpcy5hbGxBc3NldERhdGFbal0pOwogICAgICAgICAgICB9CiAgICAgICAgICB9CgogICAgICAgICAgZm9yIChsZXQgaW5kZXggPSAwOyBpbmRleCA8IHRoaXMuYXNzZXROYW1lcy5sZW5ndGg7IGluZGV4KyspIHsKICAgICAgICAgICAgaWYgKHRoaXMuYXNzZXROYW1lc1tpbmRleF0udXVpZCA9PT0gdGhpcy4kcm91dGUucGFyYW1zLmFzc2V0VVVJRCkgewogICAgICAgICAgICAgIHRoaXMud29ya09yZGVyU3VtbWFyeS5uYW1lID0gdGhpcy5hc3NldE5hbWVzW2luZGV4XS5sYWJlbDsKICAgICAgICAgICAgfQogICAgICAgICAgfQoKICAgICAgICAgIHRoaXMuY2F0ZWdvcnlJbmRleCsrOwogICAgICAgICAgdGhpcy5hc3NldEluZGV4Kys7CiAgICAgICAgfQogICAgICB9KS5jYXRjaChlcnIgPT4gewogICAgICAgIHRoaXMuc2hvd1RvYXN0KGVyci5kYXRhLnJlc3BvbnNlLCAiZXJyb3IiKTsKICAgICAgfSk7CiAgICB9LAoKICAgIGJhc2ljRGV0YWlsc0FjY29yZGlvbkZ1bmN0aW9uKCkgewogICAgICBpZiAodGhpcy4kcmVmcy5iYXNpY0RldGFpbHNBY2NvcmRpb24ub3BlbkZsYWcgPT09IHRydWUpIHsKICAgICAgICB0aGlzLiRyZWZzLmZpbmFsSW5zcGVjdGlvbnNBY2NvcmRpb24ub3BlbkZsYWcgPSBmYWxzZTsKICAgICAgICB0aGlzLiRyZWZzLnVzZXJBc3NpZ25tZW50QWNjb3JkaW9uLm9wZW5GbGFnID0gZmFsc2U7CiAgICAgICAgdGhpcy4kcmVmcy5pc3N1ZXNBY2NvcmRpb24ub3BlbkZsYWcgPSBmYWxzZTsKICAgICAgICB0aGlzLiRyZWZzLmluc3BlY3Rpb25zQWNjb3JkaW9uLm9wZW5GbGFnID0gZmFsc2U7CiAgICAgIH0KICAgIH0sCgogICAgdXNlckFzc2lnbm1lbnRBY2NvcmRpb25GdW5jdGlvbigpIHsKICAgICAgaWYgKHRoaXMuJHJlZnMudXNlckFzc2lnbm1lbnRBY2NvcmRpb24ub3BlbkZsYWcgPT09IHRydWUpIHsKICAgICAgICB0aGlzLiRyZWZzLmJhc2ljRGV0YWlsc0FjY29yZGlvbi5vcGVuRmxhZyA9IGZhbHNlOwogICAgICAgIHRoaXMuJHJlZnMuaXNzdWVzQWNjb3JkaW9uLm9wZW5GbGFnID0gZmFsc2U7CiAgICAgICAgdGhpcy4kcmVmcy5pbnNwZWN0aW9uc0FjY29yZGlvbi5vcGVuRmxhZyA9IGZhbHNlOwogICAgICAgIHRoaXMuJHJlZnMuZmluYWxJbnNwZWN0aW9uc0FjY29yZGlvbi5vcGVuRmxhZyA9IGZhbHNlOwogICAgICB9CiAgICB9LAoKICAgIGlzc3Vlc0FjY29yZGlvbkZ1bmN0aW9uKCkgewogICAgICBpZiAodGhpcy4kcmVmcy5pc3N1ZXNBY2NvcmRpb24ub3BlbkZsYWcgPT09IHRydWUpIHsKICAgICAgICB0aGlzLiRyZWZzLmJhc2ljRGV0YWlsc0FjY29yZGlvbi5vcGVuRmxhZyA9IGZhbHNlOwogICAgICAgIHRoaXMuJHJlZnMudXNlckFzc2lnbm1lbnRBY2NvcmRpb24ub3BlbkZsYWcgPSBmYWxzZTsKICAgICAgICB0aGlzLiRyZWZzLmluc3BlY3Rpb25zQWNjb3JkaW9uLm9wZW5GbGFnID0gZmFsc2U7CiAgICAgICAgdGhpcy4kcmVmcy5maW5hbEluc3BlY3Rpb25zQWNjb3JkaW9uLm9wZW5GbGFnID0gZmFsc2U7CiAgICAgIH0KICAgIH0sCgogICAgaW5zcGVjdGlvbnNBY2NvcmRpb25GdW5jdGlvbigpIHsKICAgICAgaWYgKHRoaXMuJHJlZnMuaW5zcGVjdGlvbnNBY2NvcmRpb24ub3BlbkZsYWcgPT09IHRydWUpIHsKICAgICAgICB0aGlzLiRyZWZzLmJhc2ljRGV0YWlsc0FjY29yZGlvbi5vcGVuRmxhZyA9IGZhbHNlOwogICAgICAgIHRoaXMuJHJlZnMudXNlckFzc2lnbm1lbnRBY2NvcmRpb24ub3BlbkZsYWcgPSBmYWxzZTsKICAgICAgICB0aGlzLiRyZWZzLmlzc3Vlc0FjY29yZGlvbi5vcGVuRmxhZyA9IGZhbHNlOwogICAgICAgIHRoaXMuJHJlZnMuZmluYWxJbnNwZWN0aW9uc0FjY29yZGlvbi5vcGVuRmxhZyA9IGZhbHNlOwogICAgICAgIHRoaXMuJHJlZnMudXNlckFzc2lnbm1lbnRBY2NvcmRpb24ub3BlbkZsYWcgPT09IGZhbHNlOwogICAgICB9CiAgICB9LAoKICAgIGZpbmFsSW5zcGVjdGlvbnNBY2NvcmRpb25GdW5jdGlvbigpIHsKICAgICAgaWYgKHRoaXMuJHJlZnMuZmluYWxJbnNwZWN0aW9uc0FjY29yZGlvbi5vcGVuRmxhZyA9PT0gdHJ1ZSkgewogICAgICAgIHRoaXMuJHJlZnMuYmFzaWNEZXRhaWxzQWNjb3JkaW9uLm9wZW5GbGFnID0gZmFsc2U7CiAgICAgICAgdGhpcy4kcmVmcy51c2VyQXNzaWdubWVudEFjY29yZGlvbi5vcGVuRmxhZyA9IGZhbHNlOwogICAgICAgIHRoaXMuJHJlZnMuaXNzdWVzQWNjb3JkaW9uLm9wZW5GbGFnID0gZmFsc2U7CiAgICAgICAgdGhpcy4kcmVmcy5pbnNwZWN0aW9uc0FjY29yZGlvbi5vcGVuRmxhZyA9IGZhbHNlOwogICAgICB9CiAgICB9LAoKICAgIGNyZWF0ZVdvcmtPcmRlcigpIHsKICAgICAgdGhpcy4kdi4kdG91Y2goKTsKCiAgICAgIGlmICh0aGlzLiR2LiRpbnZhbGlkKSB7CiAgICAgICAgdGhpcy5zaG93VG9hc3QoIlBsZWFzZSBmaWxsIGFsbCByZXF1aXJlZCBmaWVsZHMiLCAid2FybmluZyIpOwogICAgICAgIHJldHVybjsKICAgICAgfQoKICAgICAgdGhpcy5sb2FkZXJGbGFnID0gdHJ1ZTsKICAgICAgbGV0IHdvcmtPcmRlciA9IHt9OwogICAgICBsZXQgcmVzb2x1dGlvbnMgPSBbXTsKICAgICAgbGV0IGlzc3VlcyA9IFtdOwogICAgICBsZXQgdGVtcE9yZGVyID0gW107CiAgICAgIGxldCBvcmRlckpzb24gPSBudWxsOwogICAgICBsZXQgaW5pdGlhbEluc3BlY3Rpb25UZW1wbGF0ZSA9IG51bGw7CiAgICAgIGxldCBmaW5hbEluc3BlY3Rpb25UZW1wbGF0ZSA9IG51bGw7CiAgICAgIGxldCBmcm9tSW5zcGVjdGlvbkluaXRpYWwgPSBmYWxzZTsKICAgICAgbGV0IGZyb21JbnNwZWN0aW9uRmluYWwgPSBmYWxzZTsKICAgICAgbGV0IGluaXRpYWxJbnNwZWN0aW9uT3B0aW9uID0gbnVsbDsKICAgICAgbGV0IGZpbmFsSW5zcGVjdGlvbk9wdGlvbiA9IG51bGw7CiAgICAgIHZhciBpbml0aWFsSW5zcGVjdGlvblRlbXBsYXRlTGlua2luZ1VVSUQgPSBudWxsOwogICAgICBsZXQgZmluYWxJbnNwZWN0aW9uVGVtcGxhdGVMaW5raW5nVVVJRCA9IG51bGw7CiAgICAgIGxldCBpbml0aWFsTGlua0luc3BlY3Rpb25UeXBlID0gbnVsbDsKICAgICAgbGV0IGZpbmFsTGlua0luc3BlY3Rpb25UeXBlID0gbnVsbDsKICAgICAgbGV0IGNyZWF0ZVdvcmtPcmRlclJlcXVlc3QgPSB7fTsgLy8gaWYgKHRoaXMuY2hlY2tFeGlzdGluZ0luaXRpYWxJbnNwZWN0aW9uID09PSB0cnVlKSB7CiAgICAgIC8vIAlpbml0aWFsSW5zcGVjdGlvbk9wdGlvbiA9ICJsaW5rIjsKICAgICAgLy8gCWluaXRpYWxJbnNwZWN0aW9uVGVtcGxhdGVMaW5raW5nVVVJRCA9CiAgICAgIC8vIAkJdGhpcy5zZWxlY3RlZEluaXRpYWxJbnNwZWN0aW9uQnlBc3NldENhdGVnb3J5LnZhbHVlOwogICAgICAvLyB9IGVsc2UgewogICAgICAvLyAJaW5pdGlhbEluc3BlY3Rpb25PcHRpb24gPSAic2F2ZSI7CiAgICAgIC8vIH0KICAgICAgLy8gaWYgKHRoaXMuZmluYWxJbnNwZWN0aW9uU2VsZWN0aW9uID09PSAiU2VsZWN0IEV4aXN0aW5nIikgewogICAgICAvLyAJZmluYWxJbnNwZWN0aW9uT3B0aW9uID0gImxpbmsiOwogICAgICAvLyAJZmluYWxJbnNwZWN0aW9uVGVtcGxhdGVMaW5raW5nVVVJRCA9CiAgICAgIC8vIAkJdGhpcy5zZWxlY3RlZEZpbmFsSW5zcGVjdGlvbkJ5QXNzZXRDYXRlZ29yeS52YWx1ZTsKICAgICAgLy8gfSBlbHNlIHsKICAgICAgLy8gCWZpbmFsSW5zcGVjdGlvbk9wdGlvbiA9ICJzYXZlIjsKICAgICAgLy8gfQoKICAgICAgZm9yIChsZXQgaW5kZXggPSAwOyBpbmRleCA8IHRoaXMud29ya09yZGVyU3VtbWFyeS5pc3N1ZXMubGVuZ3RoOyBpbmRleCsrKSB7CiAgICAgICAgbGV0IGlzc3VlID0ge307CiAgICAgICAgbGV0IHJlc29sdXRpb24gPSB7fTsKICAgICAgICByZXNvbHV0aW9uLnV1aWQgPSB0aGlzLmdlbmVyYXRlVVVJRCgpOwogICAgICAgIHJlc29sdXRpb24ucGFydHNVc2VkID0gW107CiAgICAgICAgdGhpcy53b3JrT3JkZXJTdW1tYXJ5Lmlzc3Vlc1tpbmRleF0ucGFydHMubWFwKHBhcnQgPT4gewogICAgICAgICAgbGV0IHBhcnRPYmplY3QgPSBwYXJ0OwogICAgICAgICAgcGFydE9iamVjdC5wYXJ0TmFtZSA9IHBhcnQubmFtZTsKICAgICAgICAgIHBhcnRPYmplY3QuaXNzdWVVVUlEID0gdGhpcy53b3JrT3JkZXJTdW1tYXJ5Lmlzc3Vlc1tpbmRleF0udXVpZDsKICAgICAgICAgIHBhcnRPYmplY3QucGFydFVVSUQgPSAiZHVtbXktcGFydC11dWlkLWxpbmstd2l0aC1pbnZlbnRvcnkiOwogICAgICAgICAgcGFydE9iamVjdC5hZGRlZEJ5VXNlck5hbWUgPSB0aGlzLmN1cnJlbnRVc2VyRGV0YWlscy5wcm9maWxlLmZpcnN0TmFtZSArICIgIiArIHRoaXMuY3VycmVudFVzZXJEZXRhaWxzLnByb2ZpbGUubGFzdE5hbWU7CiAgICAgICAgICBwYXJ0T2JqZWN0LmFkZGVkQnlVc2VyVVVJRCA9IHRoaXMuY3VycmVudFVzZXJEZXRhaWxzLnByb2ZpbGUudXNlcmlkOwogICAgICAgICAgcGFydE9iamVjdC5jb3N0LmFkZWRCeVVzZXJOYW1lID0gcGFydE9iamVjdC5hZGRlZEJ5VXNlck5hbWU7CiAgICAgICAgICBwYXJ0T2JqZWN0LmNvc3QuYWRkZWRCeVVzZXJVVUlEID0gcGFydE9iamVjdC5hZGRlZEJ5VXNlclVVSUQ7CiAgICAgICAgICBwYXJ0T2JqZWN0LmNvc3QuaXNzdWVVVUlEID0gdGhpcy53b3JrT3JkZXJTdW1tYXJ5Lmlzc3Vlc1tpbmRleF0udXVpZDsKICAgICAgICAgIHJlc29sdXRpb24ucGFydHNVc2VkLnB1c2gocGFydE9iamVjdCk7CiAgICAgICAgICByZXR1cm4gcGFydDsKICAgICAgICB9KTsKICAgICAgICByZXNvbHV0aW9ucy5wdXNoKHJlc29sdXRpb24pOwogICAgICAgIGlzc3VlLmlzc3VlTnVtYmVyID0gdGhpcy53b3JrT3JkZXJTdW1tYXJ5Lmlzc3Vlc1tpbmRleF0uaXNzdWVOdW1iZXI7CiAgICAgICAgaXNzdWUuaXNzdWVVVUlEID0gdGhpcy53b3JrT3JkZXJTdW1tYXJ5Lmlzc3Vlc1tpbmRleF0udXVpZDsKICAgICAgICBpc3N1ZS5yZXNvbHZlZCA9IGZhbHNlOwogICAgICAgIGlzc3VlLmluc3BlY3Rpb25VVUlEID0gdGhpcy53b3JrT3JkZXJTdW1tYXJ5Lmlzc3Vlc1tpbmRleF0uaW5zcGVjdGlvblVVSUQ7CiAgICAgICAgaXNzdWUuc2VydmljZVVVSUQgPSB0aGlzLndvcmtPcmRlclN1bW1hcnkuaXNzdWVzW2luZGV4XS5zZXJ2aWNlVVVJRDsKICAgICAgICBpc3N1ZS5pbnN0cnVjdGlvbnMgPSB0aGlzLndvcmtPcmRlclN1bW1hcnkuaXNzdWVzW2luZGV4XS5pc3N1ZURlc2NyaXB0aW9uOwogICAgICAgIGlzc3VlLnJlc29sdXRpb25VVUlEID0gcmVzb2x1dGlvbi51dWlkOwogICAgICAgIGlzc3VlLnN0YXR1cyA9IHRoaXMud29ya09yZGVyU3VtbWFyeS5pc3N1ZXNbaW5kZXhdLnN0YXR1czsKICAgICAgICB0aGlzLndvcmtPcmRlclN1bW1hcnkuaXNzdWVzW2luZGV4XS5pbnN0cnVjdGlvbkNoZWNrbGlzdC5tYXAoZWxlbWVudCA9PiB7CiAgICAgICAgICB0ZW1wT3JkZXIucHVzaCh7CiAgICAgICAgICAgIG5hbWU6IGVsZW1lbnQudmFsdWUsCiAgICAgICAgICAgIGNoZWNrZWQ6IGZhbHNlCiAgICAgICAgICB9KTsKICAgICAgICAgIG9yZGVySnNvbiA9IEpTT04uc3RyaW5naWZ5KHRlbXBPcmRlcik7CiAgICAgICAgICBpc3N1ZS5vcmRlckluc3RydWN0aW9ucyA9IG9yZGVySnNvbjsKICAgICAgICB9KTsKICAgICAgICBpc3N1ZXMucHVzaChpc3N1ZSk7CiAgICAgICAgb3JkZXJKc29uID0gbnVsbDsKICAgICAgICB0ZW1wT3JkZXIgPSBbXTsKICAgICAgfQoKICAgICAgaWYgKHRoaXMuY2hlY2tFeGlzdGluZ0luaXRpYWxJbnNwZWN0aW9uID09PSB0cnVlKSB7CiAgICAgICAgaWYgKHRoaXMuc2VsZWN0ZWRJbml0aWFsSW5zcGVjdGlvbkJ5QXNzZXRDYXRlZ29yeSAhPT0gIiIpIHsKICAgICAgICAgIGluaXRpYWxMaW5rSW5zcGVjdGlvblR5cGUgPSAiaW5zcGVjdGlvbiI7CiAgICAgICAgfQogICAgICB9CgogICAgICBpZiAodGhpcy5maW5hbEluc3BlY3Rpb25TZWxlY3Rpb24gPT09ICJTZWxlY3QgRXhpc3RpbmciKSB7CiAgICAgICAgaWYgKHRoaXMuc2VsZWN0ZWRGaW5hbEluc3BlY3Rpb25CeUFzc2V0Q2F0ZWdvcnkgIT09ICIiKSB7CiAgICAgICAgICBmaW5hbExpbmtJbnNwZWN0aW9uVHlwZSA9ICJpbnNwZWN0aW9uIjsKICAgICAgICB9CiAgICAgIH0KCiAgICAgIGlmICh0aGlzLnF1ZXN0aW9uVHlwZUZvcm1Jbml0aWFsLmxlbmd0aCA+IDApIHsKICAgICAgICBpbml0aWFsSW5zcGVjdGlvblRlbXBsYXRlID0gewogICAgICAgICAgbmFtZTogdGhpcy53b3JrT3JkZXJTdW1tYXJ5LmluaXRpYWxJbnNwZWN0aW9uVGl0bGUsCiAgICAgICAgICBpbnNwZWN0aW9uSXRlbXM6IHRoaXMucXVlc3Rpb25UeXBlRm9ybUluaXRpYWwKICAgICAgICB9OwogICAgICAgIGluaXRpYWxJbnNwZWN0aW9uT3B0aW9uID0gInNhdmUiOwogICAgICAgIGZyb21JbnNwZWN0aW9uSW5pdGlhbCA9IGZhbHNlOwogICAgICB9IGVsc2UgewogICAgICAgIGZyb21JbnNwZWN0aW9uSW5pdGlhbCA9IHRydWU7CiAgICAgIH0gLy8gaWYgKGluaXRpYWxJbnNwZWN0aW9uVGVtcGxhdGUpIHsKICAgICAgLy8gCS8vCWZpbmFsSW5zcGVjdGlvblRlbXBsYXRlID0gaW5pdGlhbEluc3BlY3Rpb25UZW1wbGF0ZTsKICAgICAgLy8gfSBlbHNlIHsKICAgICAgLy8gCWZyb21JbnNwZWN0aW9uRmluYWwgPSBmcm9tSW5zcGVjdGlvbkluaXRpYWw7CiAgICAgIC8vIH0KICAgICAgLy8gZmluYWxJbnNwZWN0aW9uT3B0aW9uID0gaW5pdGlhbEluc3BlY3Rpb25PcHRpb247CgoKICAgICAgaWYgKHRoaXMucXVlc3Rpb25UeXBlRm9ybUZpbmFsLmxlbmd0aCA+IDApIHsKICAgICAgICBmaW5hbEluc3BlY3Rpb25UZW1wbGF0ZSA9IHsKICAgICAgICAgIG5hbWU6IHRoaXMud29ya09yZGVyU3VtbWFyeS5maW5hbEluc3BlY3Rpb25UaXRsZSwKICAgICAgICAgIGluc3BlY3Rpb25JdGVtczogdGhpcy5xdWVzdGlvblR5cGVGb3JtRmluYWwKICAgICAgICB9OwogICAgICAgIGZpbmFsSW5zcGVjdGlvbk9wdGlvbiA9ICJzYXZlIjsKICAgICAgICBmcm9tSW5zcGVjdGlvbkZpbmFsID0gZmFsc2U7CiAgICAgIH0gZWxzZSB7CiAgICAgICAgZnJvbUluc3BlY3Rpb25GaW5hbCA9IHRydWU7CiAgICAgIH0KCiAgICAgIHdvcmtPcmRlci5wbGFubmluZyA9IHsKICAgICAgICB1c2VyR3JvdXBVVUlEOiB0aGlzLnNlbGVjdGVkVXNlckdyb3VwID8gdGhpcy5zZWxlY3RlZFVzZXJHcm91cC5ncm91cFVVSUQgOiBudWxsLAogICAgICAgIHVzZXJHcm91cE5hbWU6IHRoaXMuc2VsZWN0ZWRVc2VyR3JvdXAgPyB0aGlzLnNlbGVjdGVkVXNlckdyb3VwLmdyb3VwTmFtZSA6IG51bGwsCiAgICAgICAgZnJvbUluc3BlY3Rpb25Jbml0aWFsOiBmcm9tSW5zcGVjdGlvbkluaXRpYWwsCiAgICAgICAgZnJvbUluc3BlY3Rpb25GaW5hbDogZnJvbUluc3BlY3Rpb25GaW5hbAogICAgICB9OwoKICAgICAgaWYgKHRoaXMuc2FtZUFzSW5pdGlhbEluc3BlY3Rpb24pIHsKICAgICAgICB3b3JrT3JkZXIucGxhbm5pbmcuc2FtZUluc3BlY3Rpb24gPSB0cnVlOwogICAgICB9CgogICAgICBpZiAod29ya09yZGVyLnBsYW5uaW5nLmZyb21JbnNwZWN0aW9uSW5pdGlhbCkgewogICAgICAgIGlmICh0aGlzLnNlbGVjdGVkSW5pdGlhbEluc3BlY3Rpb25CeUFzc2V0ICE9PSBudWxsKSB7CiAgICAgICAgICB3b3JrT3JkZXIucGxhbm5pbmcuaW5pdGlhbEluc3BlY3Rpb25VVUlEID0gdGhpcy5zZWxlY3RlZEluaXRpYWxJbnNwZWN0aW9uQnlBc3NldC52YWx1ZTsKICAgICAgICB9IGVsc2UgaWYgKHRoaXMuc2VsZWN0ZWRJbml0aWFsSW5zcGVjdGlvbkJ5QXNzZXRDYXRlZ29yeSAhPT0gbnVsbCkgewogICAgICAgICAgd29ya09yZGVyLnBsYW5uaW5nLmluaXRpYWxJbnNwZWN0aW9uVVVJRCA9IHRoaXMuc2VsZWN0ZWRJbml0aWFsSW5zcGVjdGlvbkJ5QXNzZXRDYXRlZ29yeS52YWx1ZTsKICAgICAgICB9IGVsc2UgewogICAgICAgICAgd29ya09yZGVyLnBsYW5uaW5nLmluaXRpYWxJbnNwZWN0aW9uVVVJRCA9IHRoaXMuc2VsZWN0ZWRGaW5hbEluc3BlY3Rpb25CeVdvcmtPcmRlci52YWx1ZTsKICAgICAgICB9CiAgICAgIH0KCiAgICAgIGlmICh3b3JrT3JkZXIucGxhbm5pbmcuZnJvbUluc3BlY3Rpb25GaW5hbCkgewogICAgICAgIGlmICh0aGlzLnNhbWVBc0luaXRpYWxJbnNwZWN0aW9uKSB7CiAgICAgICAgICB3b3JrT3JkZXIucGxhbm5pbmcuZmluYWxJbnNwZWN0aW9uVVVJRCA9IHdvcmtPcmRlci5wbGFubmluZy5pbml0aWFsSW5zcGVjdGlvblVVSUQ7CiAgICAgICAgfSBlbHNlIHsKICAgICAgICAgIGlmICh0aGlzLnNlbGVjdGVkRmluYWxJbnNwZWN0aW9uQnlBc3NldCAhPT0gbnVsbCkgewogICAgICAgICAgICB3b3JrT3JkZXIucGxhbm5pbmcuZmluYWxJbnNwZWN0aW9uVVVJRCA9IHRoaXMuc2VsZWN0ZWRGaW5hbEluc3BlY3Rpb25CeUFzc2V0LnZhbHVlOwogICAgICAgICAgfSBlbHNlIGlmICh0aGlzLnNlbGVjdGVkRmluYWxJbnNwZWN0aW9uQnlBc3NldENhdGVnb3J5ICE9PSBudWxsKSB7CiAgICAgICAgICAgIHdvcmtPcmRlci5wbGFubmluZy5maW5hbEluc3BlY3Rpb25VVUlEID0gdGhpcy5zZWxlY3RlZEZpbmFsSW5zcGVjdGlvbkJ5QXNzZXRDYXRlZ29yeS52YWx1ZTsKICAgICAgICAgIH0gZWxzZSB7CiAgICAgICAgICAgIHdvcmtPcmRlci5wbGFubmluZy5maW5hbEluc3BlY3Rpb25VVUlEID0gdGhpcy5zZWxlY3RlZEZpbmFsSW5zcGVjdGlvbkJ5V29ya09yZGVyLnZhbHVlOwogICAgICAgICAgfQogICAgICAgIH0KICAgICAgfQoKICAgICAgaWYgKHRoaXMuY2hlY2tFeGlzdGluZ0luaXRpYWxJbnNwZWN0aW9uKSB7CiAgICAgICAgd29ya09yZGVyLnBsYW5uaW5nLmZyb21FeGlzdGluZ0luaXRpYWwgPSB0cnVlOwogICAgICAgIHdvcmtPcmRlci5wbGFubmluZy5mcm9tSW5zcGVjdGlvbkluaXRpYWwgPSBmYWxzZTsKICAgICAgICB3b3JrT3JkZXIucGxhbm5pbmcuaW5pdGlhbEluc3BlY3Rpb25VVUlEID0gdGhpcy5pbml0aWFsSW5zcGVjdGlvblRlbXAudXVpZDsKICAgICAgfSBlbHNlIHsKICAgICAgICB3b3JrT3JkZXIucGxhbm5pbmcuaW5pdGlhbEluc3BlY3Rpb25VVUlEID0gbnVsbDsKICAgICAgfQoKICAgICAgaWYgKHRoaXMuZmluYWxJbnNwZWN0aW9uU2VsZWN0aW9uID09PSAiU2VsZWN0IEV4aXN0aW5nIikgewogICAgICAgIHdvcmtPcmRlci5wbGFubmluZy5mcm9tRXhpc3RpbmdGaW5hbCA9IHRydWU7CiAgICAgICAgd29ya09yZGVyLnBsYW5uaW5nLmZyb21JbnNwZWN0aW9uSW5pdGlhbCA9IGZhbHNlOwogICAgICAgIHdvcmtPcmRlci5wbGFubmluZy5maW5hbEluc3BlY3Rpb25VVUlEID0gdGhpcy5zZWxlY3RlZEZpbmFsSW5zcGVjdGlvbkJ5QXNzZXRDYXRlZ29yeS51dWlkOwogICAgICB9IGVsc2UgewogICAgICAgIHdvcmtPcmRlci5wbGFubmluZy5maW5hbEluc3BlY3Rpb25VVUlEID0gbnVsbDsKICAgICAgfQoKICAgICAgaWYgKHRoaXMuZmluYWxJbnNwZWN0aW9uU2VsZWN0aW9uID09PSAiU2FtZSBBcyBJbml0aWFsIiAmJiB0aGlzLmNoZWNrRXhpc3RpbmdJbml0aWFsSW5zcGVjdGlvbiA9PSB0cnVlKSB7CiAgICAgICAgd29ya09yZGVyLnBsYW5uaW5nLmZpbmFsSW5zcGVjdGlvblVVSUQgPSB0aGlzLmluaXRpYWxJbnNwZWN0aW9uVGVtcC51dWlkOwogICAgICAgIHdvcmtPcmRlci5wbGFubmluZy5mcm9tRXhpc3RpbmdGaW5hbCA9IHRydWU7CiAgICAgIH0KCiAgICAgIGlmICh3b3JrT3JkZXIucGxhbm5pbmcuaW5pdGlhbEluc3BlY3Rpb25VVUlEID09PSB3b3JrT3JkZXIucGxhbm5pbmcuZmluYWxJbnNwZWN0aW9uVVVJRCkgewogICAgICAgIHdvcmtPcmRlci5wbGFubmluZy5zYW1lSW5zcGVjdGlvbiA9IHRydWU7CiAgICAgIH0gZWxzZSBpZiAod29ya09yZGVyLnBsYW5uaW5nLmluaXRpYWxJbnNwZWN0aW9uVVVJRCA9PSBudWxsIHx8IHdvcmtPcmRlci5wbGFubmluZy5maW5hbEluc3BlY3Rpb25VVUlEID09IG51bGwpIHsKICAgICAgICB3b3JrT3JkZXIucGxhbm5pbmcuc2FtZUluc3BlY3Rpb24gPSBmYWxzZTsKICAgICAgfQoKICAgICAgaWYgKHRoaXMuc2VsZWN0ZWRVc2VyKSB7CiAgICAgICAgd29ya09yZGVyLmFzc2lnbmVkVG9Vc2VyTmFtZSA9IHRoaXMuc2VsZWN0ZWRVc2VyLm5hbWU7CiAgICAgICAgd29ya09yZGVyLmFzc2lnbmVkVG9Vc2VyVVVJRCA9IHRoaXMuc2VsZWN0ZWRVc2VyLnV1aWQ7CiAgICAgIH0KCiAgICAgIGlmICh3b3JrT3JkZXIuYXNzaWduZWRUb1VzZXJOYW1lKSB7CiAgICAgICAgd29ya09yZGVyLmFzc2lnbmVlcyA9IFt7CiAgICAgICAgICB1dWlkOiB3b3JrT3JkZXIuYXNzaWduZWRUb1VzZXJVVUlELAogICAgICAgICAgbmFtZTogd29ya09yZGVyLmFzc2lnbmVkVG9Vc2VyTmFtZQogICAgICAgIH1dOwogICAgICB9IGVsc2UgewogICAgICAgIGxldCByZXNwb25zZSA9IEFzc2V0UGVyc29ubmVsU2VydmljZS5nZXRVc2VyR3JvdXBCeVVVSUQodGhpcy5zZWxlY3RlZFVzZXJHcm91cC5zZWxlY3RlZE9iamVjdC5ncm91cFVVSUQpOwoKICAgICAgICBpZiAocmVzcG9uc2Uuc3RhdHVzID09PSAyMDApIHsKICAgICAgICAgIHdvcmtPcmRlci5hc3NpZ25lZXMgPSBbXTsKICAgICAgICAgIHJlc3BvbnNlLmRhdGEudXNlckdyb3VwLnVzZXJzLm1hcCh1c2VyID0+IHsKICAgICAgICAgICAgd29ya09yZGVyLmFzc2lnbmVlcy5wdXNoKHsKICAgICAgICAgICAgICB1dWlkOiB1c2VyLnV1aWQsCiAgICAgICAgICAgICAgbmFtZTogdXNlci5maXJzdE5hbWUgKyAiICIgKyB1c2VyLmxhc3ROYW1lCiAgICAgICAgICAgIH0pOwogICAgICAgICAgICByZXR1cm4gdXNlcjsKICAgICAgICAgIH0pOwogICAgICAgIH0KICAgICAgfQoKICAgICAgd29ya09yZGVyLnByaW9yaXR5ID0gdGhpcy53b3JrT3JkZXJTdW1tYXJ5LnByaW9yaXR5OwogICAgICB3b3JrT3JkZXIuc2NoZWR1bGUgPSBtb21lbnQodGhpcy53b3JrT3JkZXJTdW1tYXJ5LnNoZWR1bGUpOwogICAgICB3b3JrT3JkZXIuYXNzZXRVVUlEID0gdGhpcy53b3JrT3JkZXJTdW1tYXJ5Lmlzc3Vlc1swXS5hc3NldFVVSUQ7CiAgICAgIHdvcmtPcmRlci50ZW5hbnRVVUlEID0gdGhpcy5jdXJyZW50VXNlckRldGFpbHMucHJvZmlsZS5vcmdhbml6YXRpb25JZDsKICAgICAgd29ya09yZGVyLnN0YXR1cyA9IHRoaXMud29ya09yZGVyU3VtbWFyeS5pc3N1ZXNbMF0uc3RhdHVzOwogICAgICB3b3JrT3JkZXIuc2hpZnQgPSB0aGlzLndvcmtPcmRlclN1bW1hcnkuc2hpZnQ7CiAgICAgIHdvcmtPcmRlci5pc3N1ZXMgPSBpc3N1ZXM7CiAgICAgIGNyZWF0ZVdvcmtPcmRlclJlcXVlc3Qud29ya09yZGVyID0gd29ya09yZGVyOwoKICAgICAgaWYgKHRoaXMuY2hlY2tFeGlzdGluZ0luaXRpYWxJbnNwZWN0aW9uID09PSB0cnVlKSB7CiAgICAgICAgY3JlYXRlV29ya09yZGVyUmVxdWVzdC5pbml0aWFsSW5zcGVjdGlvblRlbXBsYXRlID0gbnVsbDsKICAgICAgfSBlbHNlIHsKICAgICAgICBjcmVhdGVXb3JrT3JkZXJSZXF1ZXN0LmluaXRpYWxJbnNwZWN0aW9uVGVtcGxhdGUgPSBpbml0aWFsSW5zcGVjdGlvblRlbXBsYXRlOwogICAgICAgIHdvcmtPcmRlci5wbGFubmluZy5mcm9tRXhpc3RpbmdJbml0aWFsID0gZmFsc2U7CiAgICAgICAgd29ya09yZGVyLnBsYW5uaW5nLmZyb21JbnNwZWN0aW9uSW5pdGlhbCA9IGZhbHNlOwogICAgICB9CgogICAgICBpZiAodGhpcy5maW5hbEluc3BlY3Rpb25TZWxlY3Rpb24gPT09ICJDcmVhdGUgTmV3IEluc3BlY3Rpb24gVGVtcGxhdGUiKSB7CiAgICAgICAgY3JlYXRlV29ya09yZGVyUmVxdWVzdC5maW5hbEluc3BlY3Rpb25UZW1wbGF0ZSA9IGZpbmFsSW5zcGVjdGlvblRlbXBsYXRlOwogICAgICAgIHdvcmtPcmRlci5wbGFubmluZy5mcm9tRXhpc3RpbmdGaW5hbCA9IGZhbHNlOwogICAgICAgIHdvcmtPcmRlci5wbGFubmluZy5mcm9tSW5zcGVjdGlvbkZpbmFsID0gZmFsc2U7CiAgICAgICAgd29ya09yZGVyLnBsYW5uaW5nLnNhbWVJbnNwZWN0aW9uID0gZmFsc2U7CiAgICAgIH0gZWxzZSBpZiAodGhpcy5maW5hbEluc3BlY3Rpb25TZWxlY3Rpb24gPT09ICJTYW1lIEFzIEluaXRpYWwiICYmIHRoaXMuY2hlY2tFeGlzdGluZ0luaXRpYWxJbnNwZWN0aW9uICE9PSB0cnVlKSB7CiAgICAgICAgY3JlYXRlV29ya09yZGVyUmVxdWVzdC5maW5hbEluc3BlY3Rpb25UZW1wbGF0ZSA9IGluaXRpYWxJbnNwZWN0aW9uVGVtcGxhdGU7CiAgICAgICAgd29ya09yZGVyLnBsYW5uaW5nLmZyb21FeGlzdGluZ0ZpbmFsID0gd29ya09yZGVyLnBsYW5uaW5nLmZyb21FeGlzdGluZ0luaXRpYWw7CiAgICAgICAgd29ya09yZGVyLnBsYW5uaW5nLmZyb21JbnNwZWN0aW9uRmluYWwgPSB3b3JrT3JkZXIucGxhbm5pbmcuZnJvbUluc3BlY3Rpb25Jbml0aWFsOwogICAgICB9IGVsc2UgaWYgKHRoaXMuZmluYWxJbnNwZWN0aW9uU2VsZWN0aW9uID09PSAiU2VsZWN0IEV4aXN0aW5nIikgewogICAgICAgIGNyZWF0ZVdvcmtPcmRlclJlcXVlc3QuZmluYWxJbnNwZWN0aW9uVGVtcGxhdGUgPSBudWxsOwogICAgICAgIHdvcmtPcmRlci5wbGFubmluZy5zYW1lSW5zcGVjdGlvbiA9IGZhbHNlOwogICAgICB9IGVsc2UgewogICAgICAgIGNyZWF0ZVdvcmtPcmRlclJlcXVlc3QuZmluYWxJbnNwZWN0aW9uVGVtcGxhdGUgPSBudWxsOwogICAgICB9IC8vCWNyZWF0ZVdvcmtPcmRlclJlcXVlc3QuaW5pdGlhbEluc3BlY3Rpb25UZW1wbGF0ZSA9IGluaXRpYWxJbnNwZWN0aW9uVGVtcGxhdGU7CiAgICAgIC8vCWNyZWF0ZVdvcmtPcmRlclJlcXVlc3QuZmluYWxJbnNwZWN0aW9uVGVtcGxhdGUgPSBmaW5hbEluc3BlY3Rpb25UZW1wbGF0ZTsKCgogICAgICBjcmVhdGVXb3JrT3JkZXJSZXF1ZXN0LmluaXRpYWxJbnNwZWN0aW9uT3B0aW9uID0gaW5pdGlhbEluc3BlY3Rpb25PcHRpb247CiAgICAgIGNyZWF0ZVdvcmtPcmRlclJlcXVlc3QuZmluYWxJbnNwZWN0aW9uT3B0aW9uID0gZmluYWxJbnNwZWN0aW9uT3B0aW9uOwogICAgICBjcmVhdGVXb3JrT3JkZXJSZXF1ZXN0LmluaXRpYWxJbnNwZWN0aW9uVGVtcGxhdGVMaW5raW5nVVVJRCA9IGluaXRpYWxJbnNwZWN0aW9uVGVtcGxhdGVMaW5raW5nVVVJRDsKICAgICAgY3JlYXRlV29ya09yZGVyUmVxdWVzdC5maW5hbEluc3BlY3Rpb25UZW1wbGF0ZUxpbmtpbmdVVUlEID0gZmluYWxJbnNwZWN0aW9uVGVtcGxhdGVMaW5raW5nVVVJRDsKICAgICAgY3JlYXRlV29ya09yZGVyUmVxdWVzdC5pbml0aWFsTGlua0luc3BlY3Rpb25UeXBlID0gaW5pdGlhbExpbmtJbnNwZWN0aW9uVHlwZTsKICAgICAgY3JlYXRlV29ya09yZGVyUmVxdWVzdC5maW5hbExpbmtJbnNwZWN0aW9uVHlwZSA9IGZpbmFsTGlua0luc3BlY3Rpb25UeXBlOwogICAgICBjcmVhdGVXb3JrT3JkZXJSZXF1ZXN0LnJlc29sdXRpb25zID0gcmVzb2x1dGlvbnM7CiAgICAgIHRoaXMuJGVtaXQoInJlcXVlc3RPYmplY3QiLCBjcmVhdGVXb3JrT3JkZXJSZXF1ZXN0KTsKICAgIH0sCgogICAgZ2V0Rm9ybUVycm9yTWVzc2FnZShmaWVsZFZhbGlkYXRpb24pIHsKICAgICAgaWYgKGZpZWxkVmFsaWRhdGlvbi4kZGlydHkpIHsKICAgICAgICByZXR1cm4gRnVuY3Rpb25zLmdldEZvcm1GaWVsZEVycm9yTWVzc2FnZShmaWVsZFZhbGlkYXRpb24pOwogICAgICB9CiAgICB9LAoKICAgIGFkZEluc3RydWN0aW9uKGluZGV4KSB7CiAgICAgIHRoaXMud29ya09yZGVyU3VtbWFyeS5pc3N1ZXNbaW5kZXhdLmluc3RydWN0aW9uQ2hlY2tsaXN0LnB1c2goewogICAgICAgIHZhbHVlOiAiIgogICAgICB9KTsKICAgIH0sCgogICAgc3ViSW5zdHJ1Y3Rpb24oaW5kZXgsIGluc3RydWN0aW9uSW5kZXgpIHsKICAgICAgdGhpcy53b3JrT3JkZXJTdW1tYXJ5Lmlzc3Vlc1tpbmRleF0uaW5zdHJ1Y3Rpb25DaGVja2xpc3Quc3BsaWNlKGluc3RydWN0aW9uSW5kZXgsIDEpOwogICAgfSwKCiAgICB1c2Vyc1NlbGVjdGVkKHZhbHVlKSB7CiAgICAgIHRoaXMuc2VsZWN0ZWRVc2VyID0gdmFsdWUuc2VsZWN0ZWRPYmplY3Q7CiAgICB9LAoKICAgIGNsZWFyU2VsZWN0ZWRVc2VyKCkgewogICAgICB0aGlzLndvcmtPcmRlclN1bW1hcnkudXNlciA9ICIiOwogICAgICB0aGlzLnNlbGVjdGVkVXNlciA9ICIiOwogICAgICB0aGlzLnVzZXJSZXNldCsrOwogICAgfSwKCiAgICBmaW5hbEluc3BlY3Rpb25CeUFzc2V0U2VsZWN0ZWQodmFsdWUpIHsKICAgICAgdGhpcy5zZWxlY3RlZEZpbmFsSW5zcGVjdGlvbkJ5QXNzZXQgPSB2YWx1ZS5zZWxlY3RlZE9iamVjdDsKICAgICAgdGhpcy5maW5hbEluc3BlY3Rpb25CeUFzc2V0Q2F0ZWdvcnkgPSAiIjsKICAgICAgdGhpcy5zZWxlY3RlZEZpbmFsSW5zcGVjdGlvbkJ5QXNzZXRDYXRlZ29yeSA9ICIiOwogICAgICB0aGlzLmZpbmFsSW5zcGVjdGlvbkJ5V29ya09yZGVyID0gIiI7CiAgICAgIHRoaXMuc2VsZWN0ZWRGaW5hbEluc3BlY3Rpb25CeVdvcmtPcmRlciA9ICIiOwogICAgICB0aGlzLmZpbmFsSW5zcGVjdGlvblJlc2V0Kys7CiAgICB9LAoKICAgIGZpbmFsSW5zcGVjdGlvbkJ5QXNzZXRDYXRlZ29yeVNlbGVjdGVkKHZhbHVlKSB7CiAgICAgIHRoaXMuc2VsZWN0ZWRGaW5hbEluc3BlY3Rpb25CeUFzc2V0Q2F0ZWdvcnkgPSB2YWx1ZS5zZWxlY3RlZE9iamVjdDsKICAgICAgdGhpcy53b3JrT3JkZXJTdW1tYXJ5LnNlbGVjdGVkRmluYWxJbnNwZWN0aW9uQnlBc3NldENhdGVnb3J5ID0gdGhpcy5zZWxlY3RlZEZpbmFsSW5zcGVjdGlvbkJ5QXNzZXRDYXRlZ29yeTsKICAgICAgdGhpcy5maW5hbEluc3BlY3Rpb25CeUFzc2V0ID0gIiI7CiAgICAgIHRoaXMuc2VsZWN0ZWRGaW5hbEluc3BlY3Rpb25CeUFzc2V0ID0gIiI7CiAgICAgIHRoaXMuZmluYWxJbnNwZWN0aW9uQnlXb3JrT3JkZXIgPSAiIjsKICAgICAgdGhpcy5zZWxlY3RlZEZpbmFsSW5zcGVjdGlvbkJ5V29ya09yZGVyID0gIiI7CiAgICAgIHRoaXMuZmluYWxJbnNwZWN0aW9uUmVzZXQrKzsKICAgIH0sCgogICAgY2xlYXJTZWxlY3RlZEZpbmFsSW5zcGVjdGlvbkJ5QXNzZXQoKSB7CiAgICAgIHRoaXMuZmluYWxJbnNwZWN0aW9uQnlBc3NldENhdGVnb3J5ID0gIiI7CiAgICAgIHRoaXMuZmluYWxJbnNwZWN0aW9uUmVzZXQrKzsKICAgIH0sCgogICAgZmluYWxJbnNwZWN0aW9uQnlXb3JrT3JkZXJTZWxlY3RlZCh2YWx1ZSkgewogICAgICB0aGlzLnNlbGVjdGVkRmluYWxJbnNwZWN0aW9uQnlXb3JrT3JkZXIgPSB2YWx1ZS5zZWxlY3RlZE9iamVjdDsKICAgICAgdGhpcy5maW5hbEluc3BlY3Rpb25CeUFzc2V0ID0gIiI7CiAgICAgIHRoaXMuc2VsZWN0ZWRGaW5hbEluc3BlY3Rpb25CeUFzc2V0ID0gIiI7CiAgICAgIHRoaXMuZmluYWxJbnNwZWN0aW9uQnlBc3NldENhdGVnb3J5ID0gIiI7CiAgICAgIHRoaXMuc2VsZWN0ZWRGaW5hbEluc3BlY3Rpb25CeUFzc2V0Q2F0ZWdvcnkgPSAiIjsKICAgICAgdGhpcy5maW5hbEluc3BlY3Rpb25SZXNldCsrOwogICAgfSwKCiAgICBpbml0aWFsSW5zcGVjdGlvbkJ5QXNzZXRTZWxlY3RlZCh2YWx1ZSkgewogICAgICB0aGlzLnNlbGVjdGVkSW5pdGlhbEluc3BlY3Rpb25CeUFzc2V0ID0gdmFsdWUuc2VsZWN0ZWRPYmplY3Q7CiAgICAgIHRoaXMuaW5pdGlhbEluc3BlY3Rpb25CeUFzc2V0Q2F0ZWdvcnkgPSAiIjsKICAgICAgdGhpcy5zZWxlY3RlZEluaXRpYWxJbnNwZWN0aW9uQnlBc3NldENhdGVnb3J5ID0gIiI7CiAgICAgIHRoaXMuaW5pdGlhbEluc3BlY3Rpb25CeVdvcmtPcmRlciA9ICIiOwogICAgICB0aGlzLnNlbGVjdGVkSW5pdGlhbEluc3BlY3Rpb25CeVdvcmtPcmRlciA9ICIiOwogICAgICB0aGlzLmluc3BlY3Rpb25SZXNldCsrOwogICAgfSwKCiAgICBpbml0aWFsSW5zcGVjdGlvbkJ5QXNzZXRDYXRlZ29yeVNlbGVjdGVkKHZhbHVlKSB7CiAgICAgIHRoaXMuaW5pdGlhbEluc3BlY3Rpb25UZW1wID0gdmFsdWUuc2VsZWN0ZWRPYmplY3Q7CgogICAgICBpZiAodGhpcy5zYW1lID09PSB0cnVlKSB7CiAgICAgICAgaWYgKHRoaXMuY2hlY2tFeGlzdGluZ0luaXRpYWxJbnNwZWN0aW9uID09PSB0cnVlKSB7CiAgICAgICAgICB0aGlzLndvcmtPcmRlclN1bW1hcnkuc2VsZWN0ZWRGaW5hbEluc3BlY3Rpb25CeUFzc2V0Q2F0ZWdvcnkgPSB2YWx1ZS5zZWxlY3RlZE9iamVjdDsKICAgICAgICAgIHRoaXMud29ya09yZGVyU3VtbWFyeUluZGV4Kys7CiAgICAgICAgfQogICAgICB9CgogICAgICB0aGlzLnNlbGVjdGVkSW5pdGlhbEluc3BlY3Rpb25CeUFzc2V0Q2F0ZWdvcnkgPSB2YWx1ZS5zZWxlY3RlZE9iamVjdDsKICAgICAgdGhpcy53b3JrT3JkZXJTdW1tYXJ5LnNlbGVjdGVkSW5pdGlhbEluc3BlY3Rpb25CeUFzc2V0Q2F0ZWdvcnkgPSB0aGlzLnNlbGVjdGVkSW5pdGlhbEluc3BlY3Rpb25CeUFzc2V0Q2F0ZWdvcnk7CiAgICAgIHRoaXMuaW5pdGlhbEluc3BlY3Rpb25CeUFzc2V0ID0gIiI7CiAgICAgIHRoaXMuc2VsZWN0ZWRJbml0aWFsSW5zcGVjdGlvbkJ5QXNzZXQgPSAiIjsKICAgICAgdGhpcy5pbml0aWFsSW5zcGVjdGlvbkJ5V29ya09yZGVyID0gIiI7CiAgICAgIHRoaXMuc2VsZWN0ZWRJbml0aWFsSW5zcGVjdGlvbkJ5V29ya09yZGVyID0gIiI7CiAgICAgIHRoaXMuaW5zcGVjdGlvblJlc2V0Kys7CiAgICB9LAoKICAgIGluaXRpYWxJbnNwZWN0aW9uQnlXb3JrT3JkZXJTZWxlY3RlZCh2YWx1ZSkgewogICAgICB0aGlzLnNlbGVjdGVkSW5pdGlhbEluc3BlY3Rpb25CeVdvcmtPcmRlciA9IHZhbHVlLnNlbGVjdGVkT2JqZWN0OwogICAgICB0aGlzLmluaXRpYWxJbnNwZWN0aW9uQnlBc3NldCA9ICIiOwogICAgICB0aGlzLnNlbGVjdGVkSW5pdGlhbEluc3BlY3Rpb25CeUFzc2V0ID0gIiI7CiAgICAgIHRoaXMuaW5pdGlhbEluc3BlY3Rpb25CeUFzc2V0Q2F0ZWdvcnkgPSAiIjsKICAgICAgdGhpcy5zZWxlY3RlZEluaXRpYWxJbnNwZWN0aW9uQnlBc3NldENhdGVnb3J5ID0gIiI7CiAgICAgIHRoaXMuaW5zcGVjdGlvblJlc2V0Kys7CiAgICB9LAoKICAgIGdldElzc3VlQnlVVUlEKGlzc3VlVVVJRFMpIHsKICAgICAgaXNzdWVVVUlEUy5tYXAoKGlzc3VldXVpZCwgaW5kZXgpID0+IHsKICAgICAgICBJbnNwZWN0aW9uU2VydmljZS5nZXRJc3N1ZUJ5VVVJRChpc3N1ZXV1aWQpLnRoZW4ocmVzcG9uc2UgPT4gewogICAgICAgICAgaWYgKHJlc3BvbnNlLnN0YXR1cyA9PT0gMjAwKSB7CiAgICAgICAgICAgIGxldCBwYXJ0ID0gewogICAgICAgICAgICAgIG5hbWU6ICIiLAogICAgICAgICAgICAgIHV1aWQ6IHRoaXMuZ2VuZXJhdGVVVUlEKCksCiAgICAgICAgICAgICAgcXVhbnRpdHk6ICIiLAogICAgICAgICAgICAgIGNvc3Q6IHsKICAgICAgICAgICAgICAgIGNhdGVnb3J5OiAicGFydC1jb3N0IiwKICAgICAgICAgICAgICAgIGFtb3VudDogIiIsCiAgICAgICAgICAgICAgICByZXBvcnRhYmxlOiB0cnVlCiAgICAgICAgICAgICAgfSwKICAgICAgICAgICAgICBleHRyYUNvc3Q6IFt7CiAgICAgICAgICAgICAgICBjYXRlZ29yeTogInRheC1jb3N0IiwKICAgICAgICAgICAgICAgIGFtb3VudDogIiIsCiAgICAgICAgICAgICAgICByZXBvcnRhYmxlOiB0cnVlCiAgICAgICAgICAgICAgfV0KICAgICAgICAgICAgfTsKICAgICAgICAgICAgcmVzcG9uc2UuZGF0YS5pc3N1ZVJlcG9ydGluZy5pbnN0cnVjdGlvbkNoZWNrbGlzdCA9IEpTT04ucGFyc2UocmVzcG9uc2UuZGF0YS5pc3N1ZVJlcG9ydGluZy5pbnN0cnVjdGlvbkNoZWNrbGlzdCk7CgogICAgICAgICAgICBpZiAocmVzcG9uc2UuZGF0YS5pc3N1ZVJlcG9ydGluZy5pbnN0cnVjdGlvbkNoZWNrbGlzdCA9PT0gbnVsbCkgewogICAgICAgICAgICAgIHJlc3BvbnNlLmRhdGEuaXNzdWVSZXBvcnRpbmcuaW5zdHJ1Y3Rpb25DaGVja2xpc3QgPSBbXTsKICAgICAgICAgICAgICByZXNwb25zZS5kYXRhLmlzc3VlUmVwb3J0aW5nLmluc3RydWN0aW9uQ2hlY2tsaXN0LnB1c2goewogICAgICAgICAgICAgICAgdmFsdWU6ICIiCiAgICAgICAgICAgICAgfSk7CiAgICAgICAgICAgIH0KCiAgICAgICAgICAgIHJlc3BvbnNlLmRhdGEuaXNzdWVSZXBvcnRpbmcucGFydHMgPSBbXTsKICAgICAgICAgICAgcmVzcG9uc2UuZGF0YS5pc3N1ZVJlcG9ydGluZy5wYXJ0cy5wdXNoKHBhcnQpOwogICAgICAgICAgICByZXNwb25zZS5kYXRhLmlzc3VlUmVwb3J0aW5nLnJlcG9ydGVkQXQgPSBtb21lbnQocmVzcG9uc2UuZGF0YS5pc3N1ZVJlcG9ydGluZy5yZXBvcnRlZEF0KS5mb3JtYXQoIkREIE1NTSBZWVlZIik7CiAgICAgICAgICAgIHRoaXMud29ya09yZGVyU3VtbWFyeS5pc3N1ZXMucHVzaChyZXNwb25zZS5kYXRhLmlzc3VlUmVwb3J0aW5nKTsKCiAgICAgICAgICAgIGlmIChpbmRleCA9PT0gMCkgewogICAgICAgICAgICAgIHRoaXMuZ2V0QXNzZXQodGhpcy53b3JrT3JkZXJTdW1tYXJ5Lmlzc3Vlc1tpbmRleF0uYXNzZXRVVUlEKTsKICAgICAgICAgICAgfQogICAgICAgICAgfQogICAgICAgIH0pLmNhdGNoKGVycm9yID0+IHsKICAgICAgICAgIHRoaXMuc2hvd1RvYXN0KGVycm9yLmRhdGEucmVzcG9uc2UsICJlcnJvciIpOwogICAgICAgIH0pOwogICAgICB9KTsKICAgIH0sCgogICAgZ2V0QXNzZXQodXVpZCkgewogICAgICBBc3NldE1hbmFnZW1lbnRTZXJ2aWNlLmdldEFzc2V0V2l0aERldGFpbHModXVpZCwgdHJ1ZSwgdHJ1ZSkudGhlbihyZXNwb25zZSA9PiB7CiAgICAgICAgdGhpcy5hc3NldHMgPSByZXNwb25zZS5kYXRhLmFzc2V0RGV0YWlsOwogICAgICAgIHRoaXMuZ2V0SW5zcGVjdGlvblRlbXBsYXRlcyh1dWlkLCB0aGlzLmN1cnJlbnRVc2VyRGV0YWlscy5wcm9maWxlLm9yZ2FuaXphdGlvbklkKTsKICAgICAgICB0aGlzLmdldEluc3BlY3Rpb25UZW1wbGF0ZUZyb21Xb3JrT3JkZXIodGhpcy5jdXJyZW50VXNlckRldGFpbHMucHJvZmlsZS5vcmdhbml6YXRpb25JZCk7CiAgICAgICAgdGhpcy5nZXRJbnNwZWN0aW9uVGVtYXBsYXRlc0J5QXNzZXRDYXRlZ29yeSh0aGlzLmFzc2V0cy5jYXRlZ29yeS51dWlkKTsKICAgICAgfSk7CiAgICB9LAoKICAgIGdldFVzZXJzR3JvdXAodGVuYW50VVVJRCkgewogICAgICBBc3NldFBlcnNvbm5lbFNlcnZpY2UuZ2V0QWxsVXNlckdyb3VwKHRlbmFudFVVSUQpLnRoZW4ocmVzcG9uc2UgPT4gewogICAgICAgIGlmIChyZXNwb25zZS5zdGF0dXMgPT09IDIwMCkgewogICAgICAgICAgdGhpcy51c2VyR3JvdXBPcHRpb25zID0gcmVzcG9uc2UuZGF0YS5ncm91cHM7CiAgICAgICAgICB0aGlzLnVzZXJHcm91cE9wdGlvbnMucHVzaCh7CiAgICAgICAgICAgIGdyb3VwVVVJRDogIkFsbCIsCiAgICAgICAgICAgIGdyb3VwTmFtZTogIkFsbCIKICAgICAgICAgIH0pOwogICAgICAgIH0KICAgICAgfSkuY2F0Y2goZXJyb3IgPT4gewogICAgICAgIGlmIChlcnJvcikgewogICAgICAgICAgdGhpcy5zaG93VG9hc3QoZXJyb3IuZGF0YS5yZXNwb25zZSwgImVycm9yIik7CiAgICAgICAgfQogICAgICB9KTsKICAgIH0sCgogICAgZ2V0QWxsVXNlcnModGVuYW50VVVJRCkgewogICAgICBBc3NldFBlcnNvbm5lbFNlcnZpY2UuZ2V0QWxsVXNlcnModGVuYW50VVVJRCkudGhlbihyZXNwb25zZSA9PiB7CiAgICAgICAgaWYgKHJlc3BvbnNlLnN0YXR1cyA9PT0gMjAwKSB7CiAgICAgICAgICB0aGlzLmFsbFVzZXJzID0gcmVzcG9uc2UuZGF0YS51c2VyczsKICAgICAgICAgIHRoaXMudXNlck9wdGlvbnMgPSByZXNwb25zZS5kYXRhLnVzZXJzOwogICAgICAgIH0KICAgICAgfSkuY2F0Y2goZXJyb3IgPT4gewogICAgICAgIGlmIChlcnJvcikge30KICAgICAgfSk7CiAgICB9LAoKICAgIHVzZXJHcm91cHNIYW5kbGVyKGRhdGEpIHsKICAgICAgdGhpcy5zZWxlY3RlZFVzZXJHcm91cCA9IGRhdGEuc2VsZWN0ZWRPYmplY3Q7CgogICAgICBpZiAoZGF0YS5zZWxlY3RlZE9iamVjdC5ncm91cE5hbWUgPT09ICJBbGwiKSB7CiAgICAgICAgdGhpcy51c2VyT3B0aW9ucyA9IHRoaXMuYWxsVXNlcnM7CiAgICAgIH0gZWxzZSB7CiAgICAgICAgdGhpcy51c2VyID0gIiI7CiAgICAgICAgQXNzZXRQZXJzb25uZWxTZXJ2aWNlLmdldFVzZXJHcm91cEJ5VVVJRChkYXRhLnNlbGVjdGVkT2JqZWN0Lmdyb3VwVVVJRCkudGhlbihyZXNwb25zZSA9PiB7CiAgICAgICAgICB0aGlzLnVzZXJPcHRpb25zID0gW107CiAgICAgICAgICB0aGlzLnVzZXIgPSAiIjsKICAgICAgICAgIHRoaXMudXNlck9wdGlvbnMgPSByZXNwb25zZS5kYXRhLnVzZXJHcm91cC51c2VyczsKICAgICAgICB9KTsKICAgICAgfQoKICAgICAgdGhpcy51c2VyID0gIiI7CiAgICAgIHRoaXMud29ya09yZGVyU3VtbWFyeS51c2VyID0gIiI7CiAgICAgIHRoaXMudXNlclJlc2V0Kys7CiAgICB9LAoKICAgIGNsZWFyU2VsZWN0ZWRVc2VyR3JvdXAoKSB7CiAgICAgIHRoaXMud29ya09yZGVyU3VtbWFyeS51c2VyR3JvdXAgPSAiIjsKICAgICAgdGhpcy51c2VyT3B0aW9ucyA9IHRoaXMuYWxsVXNlcnM7CiAgICAgIHRoaXMudXNlclJlc2V0Kys7CiAgICB9LAoKICAgIGdldEluc3BlY3Rpb25UZW1wbGF0ZXMoYXNzZXRVVUlELCB0ZW5hbnRVVUlEKSB7CiAgICAgIEluc3BlY3Rpb25TZXJ2aWNlLmdldEluc3BlY3Rpb25UZW1wbGF0ZU5hbWVBbmRVVUlEKGFzc2V0VVVJRCwgdGVuYW50VVVJRCkudGhlbihyZXNwb25zZSA9PiB7CiAgICAgICAgaWYgKHJlc3BvbnNlLnN0YXR1cyA9PT0gMjAwKSB7CiAgICAgICAgICB0aGlzLmluc3BlY3Rpb25CeUFzc2V0T3B0aW9ucyA9IHJlc3BvbnNlLmRhdGEuaW5zcGVjdGlvbnM7CiAgICAgICAgfQogICAgICB9KS5jYXRjaChlcnJvciA9PiB7CiAgICAgICAgdGhpcy5zaG93VG9hc3QoZXJyb3IuZGF0YS5yZXNwb25zZSwgImVycm9yIik7CiAgICAgIH0pOwogICAgfSwKCiAgICBnZXRJbnNwZWN0aW9uVGVtcGxhdGVGcm9tV29ya09yZGVyKHRlbmFudFVVSUQpIHsKICAgICAgV29ya09yZGVyU2VydmljZS5nZXRXb3JrT3JkZXJJbnNwZWN0aW9uVGVtcGxhdGVzKHRlbmFudFVVSUQpLnRoZW4ocmVzcG9uc2UgPT4gewogICAgICAgIGlmIChyZXNwb25zZS5zdGF0dXMgPT09IDIwMCkgewogICAgICAgICAgdGhpcy5pbnBzZWN0aW9uQnlXb3JrT3JkZXJPcHRpb25zID0gcmVzcG9uc2UuZGF0YS5pbnNwZWN0aW9uczsKCiAgICAgICAgICBmb3IgKGxldCBpID0gMDsgaSA8IHRoaXMuaW5wc2VjdGlvbkJ5V29ya09yZGVyT3B0aW9ucy5sZW5ndGg7IGkrKykgewogICAgICAgICAgICBpZiAodGhpcy5pbnBzZWN0aW9uQnlXb3JrT3JkZXJPcHRpb25zW2ldLm5hbWUgPT09ICIiIHx8ICF0aGlzLmlucHNlY3Rpb25CeVdvcmtPcmRlck9wdGlvbnNbaV0ubmFtZSkgewogICAgICAgICAgICAgIHRoaXMuaW5wc2VjdGlvbkJ5V29ya09yZGVyT3B0aW9uc1tpXS5uYW1lID0gIi0iOwogICAgICAgICAgICB9CiAgICAgICAgICB9CiAgICAgICAgfQogICAgICB9KS5jYXRjaChlcnJvciA9PiB7CiAgICAgICAgdGhpcy5zaG93VG9hc3QoZXJyb3IuZGF0YS5yZXNwb25zZSwgImVycm9yIik7CiAgICAgIH0pOwogICAgfSwKCiAgICBnZXRJbnNwZWN0aW9uVGVtYXBsYXRlc0J5QXNzZXRDYXRlZ29yeShjYXRlZ29yeVVVSUQpIHsKICAgICAgSW5zcGVjdGlvblNlcnZpY2UuZ2V0SW5zcGVjdGlvblRlbXBsYXRlTmFtZUFuZFVVSURCeUNhdGVnb3J5VVVJRChjYXRlZ29yeVVVSUQpLnRoZW4ocmVzcG9uc2UgPT4gewogICAgICAgIGlmIChyZXNwb25zZS5zdGF0dXMgPT09IDIwMCkgewogICAgICAgICAgdGhpcy5pbnBzZWN0aW9uQnlBc3NldENhdGVnb3J5T3B0aW9ucyA9IHJlc3BvbnNlLmRhdGEuaW5zcGVjdGlvbnM7CiAgICAgICAgfQogICAgICB9KS5jYXRjaChlcnJvciA9PiB7CiAgICAgICAgdGhpcy5zaG93VG9hc3QoZXJyb3IuZGF0YS5yZXNwb25zZSwgImVycm9yIik7CiAgICAgIH0pOwogICAgfSwKCiAgICByZW1vdmVNdWx0aXBsZUNob2ljZUluaXRpYWwoaW5kZXgsIG0pIHsKICAgICAgdGhpcy5xdWVzdGlvblR5cGVGb3JtSW5pdGlhbFtpbmRleF0uYW5zd2Vycy5zcGxpY2UobSwgMSk7CiAgICB9LAoKICAgIHJlbW92ZU11bHRpcGxlQ2hvaWNlRmluYWwoaW5kZXgsIG0pIHsKICAgICAgdGhpcy5xdWVzdGlvblR5cGVGb3JtRmluYWxbaW5kZXhdLmFuc3dlcnMuc3BsaWNlKG0sIDEpOwogICAgfSwKCiAgICBhZGRBbnN3ZXJzQXJyYXkodmFsdWUsIGluZGV4KSB7CiAgICAgIHRoaXMucXVlc3Rpb25UeXBlRm9ybUluaXRpYWxbaW5kZXhdLnR5cGUgPSB2YWx1ZS5zZWxlY3RlZE9iamVjdC52YWx1ZTsKCiAgICAgIGlmICh2YWx1ZS52YWx1ZSA9PT0gIk11bHRpcGxlIENob2ljZSIpIHsKICAgICAgICB0aGlzLnF1ZXN0aW9uVHlwZUZvcm1Jbml0aWFsW2luZGV4XS5hbnN3ZXJzLnB1c2goIiIsICIiKTsKICAgICAgfSBlbHNlIHsKICAgICAgICB0aGlzLnF1ZXN0aW9uVHlwZUZvcm1Jbml0aWFsW2luZGV4XS5hbnN3ZXJzID0gW107CiAgICAgIH0KICAgIH0sCgogICAgY2xlYXJTZWxlY3RlZEFuc3dlcihpbmRleCkgewogICAgICB0aGlzLnF1ZXN0aW9uVHlwZUZvcm1Jbml0aWFsW2luZGV4XS50eXBlTGFiZWwgPSAiIjsKICAgICAgdGhpcy51cGRhdGVTZWxlY3RDb21wKys7CiAgICB9LAoKICAgIGFkZEFuc3dlcnNBcnJheUZpbmFsKHZhbHVlLCBpbmRleCkgewogICAgICB0aGlzLnF1ZXN0aW9uVHlwZUZvcm1GaW5hbFtpbmRleF0udHlwZSA9IHZhbHVlLnNlbGVjdGVkT2JqZWN0LnZhbHVlOwoKICAgICAgaWYgKHZhbHVlLnZhbHVlID09PSAiTXVsdGlwbGUgQ2hvaWNlIikgewogICAgICAgIHRoaXMucXVlc3Rpb25UeXBlRm9ybUZpbmFsW2luZGV4XS5hbnN3ZXJzLnB1c2goIiIsICIiKTsKICAgICAgfSBlbHNlIHsKICAgICAgICB0aGlzLnF1ZXN0aW9uVHlwZUZvcm1GaW5hbFtpbmRleF0uYW5zd2VycyA9IFtdOwogICAgICB9CiAgICB9LAoKICAgIGFkZE11bHRpcGxlQ2hvaWNlSW5pdGlhbChpbmRleCkgewogICAgICB0aGlzLnF1ZXN0aW9uVHlwZUZvcm1Jbml0aWFsW2luZGV4XS5hbnN3ZXJzLnB1c2goIiIpOwogICAgfSwKCiAgICBhZGRNdWx0aXBsZUNob2ljZUZpbmFsKGluZGV4KSB7CiAgICAgIHRoaXMucXVlc3Rpb25UeXBlRm9ybUZpbmFsW2luZGV4XS5hbnN3ZXJzLnB1c2goIiIpOwogICAgfSwKCiAgICByZW1vdmVJbnB1dEZpZWxkc0luaXRpYWwoaW5kZXgpIHsKICAgICAgdGhpcy5xdWVzdGlvblR5cGVGb3JtSW5pdGlhbC5zcGxpY2UoaW5kZXgsIDEpOwogICAgfSwKCiAgICByZW1vdmVJbnB1dEZpZWxkc0ZpbmFsKGluZGV4KSB7CiAgICAgIHRoaXMucXVlc3Rpb25UeXBlRm9ybUZpbmFsLnNwbGljZShpbmRleCwgMSk7CiAgICB9LAoKICAgIGFkZElucHV0RmllbGRzSW5pdGlhbCgpIHsKICAgICAgdGhpcy5xdWVzdGlvblR5cGVGb3JtSW5pdGlhbC5wdXNoKHsKICAgICAgICBuYW1lOiAiIiwKICAgICAgICB0eXBlOiAiIiwKICAgICAgICBxdWVzdGlvbjogIiIsCiAgICAgICAgYW5zd2VyczogW10sCiAgICAgICAgbWFuZGF0b3J5OiB0cnVlCiAgICAgIH0pOwogICAgfSwKCiAgICBhZGRJbnB1dEZpZWxkc0ZpbmFsKCkgewogICAgICB0aGlzLnF1ZXN0aW9uVHlwZUZvcm1GaW5hbC5wdXNoKHsKICAgICAgICBuYW1lOiAiIiwKICAgICAgICB0eXBlOiAiIiwKICAgICAgICBxdWVzdGlvbjogIiIsCiAgICAgICAgYW5zd2VyczogW10sCiAgICAgICAgbWFuZGF0b3J5OiB0cnVlCiAgICAgIH0pOwogICAgfSwKCiAgICBnZW5lcmF0ZVVVSUQoKSB7CiAgICAgIGxldCBkID0gbmV3IERhdGUoKS5nZXRUaW1lKCk7CgogICAgICBpZiAoRGF0ZS5ub3coKSkgewogICAgICAgIGQgPSBEYXRlLm5vdygpOwogICAgICB9CgogICAgICBsZXQgdXVpZCA9ICJ4eHh4eHh4eC14eHh4LTR4eHgteXh4eC14eHh4eHh4eHh4eHgiLnJlcGxhY2UoL1t4eV0vZywgYyA9PiB7CiAgICAgICAgbGV0IHIgPSAoZCArIE1hdGgucmFuZG9tKCkgKiAxNikgJSAxNiB8IDA7CiAgICAgICAgZCA9IE1hdGguZmxvb3IoZCAvIDE2KTsKICAgICAgICByZXR1cm4gKGMgPT09ICJ4IiA/IHIgOiByICYgMHgzIHwgMHg4KS50b1N0cmluZygxNik7CiAgICAgIH0pOwogICAgICByZXR1cm4gdXVpZDsKICAgIH0sCgogICAgYWRkUGFydChpbmRleCkgewogICAgICBsZXQgaXNzdWVzID0gdGhpcy53b3JrT3JkZXJTdW1tYXJ5Lmlzc3VlczsKICAgICAgbGV0IHBhcnQgPSB7CiAgICAgICAgbmFtZTogIiIsCiAgICAgICAgdXVpZDogdGhpcy5nZW5lcmF0ZVVVSUQoKSwKICAgICAgICBxdWFudGl0eTogIiIsCiAgICAgICAgY29zdDogewogICAgICAgICAgY2F0ZWdvcnk6ICJwYXJ0LWNvc3QiLAogICAgICAgICAgYW1vdW50OiAiIiwKICAgICAgICAgIHJlcG9ydGFibGU6IHRydWUKICAgICAgICB9LAogICAgICAgIGV4dHJhQ29zdDogW3sKICAgICAgICAgIGNhdGVnb3J5OiAidGF4LWNvc3QiLAogICAgICAgICAgYW1vdW50OiAiIiwKICAgICAgICAgIHJlcG9ydGFibGU6IHRydWUKICAgICAgICB9XQogICAgICB9OwogICAgICBpc3N1ZXNbaW5kZXhdLnBhcnRzLnB1c2gocGFydCk7CiAgICAgIHRoaXMud29ya09yZGVyU3VtbWFyeS5pc3N1ZXMgPSBpc3N1ZXM7CiAgICB9LAoKICAgIHJlbW92ZVBhcnRzKGluZGV4LCBrKSB7CiAgICAgIHsKICAgICAgICBsZXQgcGFydCA9IHRoaXMud29ya09yZGVyU3VtbWFyeS5pc3N1ZXNbaW5kZXhdLnBhcnRzOwogICAgICAgIHBhcnQuc3BsaWNlKGssIDEpOwogICAgICB9CiAgICB9LAoKICAgIGFzc2V0RGV0YWlsc2Zyb21TdGQodXVpZCkgewogICAgICBpZiAodXVpZCAhPT0gdW5kZWZpbmVkKSB7CiAgICAgICAgQXNzZXRNYW5hZ2VtZW50U2VydmljZS5nZXRBc3NldCh1dWlkKS50aGVuKHJlcyA9PiB7CiAgICAgICAgICB0aGlzLndvcmtPcmRlclN1bW1hcnkubmFtZSA9IHJlcy5kYXRhLmFzc2V0Lm5hbWU7CgogICAgICAgICAgaWYgKHRoaXMuYXNzZXRDYXRlZ29yeU9wdGlvbnMgIT09ICIiKSB7CiAgICAgICAgICAgIC8vICBkZWJ1Z2dlcgogICAgICAgICAgICBmb3IgKGxldCBpbmRleCA9IDA7IGluZGV4IDwgdGhpcy5hc3NldENhdGVnb3J5T3B0aW9ucy5sZW5ndGg7IGluZGV4KyspIHsKICAgICAgICAgICAgICBpZiAodGhpcy5hc3NldENhdGVnb3J5T3B0aW9uc1tpbmRleF0uY2F0ZWdvcnlVVUlEID09PSByZXMuZGF0YS5jYXRlZ29yeUlkKSB7CiAgICAgICAgICAgICAgICB0aGlzLndvcmtPcmRlclN1bW1hcnkuY2F0ZWdvcnkgPSB0aGlzLmFzc2V0Q2F0ZWdvcnlPcHRpb25zW2luZGV4XS5sYWJlbDsKICAgICAgICAgICAgICB9CiAgICAgICAgICAgIH0KICAgICAgICAgIH0KCiAgICAgICAgICB0aGlzLmdldElzc3Vlc0J5QXNzZXRVVUlEKHJlcy5kYXRhLmFzc2V0LnV1aWQpOwogICAgICAgICAgdGhpcy5hc3NldEluZGV4Kys7CiAgICAgICAgICB0aGlzLmNhdGVnb3J5SW5kZXgrKzsKICAgICAgICB9KTsKICAgICAgfQogICAgfSwKCiAgICBpbml0aWFsSW5zcGVjdGlvblZhbGlkYXRpb24oKSB7CiAgICAgIGxldCB2YWxpZGF0aW9ucyA9IHt9OwoKICAgICAgaWYgKHRoaXMuY2hlY2tFeGlzdGluZ0luaXRpYWxJbnNwZWN0aW9uKSB7CiAgICAgICAgdmFsaWRhdGlvbnMgPSB7CiAgICAgICAgICBpbml0aWFsSW5zcGVjdGlvbkJ5QXNzZXRDYXRlZ29yeTogewogICAgICAgICAgICByZXF1aXJlZAogICAgICAgICAgfSwKICAgICAgICAgIHF1ZXN0aW9uVHlwZUZvcm1Jbml0aWFsOiB7CiAgICAgICAgICAgICRlYWNoOiB7CiAgICAgICAgICAgICAgbmFtZToge30sCiAgICAgICAgICAgICAgcXVlc3Rpb246IHt9LAogICAgICAgICAgICAgIHR5cGVMYWJlbDoge30KICAgICAgICAgICAgfQogICAgICAgICAgfQogICAgICAgIH07CiAgICAgIH0gZWxzZSB7CiAgICAgICAgdmFsaWRhdGlvbnMgPSB7CiAgICAgICAgICBpbml0aWFsSW5zcGVjdGlvbkJ5QXNzZXRDYXRlZ29yeToge30sCiAgICAgICAgICBxdWVzdGlvblR5cGVGb3JtSW5pdGlhbDogewogICAgICAgICAgICAkZWFjaDogewogICAgICAgICAgICAgIG5hbWU6IHsKICAgICAgICAgICAgICAgIHJlcXVpcmVkCiAgICAgICAgICAgICAgfSwKICAgICAgICAgICAgICBxdWVzdGlvbjogewogICAgICAgICAgICAgICAgcmVxdWlyZWQKICAgICAgICAgICAgICB9LAogICAgICAgICAgICAgIHR5cGVMYWJlbDogewogICAgICAgICAgICAgICAgcmVxdWlyZWQKICAgICAgICAgICAgICB9CiAgICAgICAgICAgIH0KICAgICAgICAgIH0KICAgICAgICB9OwogICAgICB9CgogICAgICByZXR1cm4gdmFsaWRhdGlvbnM7CiAgICB9LAoKICAgIHdvcmtPcmRlclZhbGlkYXRpb24oKSB7CiAgICAgIGxldCB2YWxpZGF0aW9ucyA9IHt9OwoKICAgICAgaWYgKCF0aGlzLmNoZWNrRXhpc3RpbmdJbml0aWFsSW5zcGVjdGlvbiAmJiB0aGlzLmZpbmFsSW5zcGVjdGlvblNlbGVjdGlvbiA9PSAiQ3JlYXRlIE5ldyBJbnNwZWN0aW9uIFRlbXBsYXRlIikgewogICAgICAgIHZhbGlkYXRpb25zID0gewogICAgICAgICAgd29ya09yZGVyU3VtbWFyeTogewogICAgICAgICAgICBwcmlvcml0eTogewogICAgICAgICAgICAgIHJlcXVpcmVkCiAgICAgICAgICAgIH0sCiAgICAgICAgICAgIHNoaWZ0OiB7CiAgICAgICAgICAgICAgcmVxdWlyZWQKICAgICAgICAgICAgfSwKICAgICAgICAgICAgc2hlZHVsZTogewogICAgICAgICAgICAgIHJlcXVpcmVkCiAgICAgICAgICAgIH0sCiAgICAgICAgICAgIHVzZXI6IHsKICAgICAgICAgICAgICByZXF1aXJlZAogICAgICAgICAgICB9LAogICAgICAgICAgICBjYXRlZ29yeTogewogICAgICAgICAgICAgIHJlcXVpcmVkCiAgICAgICAgICAgIH0sCiAgICAgICAgICAgIG5hbWU6IHsKICAgICAgICAgICAgICByZXF1aXJlZAogICAgICAgICAgICB9LAogICAgICAgICAgICBpbml0aWFsSW5zcGVjdGlvblRpdGxlOiB7CiAgICAgICAgICAgICAgcmVxdWlyZWQKICAgICAgICAgICAgfSwKICAgICAgICAgICAgZmluYWxJbnNwZWN0aW9uVGl0bGU6IHsKICAgICAgICAgICAgICByZXF1aXJlZAogICAgICAgICAgICB9CiAgICAgICAgICB9CiAgICAgICAgfTsKICAgICAgfSBlbHNlIGlmICh0aGlzLmNoZWNrRXhpc3RpbmdJbml0aWFsSW5zcGVjdGlvbiAmJiB0aGlzLmZpbmFsSW5zcGVjdGlvblNlbGVjdGlvbiA9PSAiQ3JlYXRlIE5ldyBJbnNwZWN0aW9uIFRlbXBsYXRlIikgewogICAgICAgIHZhbGlkYXRpb25zID0gewogICAgICAgICAgd29ya09yZGVyU3VtbWFyeTogewogICAgICAgICAgICBwcmlvcml0eTogewogICAgICAgICAgICAgIHJlcXVpcmVkCiAgICAgICAgICAgIH0sCiAgICAgICAgICAgIHNoaWZ0OiB7CiAgICAgICAgICAgICAgcmVxdWlyZWQKICAgICAgICAgICAgfSwKICAgICAgICAgICAgc2hlZHVsZTogewogICAgICAgICAgICAgIHJlcXVpcmVkCiAgICAgICAgICAgIH0sCiAgICAgICAgICAgIHVzZXI6IHsKICAgICAgICAgICAgICByZXF1aXJlZAogICAgICAgICAgICB9LAogICAgICAgICAgICBjYXRlZ29yeTogewogICAgICAgICAgICAgIHJlcXVpcmVkCiAgICAgICAgICAgIH0sCiAgICAgICAgICAgIG5hbWU6IHsKICAgICAgICAgICAgICByZXF1aXJlZAogICAgICAgICAgICB9LAogICAgICAgICAgICBpbml0aWFsSW5zcGVjdGlvblRpdGxlOiB7fSwKICAgICAgICAgICAgZmluYWxJbnNwZWN0aW9uVGl0bGU6IHsKICAgICAgICAgICAgICByZXF1aXJlZAogICAgICAgICAgICB9CiAgICAgICAgICB9CiAgICAgICAgfTsKICAgICAgfSBlbHNlIGlmICghdGhpcy5jaGVja0V4aXN0aW5nSW5pdGlhbEluc3BlY3Rpb24gJiYgdGhpcy5maW5hbEluc3BlY3Rpb25TZWxlY3Rpb24gIT09ICJDcmVhdGUgTmV3IEluc3BlY3Rpb24gVGVtcGxhdGUiKSB7CiAgICAgICAgdmFsaWRhdGlvbnMgPSB7CiAgICAgICAgICB3b3JrT3JkZXJTdW1tYXJ5OiB7CiAgICAgICAgICAgIHByaW9yaXR5OiB7CiAgICAgICAgICAgICAgcmVxdWlyZWQKICAgICAgICAgICAgfSwKICAgICAgICAgICAgc2hpZnQ6IHsKICAgICAgICAgICAgICByZXF1aXJlZAogICAgICAgICAgICB9LAogICAgICAgICAgICBzaGVkdWxlOiB7CiAgICAgICAgICAgICAgcmVxdWlyZWQKICAgICAgICAgICAgfSwKICAgICAgICAgICAgdXNlcjogewogICAgICAgICAgICAgIHJlcXVpcmVkCiAgICAgICAgICAgIH0sCiAgICAgICAgICAgIGNhdGVnb3J5OiB7CiAgICAgICAgICAgICAgcmVxdWlyZWQKICAgICAgICAgICAgfSwKICAgICAgICAgICAgbmFtZTogewogICAgICAgICAgICAgIHJlcXVpcmVkCiAgICAgICAgICAgIH0sCiAgICAgICAgICAgIGluaXRpYWxJbnNwZWN0aW9uVGl0bGU6IHsKICAgICAgICAgICAgICByZXF1aXJlZAogICAgICAgICAgICB9LAogICAgICAgICAgICBmaW5hbEluc3BlY3Rpb25UaXRsZToge30KICAgICAgICAgIH0KICAgICAgICB9OwogICAgICB9IGVsc2UgewogICAgICAgIHZhbGlkYXRpb25zID0gewogICAgICAgICAgd29ya09yZGVyU3VtbWFyeTogewogICAgICAgICAgICBwcmlvcml0eTogewogICAgICAgICAgICAgIHJlcXVpcmVkCiAgICAgICAgICAgIH0sCiAgICAgICAgICAgIHNoaWZ0OiB7CiAgICAgICAgICAgICAgcmVxdWlyZWQKICAgICAgICAgICAgfSwKICAgICAgICAgICAgc2hlZHVsZTogewogICAgICAgICAgICAgIHJlcXVpcmVkCiAgICAgICAgICAgIH0sCiAgICAgICAgICAgIHVzZXI6IHsKICAgICAgICAgICAgICByZXF1aXJlZAogICAgICAgICAgICB9LAogICAgICAgICAgICBjYXRlZ29yeTogewogICAgICAgICAgICAgIHJlcXVpcmVkCiAgICAgICAgICAgIH0sCiAgICAgICAgICAgIG5hbWU6IHsKICAgICAgICAgICAgICByZXF1aXJlZAogICAgICAgICAgICB9LAogICAgICAgICAgICBpbml0aWFsSW5zcGVjdGlvblRpdGxlOiB7fSwKICAgICAgICAgICAgZmluYWxJbnNwZWN0aW9uVGl0bGU6IHt9CiAgICAgICAgICB9CiAgICAgICAgfTsKICAgICAgfQoKICAgICAgcmV0dXJuIHZhbGlkYXRpb25zOwogICAgfSwKCiAgICBmaW5hbEluc3BlY3Rpb25WYWxpZGF0aW9uKCkgewogICAgICBsZXQgdmFsZGlhdGlvbnMgPSB7fTsKCiAgICAgIGlmICh0aGlzLmZpbmFsSW5zcGVjdGlvblNlbGVjdGlvbiA9PSAiQ3JlYXRlIE5ldyBJbnNwZWN0aW9uIFRlbXBsYXRlIikgewogICAgICAgIHZhbGRpYXRpb25zID0gewogICAgICAgICAgcXVlc3Rpb25UeXBlRm9ybUZpbmFsOiB7CiAgICAgICAgICAgICRlYWNoOiB7CiAgICAgICAgICAgICAgbmFtZTogewogICAgICAgICAgICAgICAgcmVxdWlyZWQKICAgICAgICAgICAgICB9LAogICAgICAgICAgICAgIHF1ZXN0aW9uOiB7CiAgICAgICAgICAgICAgICByZXF1aXJlZAogICAgICAgICAgICAgIH0sCiAgICAgICAgICAgICAgdHlwZUxhYmVsOiB7CiAgICAgICAgICAgICAgICByZXF1aXJlZAogICAgICAgICAgICAgIH0KICAgICAgICAgICAgfQogICAgICAgICAgfQogICAgICAgIH07CiAgICAgIH0gZWxzZSB7CiAgICAgICAgdmFsZGlhdGlvbnMgPSB7CiAgICAgICAgICBxdWVzdGlvblR5cGVGb3JtRmluYWw6IHsKICAgICAgICAgICAgJGVhY2g6IHsKICAgICAgICAgICAgICBuYW1lOiB7fSwKICAgICAgICAgICAgICBxdWVzdGlvbjoge30sCiAgICAgICAgICAgICAgdHlwZUxhYmVsOiB7fQogICAgICAgICAgICB9CiAgICAgICAgICB9CiAgICAgICAgfTsKICAgICAgfQoKICAgICAgaWYgKHRoaXMuZmluYWxJbnNwZWN0aW9uU2VsZWN0aW9uID09PSAiU2VsZWN0IEV4aXN0aW5nIikgewogICAgICAgIHZhbGRpYXRpb25zLmZpbmFsSW5zcGVjdGlvbkJ5QXNzZXRDYXRlZ29yeSA9IHsKICAgICAgICAgIHJlcXVpcmVkCiAgICAgICAgfTsKICAgICAgfSBlbHNlIHsKICAgICAgICB2YWxkaWF0aW9ucy5maW5hbEluc3BlY3Rpb25CeUFzc2V0Q2F0ZWdvcnkgPSB7fTsKICAgICAgfQoKICAgICAgcmV0dXJuIHZhbGRpYXRpb25zOwogICAgfSwKCiAgICBzaG93VG9hc3QobWVzc2FnZSwgdHlwZSkgewogICAgICB0aGlzLnRvYXN0TWVzc2FnZSA9IG1lc3NhZ2U7CiAgICAgIHRoaXMudG9hc3RUeXBlID0gdHlwZTsKICAgICAgdGhpcy50b2FzdEZsYWcrKzsKICAgIH0KCiAgfSwKICBwcm9wczogewogICAgY2FsZW5kZXJEYXRlT2JqOiB7fQogIH0sCgogIG1vdW50ZWQoKSB7CiAgICB0aGlzLmN1cnJlbnRVc2VyRGV0YWlscyA9IEpTT04ucGFyc2UobG9jYWxTdG9yYWdlLmdldEl0ZW0oImN1cnJlbnRVc2VyRGV0YWlscyIpKTsKICAgIHRoaXMuZ2V0Q3VycmVuY3koKTsKICAgIHRoaXMuZ2V0QWxsQ2F0ZWdvcmllcyh0aGlzLmN1cnJlbnRVc2VyRGV0YWlscyk7CiAgICB0aGlzLmdldFVzZXJzR3JvdXAodGhpcy5jdXJyZW50VXNlckRldGFpbHMucHJvZmlsZS5vcmdhbml6YXRpb25JZCk7CiAgICB0aGlzLmdldEFsbFVzZXJzKHRoaXMuY3VycmVudFVzZXJEZXRhaWxzLnByb2ZpbGUub3JnYW5pemF0aW9uSWQpOwogICAgY29uc29sZS5sb2coImNhbGVuZGVyRGF0ZU9iaiIsIHRoaXMuY2FsZW5kZXJEYXRlT2JqKTsKICAgIGxldCBzdGFydERhdGUgPSBtb21lbnQodGhpcy5jYWxlbmRlckRhdGVPYmouc3RhcnRUaW1lKS5mb3JtYXQoIkREIE1NTSBZWVlZIik7CiAgICB0aGlzLndvcmtPcmRlclN1bW1hcnkuc2hlZHVsZSA9IHN0YXJ0RGF0ZTsKICAgIHRoaXMuYXNzZXRJbmRleCsrOwogICAgdGhpcy5hZGRJbnB1dEZpZWxkc0luaXRpYWwoKTsKICAgIHRoaXMuYWRkSW5wdXRGaWVsZHNGaW5hbCgpOwogIH0sCgogIHZhbGlkYXRpb25zOiBmdW5jdGlvbiAoKSB7CiAgICByZXR1cm4geyAuLi50aGlzLndvcmtPcmRlclZhbGlkYXRpb24oKSwKICAgICAgLi4udGhpcy5pbml0aWFsSW5zcGVjdGlvblZhbGlkYXRpb24oKSwKICAgICAgLi4udGhpcy5maW5hbEluc3BlY3Rpb25WYWxpZGF0aW9uKCksCiAgICAgIGZpbmFsSW5zcGVjdGlvblNlbGVjdGlvbjogewogICAgICAgIHJlcXVpcmVkCiAgICAgIH0sCiAgICAgIGlzc3Vlc1NlbGVjdGVkOiB7CiAgICAgICAgcmVxdWlyZWQKICAgICAgfQogICAgICAvKiBpc3N1ZXM6ewogICAgICAkZWFjaDp7CiAgICAgIAlpc3N1ZU5hbWU6e3JlcXVpcmVkfSwKICAgICAgfSwKICAgICAgfSwqLwoKICAgIH07CiAgfQp9Ow=="},null]}